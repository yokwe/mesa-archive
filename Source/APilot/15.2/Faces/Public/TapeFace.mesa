-- Copyright (C) 1991 by Xerox Corporation. All rights reserved. -- TapeFace.mesa	last edited: 22-May-91  8:51:38	by CAJDIRECTORY  Device USING [Type],  Zone USING [Alignment];TapeFace: DEFINITIONS =  BEGIN  ------------  -- Devices  -- A device is an individual tape drive.  DeviceHandle: TYPE [SIZE[CARDINAL]];  nullDeviceHandle: READONLY DeviceHandle;  GetNextDevice: PROCEDURE [previous: DeviceHandle] RETURNS [next: DeviceHandle];  ------------  -- Attributes and Context  -- Attributes are characteristics of a device or drive and are not settable.  -- Context is characteristics of an individual tape or instance.  These may  -- be settable or read-only.  GetDeviceAttributes: PROCEDURE [device: DeviceHandle]    RETURNS [deviceType: Device.Type, recommendedBuffersize: LONG CARDINAL,      defaultBlocksize: LONG CARDINAL, minBlocksize: LONG CARDINAL,      variableBlocksize: BOOLEAN, retensionable: BOOLEAN,      autoRewindOnLoad: BOOLEAN, autoRewindOnUnload: BOOLEAN];  Context: TYPE = MACHINE DEPENDENT RECORD [    speed(0:0..7): Speed,    density(0:8..15): Density,    buffered(1:0..7): BOOLEAN,    writeProtect(1:8..15): BOOLEAN];  Speed: TYPE = MACHINE DEPENDENT {    default(0), ips50(1), ips75(2), ips90(3), ips100(4), ips125(5), spare0(6),    spare1(7), spare2(8), last(255)};  Density: TYPE = MACHINE DEPENDENT {    default(0), bpi8000(1), bpi10000(2), bpi12000(3), spare0(4), spare1(5),    spare2(6), spare3(7), last(255)};  ------------  -- Tape operations  Initiate: PROCEDURE [op: OperationPtr] RETURNS [status: Status];  -- Operation must be operationAlignment aligned, size must be operationSize,  -- and located within first 64K.  OperationPtr: TYPE = LONG POINTER TO Operation;  Operation: TYPE = MACHINE DEPENDENT RECORD [    command(0): Command,    device(1): DeviceHandle,    dataPtr(2): LONG POINTER,    count(4): LONG CARDINAL,    incrementDataPtr(6:0..7): BOOLEAN,    retries(6:8..15): [0..256)];  operationAlignment: READONLY Zone.Alignment;  operationSize: READONLY CARDINAL;  -- Not all commands are meaningful for all device types.  Command: TYPE = MACHINE DEPENDENT {    read(0), write(1), writeFilemark(2), nop(3), open(4), close(5), load(6),    unload(7), rewind(8), retension(9), erase(10), fwdspaceFile(11),    backspaceFile(12), fwdspaceRecord(13), backspaceRecord(14), spaceEOM(15),    getContext(16), setContext(17), getBlocksize(18), setBlocksize(19),    control(20), reserved0(21), reserved1(22), reserved2(23), reserved3(24),    last(177777B)};  Poll: PROCEDURE [device: DeviceHandle]    RETURNS [op: OperationPtr, status: Status];  Status: TYPE = MACHINE DEPENDENT    {goodCompletion(0), inProgress(1), aborted(2), illegalOperation(3),     BOT(4), EOT(5), EOF(6), timeout(7), notReady(8), mediumError(9),     hardwareError(10), reset(11), dataProtect(12), blankCheck(13),     failed(14), busy(15), lengthError(16), overrun(17), vendorUnique(18),     unitAttention(19), memoryError(20), otherError(21), last(177777B)};  Cancel: PROCEDURE [device: DeviceHandle];  ------------  -- Initialization  -- These routines are called once, before any others.  Initialize: PROCEDURE [notify: WORD, initialAllocation: LONG POINTER];    -- The initialAllocation storage must be resident, of length    -- initialAllocationLength, and of alignment operationAlignment.  initialAllocationLength: READONLY CARDINAL;  InitializeCleanup: PROCEDURE;  END...LOG31-Jan-91 14:52:12	CAJ 	Created file.12-Mar-91 20:50:25	CAJ 	Deleted Position, added commands open/close, status aborted; changed DeviceHandle from opaque; deleted attributes selectableDeviceBuffering and loadUnloadable, added recommendedBuffersize, autoRewindOnLoad, and autoRewindOnUnload.19-Apr-91 13:34:53	CAJ 	Changed DeviceHandle to single word, nullDeviceHandle from constant to variable; deleted DeviceObject.  Double word aligned double word operation fields.  Added return status to Initiate, writeProtected field to Context.  Named args in GetNextDevice.  Rearranged Status values and added illegalOperation.  Added attribute minBlocksize.22-May-91  8:51:32	CAJ 	Added speeds ips100, ips125, statuses unitAttention and memoryError.