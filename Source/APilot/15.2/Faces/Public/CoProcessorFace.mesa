-- CoProcessorFace.mesa  Last Edited by JPM 10-Apr-90  8:41:47-- Copyright (C) 1990 by Xerox Corporation.  All rights reserved.DIRECTORY  Stream USING [SubSequenceType];CoProcessorFace: DEFINITIONS =  BEGIN  -- TYPEs  -- Connection is a bidirectional transfer point between a Mesa stream and  -- a coprocessor stream. The record and its buffers must be pinned in memory  -- and, once presented to the Face via InitiateConnection,  -- must not be unpinned or deleted until it has been disconnected.  -- The actual size of this record is given by connectionRecSize.  Connection: TYPE = LONG POINTER TO ConnectionRec;  ConnectionRec: TYPE = MACHINE DEPENDENT RECORD [    serverID(0): ServerID,    connectionState(1): ConnectionState ¬ waiting,    fromMesa(2): TransferRec,    toMesa(8): TransferRec];  TransferRec: TYPE = MACHINE DEPENDENT RECORD [    buffer(0): LONG POINTER, -- one page, page-aligned    subSequence(2:0..7): Stream.SubSequenceType ¬ 0,    endStream(2:8..14): BOOLEAN ¬ FALSE,    endRecord(2:15..15): BOOLEAN ¬ FALSE,    bytesWritten(3): CARDINAL ¬ 0,    bytesRead(4): CARDINAL ¬ 0,    status(5): Status ¬ completed];  ConnectionState: TYPE = MACHINE DEPENDENT {waiting(0), connected(1), disconnected(2)};  Status: TYPE = MACHINE DEPENDENT {inProgress(0), completed(1), error(2), busyTryLater(3)};  ServerID: TYPE = CARDINAL;  -- variables  connectionRecSize: CARDINAL; -- full size of ConnectionRec, counting unseen fields  -- PROCs  Initialize: PROC [notifyMask: WORD];  InitializeCleanup: PROC;  InitiateConnection: PROC [connection: Connection, isServer: BOOLEAN] RETURNS [Status];  -- normally returns inProgress; use Poll to check for completion  -- Poll will return error if ~isServer and connection.serverID not known to coprocessor  InitiateDisconnection: PROC [connection: Connection] RETURNS [Status];  -- normally returns inProgress; use Poll to check for completion  NotifyForTransfer: PROC; -- client has data to send or needs to receive data  Poll: PROC [connection: Connection] RETURNS [Status];  -- valid only after an Initiate* call using specified connection  END.LOG22-Mar-90 - JPM - Created.10-Apr-90 - JPM - Changed to implement new connection establishment protocol.