$MOD186$PAGELENGTH (72)$PAGEWIDTH  (136);Copyright (C) 1984, 1985 by Xerox Corporation. All rights reserved.;-- stored as [Idun]<WDLion>Dove>RAMHIntC.asm;-- created on  23-Aug-85 16:11:11;-- last edited by:;--	JAC	26-Jan-87 11:51:26	;add call to GermInit;--	KEK	16-Mar-86 13:42:22	;add PROC'ness; org'd at 0, make;--		 InitializeRAMFunctions a far proc as was done in RAMHands 6-Jan;--	JAC	 5-Mar-86 12:10:28	:handlers in main memory changes;--	JPM	19-Sep-85 12:33:41	:Pick up changes to RAMHInit.asm;--	JPM	23-Aug-85 16:11:11	:Creation from RAMHInit.asmNAME		RAMHIntC$NOLIST$INCLUDE	(IOPDefs.asm)$INCLUDE	(OpieDefs.asm)$INCLUDE	(ROMBDefs.asm)$LIST;********************************************************************************IOPELocalRam		SEGMENT		AT 0			EXTRN	HandlerInitProcTable: SegmentAndOffset			EXTRN	device: WORDIOPELocalRam		ENDS;********************************************************************************IOPEInRAM		SEGMENT	WORD PUBLIC			ASSUME	CS:IOPEInRAM			ORG	0			$INCLUDE	(RAMHndsC.asm)	;file specifying which handlers we link with.EXTRN			GermInit: NEARPUBLIC	InitializeRAMFunctionsInitializeRAMFunctions	PROC	FAR			CALL	GermInit			MOV	AX, IOPELocalRam			MOV	ES, AX			ASSUME	ES:IOPELocalRam$NOGEN;The following macro enumerates those which are expected to be linked.%' RAMHndsC.asm defines a macro called HandlersLinked, which calls the%' %Handler macro for the names of all handlers the author provided.%*DEFINE(Handler(name,id,initProcAction,codeLocation))	(			PUBLIC	%name%(HandlerID)%name%(HandlerID)	EQU	%id				%IF (%NES (%codeLocation,MEMORY)) THEN (	    %IF (%EQS (%initProcAction,CALL))	        THEN (EXTRN	%name%(Init): NEAR	  	      PUSH	ES%name%(StartMe:)      PUSH	CS	  	      CALL	%name%(Init)	  	      POP	ES	        ) ELSE	            (	            %IF (%EQS (%initProcAction,PROC))		        THEN (EXTRN	%name%(Init): NEAR			      MOV	DI, SIZE SegmentEntry * %id%name%(StoreMe:)	      MOV	HandlerInitProcTable[DI].segmentValue, CS			      MOV	HandlerInitProcTable[DI].offsetValue, OFFSET %name%(Init)		        ) ELSE		            (			    %IF (%EQS (%initProcAction,CALLPROC))			        THEN (MOV	DI, SIZE SegmentEntry * %id				      PUSH	ES%name%(StartMe:)		      CALL	DWORD PTR HandlerInitProcTable[DI]				      POP	ES			        ) ELSE			            (				    %IF (%EQS (%initProcAction,BOOTPROC))				        THEN (CMP	device, %name					      JE	%name%(SkipMe)					      MOV	DI, SIZE SegmentEntry * %id					      PUSH	ES%name%(StartMe:)			      CALL	DWORD PTR HandlerInitProcTable[DI]					      POP	ES%name%(SkipMe:)				        ) FI			        ) FI		        ) FI	        ) FI	) FI);Generate calls to Init Routines$GENONLY			%HandlersLinked			RETInitializeRAMFunctions	ENDPIOPEInRAM		ENDS			END