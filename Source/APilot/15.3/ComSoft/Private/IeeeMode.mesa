-- Copyright (C) 1980, 1983, 1984  by Xerox Corporation. All rights reserved. -- IeeeMode.mesa-- Last Modified:  7-Jul-83  0:31:40-- IEEE float mode control and exceptionsDIRECTORY  Ieee USING [BitOn, IResultEnable, IResultSticky, MicroSticky, stickyFlags],  Real USING [ExceptionFlags, Extended, NoExceptions],  RealOps USING [InfinityMode, Microcode, Mode, NormalizationMode, RoundingMode];IeeeMode: PROGRAM IMPORTS Ieee, RealOps EXPORTS Ieee, Real, RealOps =  BEGIN  userMode: RealOps.Mode;  SetStickyFlags: PUBLIC PROC [new: Real.ExceptionFlags ¬ Real.NoExceptions]    RETURNS [old: Real.ExceptionFlags] = {    IF RealOps.Microcode THEN MicroStickySet[];    old ¬ Ieee.stickyFlags;    Ieee.stickyFlags ¬ new;    };  GetStickyFlags: PUBLIC PROC RETURNS [Real.ExceptionFlags] = {    IF RealOps.Microcode THEN MicroStickySet[]; RETURN[Ieee.stickyFlags]; };  SetMode: PUBLIC PROC [new: RealOps.Mode] RETURNS [old: RealOps.Mode] = {    old ¬ userMode; userMode ¬ new; MicroStickySet[]; };  GetMode: PUBLIC PROC RETURNS [RealOps.Mode] = {RETURN[userMode]; };  MicroStickySet: PUBLIC PROC = {    IF RealOps.Microcode THEN {      xx: CARDINAL ¬	IF userMode.traps[inexactResult] THEN Ieee.IResultEnable ELSE 0;      xx ¬ Ieee.MicroSticky[xx];      IF Ieee.BitOn[xx, Ieee.IResultSticky] THEN	Ieee.stickyFlags[inexactResult] ¬ TRUE;      };    };  RealException: PUBLIC SIGNAL [    flags: Real.ExceptionFlags, vp: LONG POINTER TO Real.Extended]    RETURNS [LONG POINTER TO Real.Extended] = CODE;  RealError: PUBLIC ERROR = CODE;  END.L. LXS    , July 6, 1980  4:13 PM, Microcode sticky bit stuff added.August 25, 1980  4:42 PM, LStewart; FormattingSeptember 28, 1980  8:06 PM; LXS    , Deleted individual twiddle procs.