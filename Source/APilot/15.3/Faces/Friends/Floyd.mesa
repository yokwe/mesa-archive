-- Floyd.mesa-- Copyright (C) Xerox Corporation 1986, All rights reserved.DIRECTORY  Environment USING [BitAddress, bytesPerWord, Byte],  ESCAlphaExtras USING [aFLOYD],  Mopcodes USING [zESC];Floyd: DEFINITIONS =  BEGIN  -- Type defs for FloydTable  BitAddress: TYPE = Environment.BitAddress;  BYTE: TYPE = Environment.Byte;  BytesPerWord: CARDINAL = Environment.bytesPerWord;  ByteAddress: TYPE =MACHINE DEPENDENT RECORD [  	word(0)			:LONG POINTER,	reserved(2:0..14)	:[0..77777B] ¬ 0,	byte(2:15..15)		:[0..BytesPerWord)];  FloydTablePtr, FTptr : TYPE = LONG POINTER TO FloydTable;  FloydTable, FTable: TYPE = MACHINE DEPENDENT RECORD [	invert(0:0..0)		:BOOLEAN,  	pixelCount(0:1..15)	:CARDINAL[0..32767],	threshold(1:0..7)	:BYTE,	maxValue(1:8..15)	:BYTE ¬ 255,	inBuffAddress(2)	:ByteAddress,	outBuffAddress(5)	:BitAddress,	errorBuff(8)		:LONG POINTER];  Floyd: PROCEDURE [ptr:FTptr] =    MACHINE CODE BEGIN Mopcodes.zESC, ESCAlphaExtras.aFLOYD END;  SoftwareFloyd: PROCEDURE [ptr:FTptr];   -- Alignment, FloydTable must be on a 16 word boundry  FloydTableAlignment: CARDINAL = 16;  FloydTableSpace: TYPE = ARRAY [1..SIZE[FTable] + FloydTableAlignment) OF UNSPECIFIED;  AlignedFloydTable: PROCEDURE [ip: LONG POINTER TO FloydTableSpace] RETURNS [f: FTptr] =   INLINE   BEGIN    align: TYPE = MACHINE DEPENDENT RECORD [      s: [0..LAST[WORD]/FloydTableAlignment),       z: [0..FloydTableAlignment),      w: WORD];  -- need this for long pointer alignment    f ¬ LOOPHOLE[ip + FloydTableAlignment - 1];    LOOPHOLE[f, align].z ¬ 0;   END;  END.