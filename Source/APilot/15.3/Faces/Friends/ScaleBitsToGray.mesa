-- ScaleBitsToGray.mesa-- Last edited: JPM, 1-Dec-86 11:22:45-- Copyright (C) Xerox Corporation 1986, All rights reserved.DIRECTORY  Environment USING [BitAddress, bytesPerWord],  ESCAlphaExtras USING [aSCALEBITSTOGRAY],  Inline USING [DBITAND],  Mopcodes USING [zESC];ScaleBitsToGray: DEFINITIONS  IMPORTS Inline =  BEGIN  -- Type defs for argument record  ByteAddress: TYPE = MACHINE DEPENDENT RECORD [    word(0): LONG POINTER,    reserved(2:0..14): [0..77777B] ¬ 0,    byte(2:15..15): [0..Environment.bytesPerWord)];  SBTGptr: TYPE = LONG POINTER TO SBTGTable;  SBTGTable: TYPE = MACHINE DEPENDENT RECORD [    dst(0): ByteAddress,    src(3): Environment.BitAddress,    srcBpl(6): CARDINAL,    pixelCount(7): CARDINAL,    reserved(8:0..13): [0..37777B] ¬ 0,    scale(8:14..15): ScaleFactor];  ScaleFactor: TYPE = MACHINE DEPENDENT    {sixteenBySixteen, eightByEight, fourByFour, twoByTwo};   -- Alignment, SBTGTable must be on a 16 word boundry  tableAlignment: PRIVATE CARDINAL = 16;  tableAlignmentMask: PRIVATE LONG INTEGER = -tableAlignment; -- same as ~(tableAlignment-1)  SBTGTableSpace: TYPE = ARRAY [1 .. (SIZE[SBTGTable] + tableAlignment)) OF WORD;  AlignedSBTGptr: PROCEDURE [ptr: LONG POINTER TO SBTGTableSpace] RETURNS [SBTGptr] = INLINE   {RETURN[Inline.DBITAND[(ptr + tableAlignment - 1), tableAlignmentMask]]};  -- PROCs  ScaleBitsToGray: PROCEDURE [ptr: SBTGptr] = MACHINE CODE    {Mopcodes.zESC, ESCAlphaExtras.aSCALEBITSTOGRAY};  SoftwareScaleBitsToGray: PROCEDURE [ptr: SBTGptr];  END.LOG31-Oct-86 -- Monahan -- Created.1-Dec-86 -- Monahan -- Changed values of enumerateds in ScaleFactor (to help uCode).