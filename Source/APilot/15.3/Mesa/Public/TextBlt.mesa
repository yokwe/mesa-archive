-- File: TextBlt.mesa - last edit:-- JGS    .pa           7-Jan-85 16:57:03-- LXB       .ES        2-Jan-85 14:38:50-- Copyright (C) 1984, 1985 by Xerox Corporation. All rights reserved.-- Copyright (C) Xerox Corporation 1984. All rights reserved.DIRECTORY  ESCAlpha USING [aTXTBLT],  Mopcodes USING [zESC];TextBlt: DEFINITIONS =  BEGIN  Byte: TYPE = CARDINAL[0..255];    Function: TYPE = {display, format, resolve};  TextBltArg: TYPE = MACHINE DEPENDENT RECORD [    reserved: [0..37777B] _ 0,    function: Function, -- display, format or resolve    last: CARDINAL, -- index of last character to process    text: LONG POINTER TO PACKED ARRAY CARDINAL OF Byte,    font: FontHandle, -- Long Pointer to font information    dst: LONG POINTER, -- destination bitmap (display only)    dstBpl: CARDINAL, -- Bits per line (display only)    margin: CARDINAL, -- mica value of right margin (format only)    space: INTEGER, -- width adjustment to pad characters (display, resolve)    coord: LONG POINTER TO ARRAY CARDINAL [0..0) OF CARDINAL  -- widths array for resolve    ];  TextBltArgAlignment: CARDINAL = 16;  TextBltArgSpace: TYPE = ARRAY [1..SIZE[TextBltArg] + TextBltArgAlignment) OF    UNSPECIFIED;  AlignedTextBltArg: PROCEDURE [ip: POINTER TO TextBltArgSpace]    RETURNS [p: POINTER TO TextBltArg] = INLINE    BEGIN    align: TYPE = MACHINE DEPENDENT RECORD [      s: [0..LAST[WORD]/TextBltArgAlignment), z: [0..TextBltArgAlignment)];    p _ LOOPHOLE[ip + TextBltArgAlignment - 1];    LOOPHOLE[p, align].z _ 0;    END;  FontHandle: TYPE = LONG POINTER TO Font;  Font: TYPE;  Result: TYPE = {normal, margin, stop, notInFont};  TextBlt: PROCEDURE [    index: CARDINAL, bitPos: CARDINAL, micaPos: CARDINAL, count: INTEGER,    ptr: POINTER TO TextBltArg]    RETURNS [      newIndex: CARDINAL, newBitPos: CARDINAL, newMicaPos: CARDINAL,      newCount: INTEGER, result: Result] = MACHINE CODE    BEGIN Mopcodes.zESC, ESCAlpha.aTXTBLT; END;  SoftwareTextBlt: PROCEDURE [    index: CARDINAL, bitPos: CARDINAL, micaPos: CARDINAL, count: INTEGER,    ptr: POINTER TO TextBltArg]    RETURNS [      newIndex: CARDINAL, newBitPos: CARDINAL, newMicaPos: CARDINAL,      newCount: INTEGER, result: Result];  END.	-- of TextBltLOG3-24-80 -- XXG    -- CreatedJuly 30, 1980  10:56 AM -- Jim JXF      -- Add FontRecord.heightAugust 29, 1980  3:29 PM -- Jim JXF      -- Remove Font, rearrange parameters.October 7, 1980  9:12 AM -- Jim JXF      -- Add AlignedTextBltArg. Fix TextBlt Inline definition. 8-Sep-81  9:27:02 -- JGS -- Convert to new instruction set. 7-Jan-85 16:48:03 -- JGS     -- Added SoftwareTextBlt and Result.notInFont. Lengthened resolve buffer