-- Copyright (C) 1982  by Xerox Corporation. All rights reserved. -- Zone.mesa  (Last modified  24-Nov-82  9:22:06 by AWL      )DIRECTORY  Environment USING [Base];Zone: DEFINITIONS =  BEGIN  -- Types known by clients of the zone allocator  Alignment: TYPE = {a1, a2, a4, a8, a16};  Base: TYPE = Environment.Base;  Handle: TYPE [2];  SegmentHandle: TYPE [1];  BlockSize: TYPE = CARDINAL;  -- Useful constants  minimumNodeSize: READONLY BlockSize;  nullSegment: SegmentHandle = LOOPHOLE[0];  nil: Base RELATIVE POINTER = LOOPHOLE[0];  nullHandle: Handle = LOOPHOLE[LONG[0]];  -- Status returned by Zone operations  Status: TYPE = {    okay, noRoomInZone, nonEmptySegment, storageOutOfRange, zoneTooSmall,    segmentTooSmall, invalidNode, invalidZone, invalidSegment, nodeLoop,    wrongSeal, wrongVersion};  -- Node allocation and deallocation:  MakeNode: PROCEDURE [zH: Handle, n: BlockSize, alignment: Alignment ¬ a1]    RETURNS [node: Base RELATIVE POINTER, s: Status];  FreeNode: PROCEDURE [zH: Handle, p: LONG POINTER] RETURNS [s: Status];  SplitNode: PROCEDURE [zH: Handle, p: LONG POINTER, n: BlockSize]    RETURNS [s: Status];  NodeSize: PROCEDURE [p: LONG POINTER] RETURNS [n: BlockSize];  -- Zone and segment management:  Create: PROCEDURE [    storage: LONG POINTER, length: BlockSize, zoneBase: Base,    threshold: BlockSize ¬ minimumNodeSize, checking: BOOLEAN ¬ FALSE]    RETURNS [zH: Handle, s: Status];  AddSegment: PROCEDURE [zH: Handle, storage: LONG POINTER, length: BlockSize]    RETURNS [sH: SegmentHandle, s: Status];  RemoveSegment: PROCEDURE [zH: Handle, sH: SegmentHandle]    RETURNS [storage: LONG POINTER, s: Status];  Recreate: PROCEDURE [storage: LONG POINTER, zoneBase: Base]    RETURNS [zH: Handle, rootNode: Base RELATIVE POINTER, s: Status];    IsSegmentEmpty: PROCEDURE [zH: Handle, sH: SegmentHandle]    RETURNS [empty: BOOLEAN];    IsZoneEmpty: PROCEDURE [zH: Handle] RETURNS [empty: BOOLEAN];  -- Zone and segment attributes:  GetAttributes: PROCEDURE [zH: Handle]    RETURNS [      zoneBase: Base, threshold: BlockSize, checking: BOOLEAN,      storage: LONG POINTER, length: BlockSize, next: SegmentHandle];  SetChecking: PROCEDURE [zH: Handle, checking: BOOLEAN] RETURNS [s: Status];  GetSegmentAttributes: PROCEDURE [zH: Handle, sH: SegmentHandle]    RETURNS [storage: LONG POINTER, length: BlockSize, next: SegmentHandle];  GetRootNode: PROCEDURE [zH: Handle] RETURNS [node: Base RELATIVE POINTER];  SetRootNode: PROCEDURE [zH: Handle, node: Base RELATIVE POINTER];  END.--LOGTime:	February 21, 1979  10:50 AM	By: HXL     Created Time:	July 18, 1979  4:19 PM		By: WDK       Added alignment parameter to MakeNodeTime:	January 8, 1981  1:29 PM	By: PXM       Added Recreate and RootNode procedures.Time:	 9-Aug-81 12:55:19		By: WDK    /AWL         Handle and SegmentHandle become opaque types.  BlockSize expands to full 16-bit cardinal.   Added Is(Segment/Zone)Empty.Time:	24-Nov-82  9:22:03		By: AWL         Added nullHandle.