-- Copyright (C) 1984  by Xerox Corporation. All rights reserved. -- File: GateTeletypeControl.mesa - last edit:-- Danielson.PA        20-Mar-84 13:19:14DIRECTORY  NSName USING [Name],  NSString USING [String],  System USING [GreenwichMeanTime];GateTeletypeControl: DEFINITIONS =  BEGIN    -- This interface allows the ECS to control the Teletype driver and collect  -- statistics on TTY RS-232-C ports.  The ECS (at START time) will allow access   -- to RS-232-C ports by calling AllowAccess for each port.  This procedure  -- also allows the ECS to pass any access control information and informs  -- the TTY driver to start collecting global statistics for the port.    -- While running, the ECS can collect statistics by calling GetStats and  -- GetGlobalStats.  All stats are copied into the record provided by the  -- client.  GetStats requires an UNCOUNTED ZONE so that the NSName.Name  -- can be allocated.  The client is responsible for freeing this.    -- When the ECS wants to stop a line, it calls DisallowAccess.  This will  -- do an eqivalent of a SLOW stop.  If the client wants to do a FAST stop,  -- the client should also call ForceLineDown.  For simplicity, the client  -- may call DisallowAccess multiple times if desired.  ForceLineDown should  -- only be called once.    -- Both DisallowAccess and ForceLineDown return immediately.  To see when all  -- the TTY lines have idled, the client should call WaitUntilIdle.  This  -- procedure will not return until all the lines have been freed.  This  -- procedure is abortable and multiple processes may call it simulateously.    -- Restrictions/features:    -- Access control is only performed on remote connections.  This should  -- allow the Greeter, local fax, local phototypesetter, and the 5700 to  -- work successfully.    -- TYPES    Stats: TYPE = LONG POINTER TO StatsRecord;    StatsRecord: TYPE = RECORD [    bytesSent: LONG CARDINAL ¬ 0,    bytesReceived: LONG CARDINAL ¬ 0,    receiveParityErrors: LONG CARDINAL ¬ 0,    receiveFramingErrors: LONG CARDINAL ¬ 0,    receiveDataLostErrors: LONG CARDINAL ¬ 0,    sessionStart: System.GreenwichMeanTime,    user: NSName.Name ¬ NIL];    GlobalStats: TYPE = LONG POINTER TO GlobalStatsRecord;    GlobalStatsRecord: TYPE = RECORD [    totalBytesSent: LONG CARDINAL ¬ 0,    totalBytesReceived: LONG CARDINAL ¬ 0,    totalReceiveParityErrors: LONG CARDINAL ¬ 0,    totalReceiveFramingErrors: LONG CARDINAL ¬ 0,    allSessionsSeconds: LONG CARDINAL ¬ 0,    longestSessionSeconds: LONG CARDINAL ¬ 0,    shortestSessionSeconds: LONG CARDINAL ¬ 0,    numberOfSessions: LONG CARDINAL ¬ 0,    numberOfAccessControlFailures: LONG CARDINAL ¬ 0];  -- EXPORTed by GateTeletype        AllowAccess: PROCEDURE [port: CARDINAL, accessControl: NSName.Name,    myName: NSName.Name, myPassword: NSString.String];  DisallowAccess: PROCEDURE [port: CARDINAL];  DisallowAllAccess: PROCEDURE;  ForceLineDown: PROCEDURE [port: CARDINAL];  WaitUntilIdle: PROCEDURE[port: CARDINAL];    GetStats: PROCEDURE [line: CARDINAL, stats: Stats, z: UNCOUNTED ZONE]    RETURNS [BOOLEAN];  GetGlobalStats: PROCEDURE [line: CARDINAL, stats: GlobalStats]    RETURNS [BOOLEAN];        END...  LOGTime:  8-Dec-83 11:07:36	By: Danielson	Action: Created file