-- DisplayIOFaceDove.mesa-- DisplayIOFaceDove.mesa contains the definition for data structures used for communication between-- the display head and handler.-- Created by AnK: 28-July-84-- This version is compatible with Opie 17---- Last edited by--	JPM:   9-Sep-85 13:11:06	:Shorten proc words.--	JPM:  29-Jul-85  9:40:27	:Opie redesign conversion.--	AnK:   9-Jan-85 10:41:52	:Changed cursor location x and y coordinates to be terms of--					: pixels.  Changed name of variable map to cursor pattern. --					:Implemented variables that hold IOP addresses of procedures--					: as double words (instead of words).--	AnK:   2-Nov-84 17:53:30	:Edited for use with Opie version 15--					:Added chngdInfoOffset to fix LockMem--	AnK:   5-Oct-84 15:37:22	:Edited for use with Opie version 14--	AnK:  26-Sep-84 10:53:29	:Edited for use with Opie version 13--					:Incorporated ByteSwappedWord types where necessary--					:Rearranged IO region variables; used a word for--					:numberDisplayLines & numberBitsPerWord.--					:Also put configInfo into one byte.--	AnK:  12-Sep-84  8:49:07<<	Copyright (C) 1984, 1985 by Xerox Corporation. All rights reserved.		The following program was created in 1984 but has not been published within the meaning of the	copyright law, is furnished under license, and may not be used, copied and/or disclosed except	in accordance with the terms of said license.	>>DIRECTORY  DisplayFace USING [Cursor],  DoveInputOutput USING [ByteSwappedWord, ClientCondition, TaskContextBlock];DisplayIOFaceDove:  DEFINITIONS	IMPORTS DisplayFace, DoveInputOutput =BEGIN   -- DisplayFace TYPES-- = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = =  displayFunctionContextBlock: TYPE = MACHINE DEPENDENT RECORD [    -- The display Function Context Block contains the head/handler synchronization information,    -- the hardware unique parameters, and the information passed from the head to handler.    -- These variables are in the IO region, so the IOP can access them also.            -- Head/Handler synchronization information:    displayTCB:DoveInputOutput.TaskContextBlock,  -- Display Task Context Block needed by OPIE for    						  -- coordinating head/handler communication						    displayLock: DoveInputOutput.ByteSwappedWord, -- Flag for implementing locked info between head    						  -- and handler    chngdInfo: WORD,	-- Word containing flags specifiying info that has changed.    			-- This word is left in Intel format, i.e. NOT byte swapped, to avoid			-- IOP/Mesa access problems.  To get around the byte swap problem, the			-- masks used in conjunction with this word are byte swapped.    				--  b15 = change in cursor postion				--  b14 = change in cursor pattern				--  b13 = change in border pattern				--  b12 = change in background				--  b11 = change in command to display control register				--  b10 - b0 = not used			-- = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = =        -- Information passed from the head to the handler:    vertRetraceEvent: DoveInputOutput.ClientCondition,	-- For wakeup on vertical retrace    							-- This is the mask used to implement the							-- Client Notify      --Information passed from the head to the handler (and hardware):    cursorXCoord: DoveInputOutput.ByteSwappedWord,	-- x coordinate of cursor locn in units of pixels    cursorYCoord: DoveInputOutput.ByteSwappedWord,	-- y coordinate of cursor locn in units of pixels        border: RECORD[oddpairs, evenPairs: [0..400B)],	-- Border pattern (2 bytes)        cursorPattern: DisplayFace.Cursor,			-- Cursor pattern.  This is declared    							-- as an ARRAY [0..16) OF WORD in the face				    displCntl: DCtlRegister,	-- Display control register info (Daybreak)  (byte)     mixRule: [0..16),		-- Four bits specifying data/cursor mix (Daisy) (nibble)    unused: [0..16),		-- Four spare bits (nibble)     -- = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = =               -- Hardware unique information:    -- This information is determined by the handler, and passed to the head.    crtConfig: CRTConfig,	-- Record containing the hardware unique parameters    -- = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = =    -- Info in IO region that Mesa does not use        bitMapOrg:  WORD,		-- Holds real address of bit map    numberQuadWords:  WORD,	-- Number of quad words per display line    verticalCounts:  WORD,	-- Holds IOP address on vertical counts array    horizontalcounts:  WORD,	-- Holds IOP address on horizontal counts array    displayIntrCnts:  WORD,	-- Number of display interrupts (added for debug)    displayWdtCnts:  [0..256),	-- Number of watch dog timeouts (added for debug)    cursorUser:  [0..256),	-- Indicates whether the display handler or maintainence panel    --				   handler is setting cursor pattern    displayHWInitProc:  WORD,	-- IOP address of display hardware initialization procedure    cursorPositionProc: WORD,	-- IOP address of cursor position procedure    cursorPatternProc:  WORD,	-- IOP address of cursor pattern procedure    borderPatternProc:  WORD,	-- IOP address of border pattern procedure    backgndProc:  WORD,		-- IOP address of procedure to set background    commandProc:  WORD];	-- IOP address of procedure to output display commands        -- END displayFunctionContextBlock   CRTConfig: TYPE = MACHINE DEPENDENT RECORD [    -- This record specifies the hardware configuration of the display.    -- This information is determined by the handler.        numberBitsPerLine: DoveInputOutput.ByteSwappedWord,  -- Display width in pixels    numberDisplayLines: DoveInputOutput.ByteSwappedWord, -- Display height (Number of lines)        configInfo: [0..256),	-- Byte specifying H/W configuration information    				-- b7 = configuration  0=Daybreak, 1=Daisy				-- b6 = interlaced/non-interlaced   0=interlaced,				--      1=non-interlaced				-- b5-b0 = not used    notUsed: [0..256),		-- Unsed byte, needed for word allignment in the IO region        colorParams: DoveInputOutput.ByteSwappedWord,	--Word for holding color parameters    							-- b15: 1 = color, 0 = non-color					    xCoordOffset: DoveInputOutput.ByteSwappedWord,	-- Offset for cursor position x-coordinate    yCoordOffset: DoveInputOutput.ByteSwappedWord,	-- Offset for cursor position y-coordinate			     pixels: [0..256),		-- Number of pixels per inch    refresh: [0..256)];		-- Refresh rate      DCtlRegister: TYPE = MACHINE DEPENDENT RECORD [    -- This record is set up in the apporpriate bit format for the Daybreak control register. --      dataCursor: [0..16),		-- Four bits specifying data/cursor mix (Daybreak)    picture: {Border(0), Picture(1)},	-- Picture or border    unusedB2: [0..1], 			-- Bit2 is unused    unusedB10: [0..4)];			-- Bits 1 and 0 are unused (in the Mesa world)    					-- b1=1=video enable, b0=0=interlaced					-- Mesa should NOT touch b1 or b0					  DoubleWord: TYPE = MACHINE DEPENDENT RECORD [    -- This record is sets up format for Intel double word. --      highWord: DoveInputOutput.ByteSwappedWord,	-- High order word of double word    lowWord: DoveInputOutput.ByteSwappedWord];	-- Low order word of double word     -- ************************************************************************************************         -- DisplayIOFace CONSTANTS    							    -- Masks for masking out bits of configInfo    daisyDaybreakMask: [0..235) = 128;  -- 1000 0000, get b7    interlacedMask: [0..256) = 64;      -- 0100 0000, get b6        END.