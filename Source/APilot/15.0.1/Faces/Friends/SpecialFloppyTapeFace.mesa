-- Copyright (C) 1987  by Xerox Corporation. All rights reserved. -- SpecialFloppyTapeFace.mesa-- RRP	      26-Jan-87 18:32:05  changed name from FloppyTapeFaceExtra, added GetTapeStatistics, changed semantics of RetentionTape-- RRP        21-Jan-87 16:14:08  created-- JGE	      28-Jan-87 17:12:32 Added Statistics recordDIRECTORY    FloppyDiskFace USING [DeviceHandle, DiskAddress, OperationPtr, Status],  Environment USING [Byte];SpecialFloppyTapeFace: DEFINITIONS =   BEGIN    Parameters: TYPE = RECORD [    numberOfStreams:    CARDINAL,    --Number of streams available.    maxTracksPerStream: CARDINAL];     --Maximum number of track per stream  PhysicalAddress: TYPE = MACHINE DEPENDENT RECORD [    cylinder(0): 	CARDINAL,    stream(1:0..7):   	Environment.Byte,    sector(1:8..15):  	Environment.Byte];  Statistics: TYPE = MACHINE DEPENDENT RECORD [<<Statistics are kept for the current tape only.  A disk change causes this record to be reset.  A retention pass also causes this record to be reset>>    retriesDone(0):              CARDINAL,  --crc/dataLost/index retries done    recordNotFoundErrors(1):     CARDINAL,  --record not found retries done    totalRetriesDone(2):         CARDINAL,  --total of all retries done    retentionNeeded(3:0..0):     BOOLEAN,   --True => retention pass is needed    unused(3:1..7): [0..177B) ¬ 0,    retentionsDone(3:8..15):     Environment.Byte]; --Retentions done on this tape.      GetTapeParameters: PROCEDURE [device: FloppyDiskFace.DeviceHandle] RETURNS [parameters: Parameters];  LogicalAddressToPhysicalAddress: PROCEDURE [logical: FloppyDiskFace.DiskAddress]    RETURNS [physicalAddress: PhysicalAddress];    -- converts between the disk scheme (logical address of thousands of cylinders, but only one head) to the tape's physical addresses (hundreds of cylinders, tens of streams)      GetStatistics: PROCEDURE RETURNS [stats: Statistics];   --Used to retrieve Statistics compiled by the Head.  This PROC is used by clients who need to know whether or not a retention pass is needed.  Retention: PROCEDURE [o: FloppyDiskFace.OperationPtr]  RETURNS [status: FloppyDiskFace.Status];   --Used to perform a retention pass on cartridge tapes.  Note that this is done asynchronously, just like Initiate.  The OperationPtr should be Polled upon (just like from an Initiate) until status#inProgress (which could be several minutes).  Additionally, upon return, the tape is not in the same place in which it was at the call to RetentionTape, so the next operation to the FloppyDiskFace will probably involve seeking to the desired location.  A call to this PROC causes Statistics to be reset.  END.	-- of SpecialFloppyTapeFace