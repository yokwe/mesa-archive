--TrapezoidBlt.mesa-- Copyright (C) Xerox Corporation 1986.  All rights reserved.DIRECTORY  BitBlt USING [DstFunc, SrcFunc],  Environment USING [BitAddress],  ESCAlphaExtras USING [aTRAPZBLT],  FixedPoint USING [Interpolator],  Mopcodes USING [zESC];TrapezoidBlt: DEFINITIONS =  BEGIN    -- Type defs for TrapezoidBltTable      BitAddress: TYPE = Environment.BitAddress;<<  FixdPtNum: TYPE = MACHINE DEPENDENT RECORD [    SELECT OVERLAID * FROM      wholeThing => [li: LONG INTEGER],      parts	 => [frac: CARDINAL ¬ 0, int: INTEGER],      ENDCASE]; >><<  Interpolator: TYPE = MACHINE DEPENDENT RECORD [    val, dVal: FixdPtNum]; >>  Interpolator: TYPE = FixedPoint.Interpolator;  DstFunc: TYPE = BitBlt.DstFunc;  SrcFunc: TYPE = BitBlt.SrcFunc;  TrapezoidBltMisc: TYPE = MACHINE DEPENDENT RECORD [    srcFunc (0:0..0): SrcFunc ¬ null,	 -- as in BitBlt.BitBltFlags    dstFunc (0:1..2): DstFunc ¬ null,    reserved (0:3..3): [0..1] ¬ 0,    yOffset (0:4..7): [0..15],	 	-- as in BitBlt.GrayParm    widthMinusOne (0:8..11): [0..15],	-- restricted to 0 for initial    					--   microcode implementations    heightMinusOne (0:12..15): [0..15]];      TBptr, TrapezoidBltTablePtr: TYPE = LONG POINTER TO TBTable;  TBTable, TrapezoidBltTable: TYPE = MACHINE DEPENDENT RECORD [    dst (0): BitAddress,		-- of 1st line of destination bitmap    dstBpl (3): INTEGER,		-- destination width, in bits per line    src (4): BitAddress,		-- 1st gray bit to be copied into 1st scanline    misc (7): TrapezoidBltMisc,		-- gray description    xMin (8): Interpolator,		-- one side of the trapezoid    xMax (12): Interpolator,		-- other side of the trapezoid    height (16): CARDINAL];		-- height of trapezoid in scanlines  TRAPEZOIDBLT: PROCEDURE [ptr: TBptr] =    MACHINE CODE BEGIN Mopcodes.zESC, ESCAlphaExtras.aTRAPZBLT END;  -- alignment issue, TrapezoidBlt argument block must be aligned on a 32-word boundary  TBTableAlignment: CARDINAL = 32;  TBTableSpace: TYPE = ARRAY [1..SIZE[TBTable] + TBTableAlignment) OF UNSPECIFIED;  AlignedTBTable: PROCEDURE [ip: LONG POINTER TO TBTableSpace]    RETURNS [b: TBptr] = INLINE    BEGIN    align: TYPE = MACHINE DEPENDENT RECORD [       s: [0..LAST[WORD]/TBTableAlignment),        z: [0..TBTableAlignment),       w: WORD ];    b ¬ LOOPHOLE[ip + TBTableAlignment - 1];    LOOPHOLE[b, align].z ¬ 0;    END;        SoftwareTrapezoidBlt: PUBLIC PROC[tzbp:TrapezoidBlt.TBptr];  END.	-- TrapezoidBLT.mesa  LOGJPM	 29-Oct-86 14:31:54	:replaced BitOps by FixedPoint.MRR	  2-Jul-86 15:37:33	:modified ESCAlphaExtras references.JMA	  5-Apr-86 17:39:09	:created file from BltGrayTrap and BitBlt