-- File: NewNetworkStream.mesa - last edit:-- AOF                 28-Oct-87 16:06:49-- MXI                 10-Nov-87 11:50:23-- Copyright (C) 1987 by Xerox Corporation. All rights reserved.DIRECTORY  NetworkStream USING [ConnectionID, defaultWaitTime,    infiniteWaitTime, ListenerHandle, WaitTime],  Stream USING [Handle],  System USING [NetworkAddress];NewNetworkStream: DEFINITIONS  IMPORTS NetworkStream =  BEGIN  WaitTime: TYPE = NetworkStream.WaitTime;  defaultWaitTime: WaitTime = NetworkStream.defaultWaitTime;  TSap: TYPE = LONG POINTER TO TSapObject;  TSapObject: TYPE = RECORD[    address: System.NetworkAddress,    connectionID: NetworkStream.ConnectionID];  NegotiationParameters: TYPE = LONG DESCRIPTOR FOR NegotiationObject;  NegotiationObject: TYPE = ARRAY OF TypeValuePairs;    TypeValuePairs: TYPE = RECORD[type: CARDINAL, value: Value];  nullTypeValuePairs: TypeValuePairs = [0, [value [0]]];  Value: TYPE = RECORD[SELECT OVERLAID * FROM    switch => [s: Switch], value => [v: CARDINAL], ENDCASE];  Switch: TYPE = MACHINE DEPENDENT {on(0), off(1), (LAST[CARDINAL])};  -- Create a network stream to the specified remote address.  NewCreate: PROCEDURE [    remote: System.NetworkAddress,    negotiationParameters: NegotiationParameters ¬ NIL,    timeout: WaitTime ¬ defaultWaitTime]    RETURNS [Stream.Handle];      --Find TSAPs for both ends of the stream  FindTSaps: PROCEDURE[sH: Stream.Handle, local, remote: TSap];  --Listening for a connection  NewListen: PROCEDURE [    listenerH: NetworkStream.ListenerHandle,    listenTimeout: WaitTime ¬ NetworkStream.infiniteWaitTime]    RETURNS[remote: System.NetworkAddress];  NewApprove: PROCEDURE [    listenerH: NetworkStream.ListenerHandle,    negotiationParameters: NegotiationParameters ¬ NIL,    streamTimeout: WaitTime ¬ NetworkStream.infiniteWaitTime]    RETURNS [sH: Stream.Handle];  NewReject: PROCEDURE [listenerH: NetworkStream.ListenerHandle];    END.LOG28-Oct-87 15:50:35  AOF  Created (mainly from NetworkStream).10-Nov-87 11:28:25  AOF  Moved NewTransducer to SPPNegotiation.