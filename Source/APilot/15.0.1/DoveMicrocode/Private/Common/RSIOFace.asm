;Copyright (C) 1985 by Xerox Corporation. All rights reserved.;-- file RSIOFace.asm;-- last edited by:;	DMS		22-Mar-85 15:45:31	:added mode and other goodies;----------------------------------------------------------------$NOLIST$INCLUDE		(IOPDefs.asm)$NOLIST$INCLUDE		(QueDefs.asm);;--IOCB description for RS232C which is located in the I/O Region;-- Input/Output Context Block format for Channel A(DTE) of the i8274Operation		STRUCdataBuffer		DD	?bufferByteLength	DW	?Operation		ENDSRSIOCBRecord 		STRUCrsOperation		DB 	SIZE Operation DUP (?)	;Operation pointer rsTransferCountChA	DW	?	;--byte count in the bufferrsNextIocbChA		DW	2 DUP (?) ;address of the next IOCBcurrentOpStatus		DB	?	;current operation statusrsIocbStatusByte0	DB	?	;Read register 0 of the 8274rsIocbStatusByte1	DB	?	;Read register 1 of the 8274rsIocbStatusByte2	DB	?	;Read register 2 of the 8274rsBufferPtr		DW	2 DUP (?) ;Pointer to BufferrsBufferSize		DW	?	;Size of BufferrsIOCBType		DB	?	;Rx or Tx IOCBrsActiveIOCB		DB	?	;Set when an IOCB is active cleared when notRSIOCBRecord		ENDSRSEEpromconfigImageA	STRUCrsDeviceTypeChA 	DB	?rsChAAttributes		DB	?RSEEpromconfigImageA	ENDS;*****FlowControl 	STRUCflowType	DW	?xOn		DW	?xOff		DW	?FlowControl	ENDS;The following variables are define as public in the IORRS232.asm module;they are located in shared memory because they get loaded by the HeadRS232CFCBRecord		STRUCrS232CMainTaskTcb	DB	SIZE TaskContextBlock DUP (?)txTaskChATcb		DB	SIZE TaskContextBlock DUP (?)specRxTaskChATcb	DB	SIZE TaskContextBlock DUP (?)rxTaskChATcb		DB	SIZE TaskContextBlock DUP (?)extStatTaskChATcb	DB	SIZE TaskContextBlock DUP (?)rsQueueTxChA		DB	SIZE QueueBlock DUP (?)rsQueueRxChA		DB	SIZE QueueBlock DUP (?)rs232LockMask		DW	?rs232WorkMask		DW	?RS232CFCBRecord		ENDS;				********************************RS232DCBRecord		STRUCrsIOPSystemInputPort	DW	?	rsWorkList		DW	?rsCommandWorkList		DW	?rsBaudRateChA		DW	?rsWR0ofi8274ChA		DB	?	;Write Register 0 for Channel A of MPSCrsWR1ofi8274ChA		DB	?	;Write Register 1 for Channel A of MPSCrsWR3ofi8274ChA		DB	?	;Write Register 3 for Channel A of MPSCrsWR4ofi8274ChA		DB	?	;Write Register 4 for Channel A of MPSCrsWR5ofi8274ChA		DB	?	;Write Register 5 for Channel A of MPSCrsWR6ofi8274ChA		DB	?	;Write Register 6 for Channel A of MPSCrsWR7ofi8274ChA		DB	?	;Write Register 7 for Channel A of MPSCrsReadRegister0		DB	?rsReadRegister1		DB	?rsReadRegister2		DB	?rsLatchedStatus		DB	?	;Latched status bitsrsTTYHost		DB	?rsClientType		DB	?rs232Mode		DB	?rs232FlowControl	DB	SIZE FlowControl DUP (?)rsFrameTimeoutValue	DW	?  rsClientConditionChA	DB	SIZE ClientCondition DUP (?)	rs232ChAWork		DB	SIZE Condition DUP (?)txChAWork		DB	SIZE Condition DUP (?)txChAWaitXOn		DB	SIZE Condition DUP (?)rsEEpromImage		DB	SIZE RSEEpromconfigImageA DUP (?);----  Error and status countersrsRxCRCErrorCnt		DW	?specErrorCount		DW	?rsOverRunErrors		DW	?badTxIntCnts		DW	?badRxIntCnts		DW	?badSpecRxIntCnts	DW	?badExtStatIntCnts	DW	?badTxIntTimeout		DW	?RS232DCBRecord		ENDSrs232HdlOnlyRecord	STRUCrsBytesTransfered	DW	?	rsBytesReceived		DW	?rsWatchDogTcb		DB	SIZE TaskContextBlock DUP (?);-- Inter task communication variables for rx task and spec rx tasksaveValueRR1		DB	?rsEndFrame		DB	?;-- Varriables for the receive taskrxFirstCharacterSave	DB	?rsRxActiveBuffer	DB	?rsBytesToReceive	DW	?;-- FrameTimeout parametersrsRxWatchDogValue	DW	?rsRxFrameTimeOutValue	DW	?rsRxBufferFrameTimeout	DB	?rsExtraByte1		DB	?;-- FlowControl ParametersrsRxCatchBufferCount	DW	?rsRxCatchBufferIndex	DW	?rsRxCatchBuffer		DB	64 DUP (?)rsReceiverInXOFFState	DB	?;-- Inter task communication variables for rx task and tx taskrsFlowOff		DB	?rsCheckFlowControl	DB	?rsFlowSendByte		DB	?rsSendFlowRequest	DB	?;-- For Tx for TaskrsTxActiveBuffer	DB	?rsBytesToTransfer	DW	?rs232HdlOnlyRecord	ENDS;-- Work list descriptionworkFori8274	EQU	8000HrsWorkWR7	EQU	4000HrsWorkWR6	EQU	2000HrsWorkWR5	EQU	1000HrsWorkWR4	EQU	0800HrsWorkWR3	EQU	0400HrsWorkWR1	EQU	0200HrsWorkWR0	EQU	0100HrsNewBaudRate	EQU	0080HrsChangeMode	EQU	0040H;-- Command list descriptionabortRx		EQU	8000HclearAbortRx	EQU	7FFFHabortTx		EQU	4000HclearAbortTx	EQU	0BFFFHnewTx		EQU	2000HclearNewTx	EQU	0DFFFHgetDeviceStatus	EQU	1000HcleargetDevStat	EQU	0EFFFHrsCommandInProgress EQU	0800HnoCommandInProgress EQU	0F7FFHrtsCommand	EQU	0400HdtrCommand	EQU	0200HresetValues	EQU	0100HclearResetValues EQU	0FEFFH;-- Flow control descriptionnone		EQU	0000HxOnXOff		EQU	0100H  ;this is not ByteSwapped;-- Mode Descriptionasynch		EQU	00synch		EQU	01;-- IOCB Current Operation StatuspollRxOrTx	EQU	0complete	EQU	1aborted		EQU	2frameTimeout	EQU	3disaster	EQU	4dataLost	EQU	5;			******************;-- Client descriptionrsNoClient	EQU		0rsNormal	EQU		1rsDebugger	EQU		2;Latched Status Bits;-------------------------------------latchRingHeard	EQU		20H	;latchDataLost	EQU		40H	;latchBreakDet	EQU		80H	;;-- Handler only constantsmaxWordValue		EQU	0FFFFHbytesPerPage		EQU	512rsFrameTOBase		EQU	10rsTxBufEmptyWaitTime	EQU	1rsRxCatchBufferSize	EQU	64rsRxWatchDogDefault	EQU	5		;-- 50 msecs.