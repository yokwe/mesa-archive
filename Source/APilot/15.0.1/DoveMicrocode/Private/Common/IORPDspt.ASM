$	DEBUG MOD186$	PAGELENGTH (72)$	PAGEWIDTH  (136);;Copyright (C) 1984,1985 by Xerox Corporation. All rights reserved.;-- IORegion location for the PCE Dispatcher.;-- stored as [Iris]<WMicro>Dove>IORPDspt.asm;; Created by AGK,  2-Nov-84 11:42:50; Last edited by:;;-- FHB		 9-Dec-86 17:42:10	: Moved ERD to main memory;-- AGK   	15-Oct-86 11:11:02	: Added mouse and keyboard calling labels;-- AGK   	 9-Oct-86 12:07:49	: Added clock calling labels;-- AGK   	14-Nov-85 14:33:45	: Added keyboardOverflow;-- AGK   	 4-Sep-85 16:15:20	: Added OpieAdresses for SetPCEMapping;-- JPM   	13-Aug-85 16:05:38	: Opie redesign conversion;-- AGK   	30-Jul-85 19:03:31	: Added pcIOPTasksActive boolean;-- AGK   	25-Jun-85 12:18:15	: Added 8255 emulation support;-- AGK   	10-Jun-85 17:51:45	: Added pceWorkingDNWord and hbActivated;-- AGK   	15-Apr-85 16:55:22	: Renamed pseudoConfigSwitch's;-- HNH  	18-Mar-85 12:12:24	: Changed variables for down notify;-- HNH  	18-Mar-85 11:10:58	: Added pceLockMask variable;-- HNH  	14-Mar-85 23:59:41	: Changed file name from IORPDtTw.asm to IORPDspt.asm;-- MLT   	22-Jan-85 10:47:01	: Changed for Down Notifies;-- MLT   	14-Jan-85 10:19:57	: Changed for Up Notifies;-- AGK   	17-Dec-84 18:00:36	: Added remote boolean for Remote Heads;-- AGK   	 6-Dec-84 14:57:18	: Changed position of pceMesaProcNotifyBits for Remote Heads support in KDP;-- AGK   	24-Nov-84 15:53:43	: Inserted PseudoConfig switches;-- AGK   	23-Nov-84 16:11:05	: Adapted for skeletal pceFromMesaTask;-- AGK   	2-Nov-84 11:42:50	: Adapted for pceFromPCTask; First skeletal version of IORPDspt to go with PCDsptTw.asm		NAME	IORPDspt;--------------------------------------------------------------------------------; $NOLIST$INCLUDE	(IOPDefs.asm)$INCLUDE	(OpieDefs.asm)$LIST;--------------------------------------------------------------------------------; ;;********************************************************************************PCEDispatcherIOR	SEGMENT	COMMON 	PUBLIC	pceFromMesaTaskPUBLIC	pceFromPCTaskPUBLIC	pceUpNotifyBits, pceLockMask, pceClientConditionPUBLIC	ioTrappedData, ioTrappedAddress, ioTrappedStatusPUBLIC	p8255PortA, p8255PortB, p8255PortC, p8255Control, keyboardOverflowPUBLIC	pseudoConfigSwitch0, pseudoConfigSwitch1, pseudoConfigSwitch2PUBLIC	pNMIVectorBuffer, panelValue, runPCE, hbActivated, pcIOPTasksActivePUBLIC  hBufferindex, IOCount, FtlErrPUBLIC	conditionPCEWork, pceMesaWorkMask, pceWorkingDNWordPUBLIC	firstAddress, numberOfPCBlocksPUBLIC	pceClockBootLabel, pceClockExitLabelPUBLIC	pceMouseBootLabel, pceMouseExitLabelPUBLIC	pceKeyboardBootLabel, pceKeyboardExitLabelPUBLIC	pceKeyboardResetLabel, pceKeyboardSendLabelPUBLIC	pceDiskBootLabel, pceDiskExitLabel  pceDispatcherFCB	LABEL	WORD; TaskspceFromMesaTask		TaskContextBlock <>	; handles Mesa Down NotifiespceFromPCTask		TaskContextBlock <>	; handles IO traps; Dispatching data structurepceUpNotifyBits		DW	?		; pceLockMask		DW	?		; lock mask for PCEDispatcherpceClientCondition	ClientCondition <>	; used for PCE up notifies; IO Trap VariablesioTrappedData		DW	?	; Trapped data of OUT operationioTrappedAddress	DW	?	; Address word for IO trapperioTrappedStatus		DB	?	; Status byte of IO trapper; 8259A Emulation Support - this is local, will have to be moved to end;p8259NonSpecificEOI	Condition <>	; wake up any task waiting on EOI; 8255 Emulation Support; Moved variables  down to the local variables area; Pseudo Configuration SwitchespseudoConfigSwitch0	DB	?	; RS232C, Game, PrinterspseudoConfigSwitch1	DB	?	; Floppies, Display, RAM, etcpseudoConfigSwitch2	DB	?	; Boot, Rigid, AllRAM; Variables used in PCDsptch; Allocate NMI vector buffer for swapping CS:IPpNMIVectorBuffer	LABEL	WORD			DD	?	; To store intermediate CS:IPpanelValue		DW	?	; Contains current value diplayed by LEDs; Init/Exit variablesrunPCE			DB	?	; Boolean variable for AllowPCEhbActivated		DB	?	; Boolean for IO Histroy Buffer usagepcIOPTasksActive	DB	?	; Boolean for specifying PCE tasks statekeyboardOverflow	DB	?	; For CopyIn > 15 chars; History buffer variablehBufferindex		DW	?	; History Buffer index pointer; IO ERROR CONTROL BLOCK variableIOCount			DB	?	; IO Counter, track number of out 					;operations up to 3FtlErr			DB	?	; Fatal error flag; local variables for Down Notify conditionconditionPCEWork	Condition <>	; wake up from int to notifierpceMesaWorkMask		DW	?pceWorkingDNWord	DW	?	; For DN scanning loop; 8255 Emulation Supportp8255PortA		DB	?p8255PortB		DB	?p8255PortC		DB	?p8255Control		DB	?; OpieAddresses for SetPCEMappingfirstAddress		OpieAddress <>numberOfPCBlocks	DB	?;pDummyByte		DB	?; Calling labels for memory handlers; ClockpceClockBootLabel	SegmentAndOffset <>pceClockExitLabel	SegmentAndOffset <>; MousepceMouseBootLabel	SegmentAndOffset <>pceMouseExitLabel	SegmentAndOffset <>; KeyboardpceKeyboardBootLabel	SegmentAndOffset <>pceKeyboardExitLabel	SegmentAndOffset <>pceKeyboardResetLabel	SegmentAndOffset <>pceKeyboardSendLabel	SegmentAndOffset <>pceDiskBootLabel	SegmentAndOffset <>pceDiskExitLabel	SegmentAndOffset <>PCEDispatcherIOR	ENDS		END