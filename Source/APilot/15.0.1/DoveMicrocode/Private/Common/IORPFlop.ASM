$	DEBUG MOD186$	PAGELENGTH (72)$	PAGEWIDTH  (136);;Copyright (C) 1984, 1985 by Xerox Corporation. All rights reserved.;-- IORegion locations for the PC floppy disk emulator.;--;;-- last edited by:;-- GPV		21-Nov-85 11:04:33	;Swapped pFlopMemorySizeLo & pFlopMemorySizeHi and added comments;-- JPM		20-Aug-85 16:16:38	;Move pceFloppyWorkMask above pceFloppyIOCB for easier access by Mesa world;-- JPM		13-Aug-85 16:22:20	;Opie redesign conversion;-- GXV		11-Jun-85 14:46:39	;deleted pceFloppyUpnotifyMask;-- AGK		 3-Jun-85 11:39:16	:Made all DB and DW as ?;-- GXV		 8-Apr-85 11:29:11	;Updated IOCB offset to incorporate OPIE19 related changes in FlopFace.asm;-- GXV		12-Oct-84 10:42:21	;Cosmetic changes;-- GXV		7-Sep-84 17:23:33	:Included FlopFace.asm and made related changes;-- GXV		02-Aug-84 		:Creation (data taken from IORPflop.asm)		NAME	IORPFlop;--------------------------------------------------------------------------------; $NOLIST$INCLUDE		(IOPDefs.asm)$INCLUDE		(FlopFace.asm)$LIST;--------------------------------------------------------------------------------; ;;********************************************************************************PCEFloppyIOR		SEGMENT	COMMON PUBLIC		pceFloppyWaitIOPUBLIC		pceFloppyHandlerDonePUBLIC		pceFloppyEmulatorStatePUBLIC		pceFloppyEmulatorParamCountPUBLIC		pceFlopIndexPUBLIC		pceDriveNumberSpecifiedPUBLIC		pDORPUBLIC		pFDCMSRPUBLIC		pceHasRealDrivePUBLIC		pFDCRealDrivePUBLIC		pFlopLogicalDrivePUBLIC		pDORRealDrivePUBLIC		pceFloppyIOCBPUBLIC		pFlopDebugValuePUBLIC		pFlopErrorPUBLIC		pFlopMemorySizeHiPUBLIC		pFlopMemorySizeLoPUBLIC		pFlopDriveNumberPUBLIC		pceFloppyConditionWorkPUBLIC		pceFloppyWorkMaskpceFloppyFCB		LABEL	WORDPUBLIC			pceFloppyTask; -----------   Initialized in the Mesa WorldpFlopMemorySizeLo	DW	?	; low 16 bits of memory sizepFlopMemorySizeHi	DW	?	; High 16 bits of memory sizepceHasRealDrive		DB	?		; set to 1 if pc can access the real floppy drive. Set by MesaFloppyFunction at PC init time.pFDCRealDrive		DB	?	; The drive number used by the FDC to select the physical drive pFlopLogicalDrive	DB	?	; Number of the logical drive that gets mapped to physical drive # 0pDORRealDrive		DB	?	; One High Nyble bit is set to correspond to the above pFlopLogicalDrive variablepceFloppyWorkMask	DW	?	; Mask for down notifies; -----------	IOCB for floppy Handler; The IOCB structure is defined in FlopFace.asm and FloppyIOFaceDove.mesa.; The emulator uses the same defition, except for one crucial detail; The IOCB structure has an array of fdcCommandRecord as the last field; The number of elements in this array is MaxfdcCommandsInIOCB.; The IOCB generated by the emulator will contain only ONE fdcCommandRecord; (This is because the PCE-186 thinks it is talking to the FDC).; So the pceFloppyIOCB has a ONE element array of fdcCommandRecord.; This shortening of length of pceFloppyIOCB is acheived ; by the ORG statement following the IOCB declaration.pceFloppyIOCB		IOCB	<>		; IOCB that will be passed to the FloppyHandler			ORG	OFFSET ($-((MaxfdcCommandsInIOCB-1)*SIZE(fdcCommandRecord))); Since the pce is garuanteed to send only one FDC command at a time; NOTE: As as consequence of the above ORG statement the variables declared; below are not accesible to the Mesa World.; ------------- Condition variablespceFloppyTask		TaskContextBlock	<>pceFloppyConditionWork	Condition	<> ; caused if Mesa has work for EmulatorpceFloppyWaitIO		Condition		<> ; Wait for IN/OUT to 3F5; used by dispatcher to notify floppy EmulatorpceFloppyHandlerDone	Condition	<> ; Wait for FloppyHandler to notify the user; -----------	Emulator specific variablespceFloppyEmulatorState	DB	?		; Initial state 0pceFloppyEmulatorParamCount	DB	?	; keeps track of bytes xfered to/from PCpceFlopIndex		DB	?	; Index into command tablepceDriveNumberSpecified DB	?	; Boolea; set to 1 iff the command has drive number specified in 2nd parameter.pDOR			DB	?		; Digital Output RegisterpFDCMSR			DB	?		; corresponds to MSRpFlopDriveNumber	DB	?	; copy of the drive number this request is made topFlopDebugValue		DB	?	; byte used for debuggingpFlopError		DB	?	; PCEFloppyIOR		ENDS		END