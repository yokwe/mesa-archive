;MoonLink.def;last edited by HEM		13-Mar-87 13:24:28;;Definitions here provide for linking the diagnostic objects.;Code LInk Definitions.MonitorCodeLoc   equ	0000h ;Start Monitor CodeMonitorCodeSize  equ	0B4Ch ExtMCBlock       equ MonitorCodeLoc+MonitorCodeSizeMCBlockSize	 equ	32H ExtMFSCBlock     equ ExtMCBlock+MCBlockSizeMFSCBlockSize	 equ	54 ExtMKCBlock      equ ExtMFSCBlock+MFSCBlockSizeMKCBlockSize	 equ	29H+1LoaderCodeLoc    equ ExtMKCBlock+MKCBlockSizeLoaderCodeSize	 equ	260h ExtDisplayLoc    equ LoaderCodeLoc+ LoaderCodeSizeExtcursorWordLocn    equ ExtDisplayLoc+15DisplayCodeSize  equ 	232H TestCodeLoc      equ ExtDisplayLoc+DisplayCodeSize ExtMFCBlockLoc   equ TestCodeLoc+16HExtMFCBlock      equ ExtMFCBlockLocMFCBlockSize	 equ	2AH+2 ExtTCBlockLoc    equ ExtMFCBlockLoc +MFCBlockSizeExtTCBlock       equ ExtTCBlockLocMnDgDvCpLoc	 EQU	1A00H	;hard coded location for CP loader,				;because it has to be on an even boundary.				;Make sure that MnDgDvCpLoc >= TestCodeLoc.ITCBBlockSize        equ    100H+2DSTCBBlockSize       equ    100H+2DYTCBBlockSize       equ    100H+2MTCBBlockSize        equ    478H+1ETCBBlockSize        equ    100H+2FTCBBBlockSize       equ    1DCH+2RTCBBlockSize        equ    384H+2DTCBBlockSize        equ    200H+2;/// need E6H, leave spare for 1 drive typeMuTCBBlockSize       equ    4D0H+2PTCBBlockSize        equ    500H+2PSOTCBBLocksize	     equ    100H+2PPOTCBBlocksize	     equ    180H+2ExtDaisyTlistLoc equ  ExtTCBlockLoc+DSTCBBlockSizeExtDayTlistLoc   equ  ExtDaisyTlistLoc DaisyTList0 equ ExtTCBlock+DSTCBBlockSizeDaisyTList0Size equ 1CH*2DaisyTList1 equ DaisyTList0+DaisyTList0SizeDaisyTList1Size equ 19H*2DaisyTList2 equ DaisyTList1+DaisyTList1SizeDaisyTList2Size equ 18H*2DaisyTList3 equ DaisyTList2+DaisyTList2SizeDaisyTList3Size equ 08H*2DaisyTList4 equ DaisyTList3+DaisyTList3SizeDaisyTList4Size equ 1CH*2DaisyTList5 equ DaisyTList4+DaisyTList4SizeDaisyTList5Size equ 06H*2DaisyTList6 equ DaisyTList5+DaisyTList5SizeDaisyTList6Size equ 05H*2DaisyTList7 equ DaisyTList6+DaisyTList6SizeDaisyTList7Size equ 04H*2DayTList0 equ ExtTCBlock+DYTCBBlockSizeDayTList0Size equ 0FH*2DayTList1 equ DayTList0+DayTList0SizeDayTList1Size equ 26H*2DayTList2 equ DayTList1+DayTList1SizeDayTList2Size equ 39H*2DayTList3 equ DayTList2+DayTList2SizeDayTList3Size equ 0CH*2DayTList4 equ DayTList3+DayTList3SizeDayTList4Size equ 13H*2DayTList5 equ DayTList4+DayTList4SizeDayTList5Size equ 14H*2DayTList6 equ DayTList5+DayTList5SizeDayTList6Size equ 06H*2DayTList7 equ DayTList6+DayTList6SizeDayTList7Size equ 04H*2MaxTListSize equ 180h+2MaxTeleSize equ 124h+2CSTestCodeLoc      equ ExtTCBlockLoc+ITCBBlockSize TeleCodeLoc 	   equ ExtDayTlistLoc+MaxTListSizeCPTestCodeLoc      equ TeleCodeLoc+MaxTeleSize MemTestCodeLoc     equ ExtTCBlockLoc+MTCBBlockSizeEthTestCodeLoc     equ ExtTCBlockLoc+ETCBBlockSizeFlpTestCodeLoc     equ ExtTCBlockLoc+FTCBBBlockSizeRS232TestCodeLoc   equ ExtTCBlockLoc+RTCBBlockSizeDiskTestCodeLoc    equ ExtTCBlockLoc+DTCBBlockSizeMultTestCodeLoc    equ ExtTCBlockLoc+MuTCBBlockSizePCETestCodeLoc     equ ExtTCBlockLoc+PTCBBlockSizePSOTestCodeLoc	   equ ExtTCBlockLoc+PSOTCBBlocksizePPOTestCodeLoc	   equ ExtTCBlockLoc+PPOTCBBlocksizeTestCodeLoc2  equ MonitorCodeLoc+6000H ;Start Test Code  Buffers = 6000hTestCodeLoc3  equ MonitorCodeLoc+9000H ;Start Test Code  Buffers = 9000hDataLoc  equ  0hStackLoc  equ  560h;SizeOf Things;-----------------------------------------------------------------IOPStackSize 	equ    0A0H;Size Of Code In File OverlayFile4CodeSize equ 500H File5CodeSize equ 300H File6CodeSize equ 300HFile7CodeSize equ 300HFile8CodeSize equ 300HFile9CodeSize equ 300HFile10CodeSize equ 826H File11CodeSize equ 300HFile12CodeSize equ 300HMOONFilePCodeSize equ 1000HMemAnalizeCodeLoc  equ MemTestCodeLoc+File10CodeSizeMemAnalizeCodeSize equ 2BAH MemLogCodeLoc equ MemAnalizeCodeLoc+MemAnalizeCodeSizeMemLogCodeSize equ 0A0H;Size of CP boot loader stuffMnDgDvCPSize	EQU	00E7H;Size Of Mesa Code Block In File OverlayExtMOONRISEICodeSize equ 3798 ExtMOONRISE1CodeSize equ 3278ExtMOONRISE2CodeSize equ 4574ExtMOONRISE3CodeSize equ 3142ExtMOONRISE4CodeSize equ 4542ExtMOONRISE5CodeSize equ 662  ExtMOONRISE6CodeSize equ 5934 ExtMOONRISE7CodeSize equ 950  ExtMOONMEMMCCodeSize equ 4380 ExtMOONBUSCodeSize equ 700 ExtMOONSUN1CodeSize equ 2200 ExtMOONSUN2CodeSize equ 4600 ExtMOONSUN3CodeSize equ 2200 ExtMOONSUN4CodeSize equ 2500 ExtMOONSUN5CodeSize equ 1700 ExtMOONTIMECodeSize equ 1800ExtMOONMRCodeSize equ 2000 ExtMOONDMMCCodeSize equ 5600 ;ORG Values for Control Blocks used by OverlaysExtMOONRISEI equ CPTestCodeLoc+File5CodeSizeExtMOONRISE1 equ ExtMOONRISEI+ExtMOONRISEICodeSizeExtMOONRISE2 equ CPTestCodeLoc+File6CodeSizeExtMOONRISE3 equ ExtMOONRISE2+ExtMOONRISE2CodeSizeExtMOONRISE4 equ CPTestCodeLoc+File7CodeSizeExtMOONRISE5 equ ExtMOONRISE4+ExtMOONRISE4CodeSizeExtMOONRISE6 equ CPTestCodeLoc+File12CodeSizeExtMOONRISE7 equ ExtMOONRISE6+ExtMOONRISE6CodeSizeExtMOONBUS   equ CPTestCodeLoc+File8CodeSizeExtMOONSUN1  equ ExtMOONBUS+ExtMOONBUSCodeSizeExtMOONSUN2  equ ExtMOONSUN1+ExtMOONSUN1CodeSizeExtMOONSUN3  equ CPTestCodeLoc+File9CodeSizeExtMOONSUN4  equ ExtMOONSUN3+ExtMOONSUN3CodeSizeExtMOONSUN5  equ ExtMOONSUN4+ExtMOONSUN4CodeSizeExtMOONTIME  equ CPTestCodeLoc+File11CodeSizeExtMOONMR    equ ExtMOONTIME+ExtMOONTIMECodeSizeExtMOONMEMMC equ MemLogCodeLoc+MemLogCodeSizeExtMOONDMMC  equ MemLogCodeLoc+MemLogCodeSizeExtMOONPMC   equ MemTestCodeLoc+MOONFilePCodeSize;-----------------------------------------------------------------IntVectorSize   equ    0E0h ;(this is words, S/B 0E0H Later);Pointers to Interrupt Vectors ExtInterrupt86V equ  0ExtInterruptV1 equ   80hExtInterruptV2 equ   0C0hExtTimerDMAV equ     0E0hExtDCommVectors equ  0100hExtKeyVectors equ    0120hExtUnusedVectors equ 0140h;Index Pointers for Control Blocks used by OverlaysExtFileNumber equ ExtMFSCBlock+38ExtMemConf equ MCBlockSize+MFSCBlockSizeExtMemConf1 equ ExtMemConf+2ExtBootConf equ ExtMemConf1+2WrRstCtlRegMask equ ExtBootConf+2WrCtlRegMask equ WrRstCtlRegMask+2ExtInputByte equ 15ExtStartingTestNum equ 10;Index Pointers to Mesa Code Block In File OverlaysIndexMOONRISEI equ ExtMOONRISEIIndexMOONRISE1 equ ExtMOONRISE1IndexMOONRISE2 equ ExtMOONRISE2IndexMOONRISE3 equ ExtMOONRISE3IndexMOONRISE4 equ ExtMOONRISE4IndexMOONRISE5 equ ExtMOONRISE5IndexMOONRISE6 equ ExtMOONRISE6IndexMOONRISE7 equ ExtMOONRISE7IndexMOONBUS   equ ExtMOONBUSIndexMOONSUN1  equ ExtMOONSUN1IndexMOONSUN2  equ ExtMOONSUN2IndexMOONSUN3  equ ExtMOONSUN3IndexMOONSUN4  equ ExtMOONSUN4IndexMOONSUN5  equ ExtMOONSUN5IndexMOONMEMMC equ ExtMOONMEMMCIndexMOONDMMC  equ  ExtMOONDMMCIndexMOONTIME  equ ExtMOONTIMEIndexMOONMR    equ ExtMOONMRMesaFilePtr equ 4MonitorFilePtr equ MesaFilePtr+2 ;This INCLUDE THE LOADEROtherMonitorPtr equ MonitorFilePtr+2 ;This INCLUDE THE LOADERShortPtr equ OtherMonitorPtr+2 ;LongPtr equ ShortPtr+2CSFilePtr equ LongPtr+2CPFilePtr equ CSFilePtr+2MemoryFilePtr equ CPFilePtr+2EithernetFilePtr equ MemoryFilePtr+2FloppyFilePtr equ EithernetFilePtr+2Rs232FilePtr equ FloppyFilePtr+2PCEFilePtr equ Rs232FilePtr+2DiskFilePtr equ PCEFilePtr+2SystemFilePtr equ DiskFilePtr+2PSFilePtr equ SystemFilePtr+2PPFilePtr	EQU	PSFilePtr+2MonitorCode	SEGMENT  COMMON	ASSUME	CS:MonitorCode, SS:MonitorCode, DS:MonitorCode	  StartOfLink   LABEL NEAR;MoonRise.asmExtStart   equ  StartOfLink+MonitorCodeLoc  ExtDoRunTimeWork   equ ExtStart+3 ExtEnableInt    equ ExtDoRunTimeWork+3 ExtMessage    equ ExtEnableInt+3ExtPutNextKey    equ ExtMessage+3ExtOffWrCtlReg    equ ExtPutNextKey+3ExtOnWrCtlReg    equ ExtOffWrCtlReg+3ExtOffWrRstCtlReg    equ ExtOnWrCtlReg+3ExtOnWrRstCtlReg    equ ExtOffWrRstCtlReg+3ExtSetTCBPointer    equ ExtOnWrRstCtlReg+3ExtGetNextKey    equ ExtSetTCBPointer+3ExtReadEEProm    equ ExtGetNextKey+3;MoonDayB.asmExtDownLoader equ StartOfLink+LoaderCodeLocExtReadShift equ ExtDownLoader+3ExtWriteShift equ ExtReadShift+3ExtWriteCSWord equ ExtWriteShift+3ExtReadCSWord equ ExtWriteCSWord+3ExtStopCp equ ExtReadCSWord+3ExtStartCp equ ExtStopCp+3ExtResetCp equ ExtStartCp+3ExtInterruptCp equ ExtResetCp+3ExtResetMesaInt equ ExtInterruptCp+3ExtDoInToOutD equ ExtResetMesaInt+3ExtWriteNewAdd equ ExtDoInToOutD+3ExtWriteBranches equ ExtWriteNewAdd+3ExtNewStartCp equ ExtWriteBranches+3ExtNewStartM equ ExtNewStartCp+3;MoonDayBD.asmExtDisplayCode equ StartOfLink+ExtDisplayLocExtStartDisplay equ ExtDisplayCode+3ExtStopDisplay equ ExtStartDisplay+3ExtCursorPattern equ ExtStopDisplay+3ExtReadMemStatus equ ExtCursorPattern+3;MoonDayTL.asmExtTelescopeCp equ StartOfLink+TeleCodeLocExtUnTelescopeCp equ ExtTelescopeCp+3ExtSetTelValues equ ExtUnTelescopeCp+3;Ext's for each overlayExtTestCode equ StartOfLink+TestCodeLocExtPreProcess equ ExtTestCode+3ExtFRUList equ ExtPreProcess+3ExtClearLog equ ExtFRUList+3ExtParityDataLog equ ExtClearLog+3ExtParityAddressLog equ ExtParityDataLog+3ExtPostProcess equ ExtParityAddressLog+3;MoonAnal.asmExAnalize equ StartOfLink+MemAnalizeCodeLocExClearLog equ  ExAnalize+3ExParityDataLog equ  ExClearLog+3ExParityAddressLog equ  ExParityDataLog+3;MnDgDbCp.asm	(DayBreak-specific pieces of CP boot loader)MnDgDbCpLoc	EQU	MnDgDvCpLoc + MnDgDvCPSizeMonitorCode	ENDS;-----------------------------------------------------------------DiskDevice equ   1FloppyDevice equ 2EtherDevice equ  3BurdockDevice equ 4NormalType  equ   0DiagnosticType  equ   1RunBootUI  equ   0SkipBootUI  equ   1ShortType  equ   0LongType  equ   1BootIcons Equ	1BootStruc equ 540HBoot	STRUCOpieReentry  DW 0  		 ;IP:CS for restarting OpieOpieReentrySeg  DW 0BootOverlayReentry DW 0 	 ;IP:CS for jump point after restartBootOverlayReentrySeg DW 0BootType  DB 0			;0 = normal, 1 = diagnosticSkipUserInterface  DB 0		;0 = run boot UI, 1 = skip UIBootOverlayRequest DW 0		;overlay number (1 = monitor)BootDevice         DW 0  	;1-disk, 2-floppy ,3-ethernet,4-BurdockDiagType           DB 0  	;0 = short, 1 = longFinishMode         DB 0   ;0 = boot system, 1 = back to user interface, 2 = stopBoot	ENDS;-----------------------------------------------------------------; Monitor Control Block Defs;-----------------------------------------------------------------MCBlock	STRUC ErrorControl DB  0LoopControl DB  0TestControl DB  0FileControl DB  0MPOutputControl  DB  0EditControl DB  0CurrentInputByte DB  0UnExpectedInts DB  0JumpFile DB  0JumpControl DB  0Spare0 DB  0JumpTest DB  0EnableIntC1C2 DW  0EnableIntDmaRs232 DW  0EnableIntExp DW  0AccuWord DW  0DataPointer DW  0ControlBlockIndex DW  0InCSAddress DW  0InCSAddress1 DW  0InCSData0 DW  0InCSData1 DW  0InCSData2 DW  0OutCSAddress DW  0OutCSAddress1 DW  0OutCSData0  DW  0OutCSData1  DW  0OutCSData2  DW  0OutCSData3  DB  0InCSData3 DB  0MesaFault DB  0IOPFault DB  0InRange DW  0;Monitor File Stream Control BlockFileN DB  0FilePointer DB  0FileE DB  0FileS DB  0FilePtrs DB 38 DUP(0)FileNumber  DB  16 DUP(0)MCBlock	ENDS;Monitor Keyboard Buffer;-----------------------------------------------------------------MKCBlock	STRUC MemConf  DW  0 ;----Had to put this somewhereMemConf1  DW  0 ;----Had to put this somewhereBootConf DB  0MKBSpare0 DB  0MaskWrRstCtlReg  DW  0 ;----Had to put this somewhereMaskWrCtlReg DW  0OutputPointer DB  0InputPointer DB  0PointerToBufEnd DB  20PointerToBufStart DB  0MouseCount DB 0MouseByte DB  0InputByte  DB  20 DUP(0)MKCBlock	ENDS;-----------------------------------------------------------------MFCBlock  STRUC  TestN DB  0FileNumberBias DB  0TestNE DB  0TestNS DB  0TestSizeConf DB  0FileType DB  0ConfigInfo DB  0FCBSpare0 DB  0TCBPointer DW  ExtTCBlockStartingTestNum DB  64 DUP(0)MFCBlock ENDS;-----------------------------------------------------------------;File Type ControlFileType2		Equ	2 ;Loader FileFileType4		Equ	4 ; CS Test FileFileType5		Equ	5 ; Daisy CP FileFileType6		Equ	6 ;Daisy CP FileFileType7		Equ	7 ;Daisy CP FileFileType8		Equ	8 ;DayBreak CP FileFileType9		Equ	9 ;DayBreak CP FileFileType10		Equ	10 ;Daisy/DayBreak Memory FileFileType11		Equ	11 ;DayBreak CP/DayBreak Pre-Memory FileFileType12		Equ	12 ;Daisy CP and Pre-Memory File;-----------------------------------------------------------------;Legal Test Numbers for Files with Mesa Processer Code OverlaysFile5Test0 equ 0File5Test1 equ 1File6Test0 equ 2File6Test1 equ 3File7Test0 equ 4File7Test1 equ 5File12Test0 equ 6File12Test1 equ 7File8Test0 equ 0File8Test1 equ 1File8Test2 equ 2File9Test0 equ 3File9Test1 equ 4File9Test2 equ 5File11Test0 equ 6File11Test1 equ 7;-----------------------------------------------------------------ParityIntEnAble equ 0FEFFHKeyBoardIntEnAble equ 0F7FFHDisplayIntEnAble equ 0DFFEHDisplayIntDisable equ 00001HMesaIntEnAble equ 0DFDFHDisableAllInt equ 0FFFFHInitialIntEnable equ 0777FHENetIntEnable	EQU	0DFFDH	Rs232IntEnable	equ	0EFFFHRs232IntDisable	equ	01000HnonSpecificEOI	equ	020H		;Dismisses highest interrupt in progress;-----------------------------------------------------------------IntrCtrl1  STRUC  ParityV DW  0ParityVS DW  0BurdockInV DW  0BurdockInVS DW  0BurdockOutV DW  0BurdockOutVS DW  0KeyBoardV DW  0KeyBoardVS DW  0Rs232CV DW  0Rs232CVS DW  0InteruptC2V DW  0InteruptC2VS DW  0TimerCV DW  0TimerCVS DW  0PCV DW  0PCVS DW  0IntrCtrl1 ENDS;-----------------------------------------------------------------IntrCtrl2  STRUC  DEventV DW  0DEventVS DW  0EthernetV DW  0EthernetVS DW  0RDCDmaV DW  0RDCDmaVS DW  0RDCContrV DW  0RDCContrVS DW  0FloppyV DW  0FloppyVS DW  0MesaV DW  0MesaVS DW  0ExpansionCV DW  0ExpansionCVS DW  0SlaveIR7V DW  0SlaveIR7VS DW  0IntrCtrl2 ENDS;-----------------------------------------------------------------IntrCtrl3  STRUC  Exp0V DW  0Exp0VS DW  0Exp1V DW  0Exp1VS DW  0Exp2V DW  0Exp2VS DW  0Exp3V DW  0Exp3VS DW  0Exp4V DW  0Exp4VS DW  0Exp5V DW  0Exp5VS DW  0Exp6V DW  0Exp6VS DW  0ExpIR7V DW  0ExpIR7VS DW  0IntrCtrl3 ENDS;-----------------------------------------------------------------TimerDMA  STRUC  Timer0V DW  0Timer0VS DW  0TimerSpare0 DW  0TimerSpare0S DW  0DMA0V DW  0DMA0VS DW  0DMA1V DW  0DMA1VS DW  0Timer1V DW  0Timer1VS DW  0Timer2V DW  0Timer2VS DW  0TimerSpare1 DW  0TimerSpare1S DW  0TimerSpare2 DW  0TimerSpare2S DW  0TimerDMA ENDS;-----------------------------------------------------------------;DCommOrKeyVectors  STRUC  ;BTxEmptyV DW  0;BTxEmptyVS DW  0;BExtStatusV DW  0;BExtStatusVS DW  0;BRxCharAvailV DW  0;BRxCharAvailVS DW  0;BSpecialRxCondV DW  0;BSpecialRxCondVS DW  0;ATxEmptyV DW  0;ATxEmptyVS DW  0;AExtStatusV DW  0;AExtStatusVS DW  0;ARxCharAvailV DW  0;ARxCharAvailVS DW  0;ASpecialRxCondV DW  0;ASpecialRxCondVS DW  0;DCommOrKeyVectors ENDS;-----------------------------------------------------------------;	END	MOONLinkDefs