-- Copyright (C) 1984  by Xerox Corporation. All rights reserved. -- IncrementalSort.mesa-- last modified by read,    10-Feb-84 15:57:57DIRECTORY  CH USING [Element, NameStreamProc],  NSName USING [Name];IncrementalSort: DEFINITIONS =  BEGIN    Handle: TYPE[2];    Root: TYPE[2];    nullHandle: Handle = LOOPHOLE[LONG[NIL], Handle];    nullRoot: Root = LOOPHOLE[LONG[NIL], Root];    EachNodeProc: TYPE = PROCEDURE[    currentName: CH.Element, userData: LONG UNSPECIFIED];      MakeSorter: PROCEDURE [    elementsAreAlreadyInOrder: BOOLEAN, ignoreOrg, ignoreDomain,     ignoreLocal: BOOLEAN, z: UNCOUNTED ZONE ¬ NIL] RETURNS [Handle];    AddElement: PROCEDURE [h: Handle, e: NSName.Name, userData: LONG UNSPECIFIED ¬ LONG[NIL]] RETURNS [node: Root];    -- makes a (partial) copy of e and adds it to the sorted elements.      DeleteElement: PROCEDURE[h: Handle, e: CH.Element];    -- deletes e if e is in the sorted elements, otherwise no-op.    DumpElements: PROCEDURE [h: Handle, eachElement: CH.NameStreamProc ¬ NIL, userSpecifiedDefaults: NSName.Name ¬ NIL, dumpDataAlso: BOOLEAN ¬ FALSE, eachElementWithData: EachNodeProc ¬ NIL];    -- All strings are valid until user calls Destroy.  DumpElements has two    -- callback routines as parameters, but only one of them will be called    -- in each call to DumpElements.  If the user wants the user data that is    -- in the node as well as the name, then dumpDataAlso should be true, and     -- eachElementWithData will be called.  Otherwise, dumpDataAlso should be    -- false, and eachElement will be called.      GetElementCount: PROCEDURE [h: Handle] RETURNS [count: CARDINAL];    -- h is smashed to NIL after the sorter has been destroyed.    Destroy:  PROCEDURE [h: LONG POINTER TO Handle];    -- added hack to support old protocol, old remote entries.  -- This finds and returns to the client the entry (or NIL) that matches 'name'.  -- The client overrides the ignore fields in the handle by specifying them   -- then as parameters.  The client must take care to insure that the search will  -- still work in view of the entries were added wrt one combination of fields  -- but is searched on another combination of fields.  -- HACK!!!!!    FindElement: PROCEDURE [h: Handle, name: NSName.Name, ignoreOrg, ignoreDomain, ignoreLocal: BOOLEAN] RETURNS [e: NSName.Name, userData: LONG UNSPECIFIED, node: Root];    ExtractName: PROCEDURE [r: Root] RETURNS [name: NSName.Name];    ExtractUserData: PROCEDURE [r: Root] RETURNS [userData: LONG UNSPECIFIED];      END..LOG27-Aug-82 10:16:18 -BLyon - IncrementalSort.mesa 28-Feb-83 14:12:18 - read -  2-Jan-84 23:24:50 - Gealy - Minor format edits.10-Feb-84 15:57:05 - read - changed the parameter to Destroy to be LONG POINTER TO Handle    