-- Copyright (C) 1984  by Xerox Corporation. All rights reserved. -- CHCommonLookups.mesa-- last edited by Gealy,   2-Jan-84 23:02:07-- Provides utilities supporting several common forms of CH entry lookup.-- Applications of CH will have different opportunities for optimizing their-- CH access routines. Blind use of these utilities is decidedly suboptimal-- for many applications.-- PropertyIDs for the clearinghouse are broken down into three subsets, primary-- properties (the right hand side for these is a comment), secondary properties,-- and generic properties (AddressList, Mailbox, and Authentication Keys).-- Descriptions for mailboxes and authentication keys are private. No one except-- the mail service and authentication service should try to decipher right hand-- sides for these properties.-- NOTES ON THE SUCCESS OF LOOKUPS: If rc.Code is done AND succeeded is TRUE, then-- everything went well with a lookup.  If succeeded is FALSE, something went-- wrong when deserializing data (the right hand side of pid may not have been a-- string in LookupStringProperty, etc.).  If rc.Code is not done, consult the-- return code to find out what went wrong.DIRECTORY  CH USING [ConversationHandle, Name, PropertyID, ReturnCode],  Courier USING [Parameters],  NSName USING [Name],  NSString USING [String],  System USING [NetworkAddress];CHCommonLookups: DEFINITIONS =  BEGIN  LookupAddress: PROCEDURE [conversation: CH.ConversationHandle, name: CH.Name]    RETURNS [      rc: CH.ReturnCode, address: System.NetworkAddress, succeeded: BOOLEAN];  -- Looks up the address list associated with name, deserializes it and returns  -- the nearest address.  LookupStringProperty: PROCEDURE [    conversation: CH.ConversationHandle, name: CH.Name, pid: CH.PropertyID,    heap: UNCOUNTED ZONE]    RETURNS [      rc: CH.ReturnCode, stringProperty: NSString.String, succeeded: BOOLEAN];  -- Looks up the string associated with pid, and uses the heap to allocate  -- storage for the returned stringProperty.     LookupNameProperty: PROCEDURE [    conversation: CH.ConversationHandle, name: CH.Name, pid: CH.PropertyID,    heap: UNCOUNTED ZONE]    RETURNS [rc: CH.ReturnCode, nameProperty: NSName.Name, succeeded: BOOLEAN];  -- Looks up the name associated with pid, and uses the heap to allocate  -- storage for the returned nameProperty.  LookupAnyValueProperty: PROCEDURE [    conversation: CH.ConversationHandle, name: CH.Name,    parameters: Courier.Parameters, pid: CH.PropertyID, heap: UNCOUNTED ZONE]    RETURNS [rc: CH.ReturnCode, succeeded: BOOLEAN];  -- Used to lookup secondary properties (they must be value properties). The  -- right hand side of pid is looked up and deserialized using parameters. If  -- succeeded is TRUE, the client is responsible for any storage that was  -- allocated in the lookup.  Courier.Free will need to be used to free any  -- space allocated by Courier.   END..  LOG11-Nov-83 15:50:24 - Read - created. 2-Jan-84 23:02:10 - Gealy - added succeeded to results of LookupAddress.