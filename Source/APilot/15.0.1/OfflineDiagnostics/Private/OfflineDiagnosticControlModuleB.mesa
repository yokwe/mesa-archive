-- File: OfflineDiagnosticControlModuleB.mesa -- Last edited on 26-Oct-87 15:44:09 by JMA---- Copyright (C) 1984, 1985, 1986, 1987 by Xerox Corporation. All rights reserved.--DIRECTORY  CMDiagMsgKeysDove		USING [cmMsgKeys],  Heap				USING [systemZone],  OfflineDiagInterface		USING [ClientPackage,	--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~	-- Clients in OfflineDiagInterface 	--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~   	RunEthernetTests,	RunFloppyDiscTests,	RunTapeDriveTests,	RunFormatterScavengerBPU,	RunHardDiscTests,	RunKbdDsplMouseTests,	RunPrinterTests,	RunRS232CTests,	RunSystemConfigurator],  OfflineDiagInterfaceExtra	USING [  	--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~	-- Add all new clients here !!!!	--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~        RunFloppyDiscUtilities,	RunSecureDeviceTests,	RunScannerTests,	RunCartridgeTapeTests ],  OfflineDiagnosticControlInternal,  Runtime			USING [ControlLink, IsBound];OfflineDiagnosticControlModuleB: PROGRAM  IMPORTS CMDiagMsgKeysDove, Heap, OfflineDiagInterface, OfflineDiagInterfaceExtra, Runtime	    EXPORTS OfflineDiagInterfaceExtra, OfflineDiagnosticControlInternal  =BEGIN     OPEN Msg: CMDiagMsgKeysDove, Odci: OfflineDiagnosticControlInternal,            Odi: OfflineDiagInterface, OdiExtra: OfflineDiagInterfaceExtra;    ClientCount:TYPE = Odci.ClientCount;    clientCount: PUBLIC CARDINAL;  -- Number of clients bound in the boot file  clients: PUBLIC ARRAY ClientCount OF LONG POINTER TO Odci.SubSystem ¬ ALL[NIL];--~~~~~~~~~~~~~~~~~~-- Public Procedures     --~~~~~~~~~~~~~~~~~~-- Check to see who is thereValidateClients: PUBLIC PROC[checkOnly: BOOLEAN ¬ TRUE] RETURNS[valid: BOOLEAN] =  BEGIN      -- See if client package is bound in    CheckPresence: PROC [client: Odi.ClientPackage, name: LONG STRING] = {      IF Runtime.IsBound [LOOPHOLE[client, Runtime.ControlLink]] THEN {         clientCount ¬ clientCount+1;	 IF checkOnly THEN RETURN;         clients[clientCount] ¬ Heap.systemZone.NEW [Odci.SubSystem];         clients[clientCount].name ¬ name;         clients[clientCount].startUpProc ¬ client }};	     clientCount ¬ 0;        --******************************************************    -- This is the client table. Add a line for each client    --******************************************************    CheckPresence [Odi.RunEthernetTests, Msg.cmMsgKeys[runEthernet]];    CheckPresence [Odi.RunFloppyDiscTests, Msg.cmMsgKeys[runFloppy]];    CheckPresence [Odi.RunTapeDriveTests, Msg.cmMsgKeys[runTapeDrive]];    CheckPresence [OdiExtra.RunFloppyDiscUtilities, Msg.cmMsgKeys[runFloppyUtility]];    CheckPresence [Odi.RunFormatterScavengerBPU, Msg.cmMsgKeys[runFSBPU]];    CheckPresence [Odi.RunHardDiscTests, Msg.cmMsgKeys[runHardDisc]];    CheckPresence [Odi.RunKbdDsplMouseTests, Msg.cmMsgKeys[runKbdDsplMouse]];    CheckPresence [Odi.RunPrinterTests, Msg.cmMsgKeys[runPrinter]];    CheckPresence [Odi.RunRS232CTests, Msg.cmMsgKeys[runRS232]];    CheckPresence [OdiExtra.RunSecureDeviceTests, Msg.cmMsgKeys[runSecureDeviceTests]];    CheckPresence [Odi.RunSystemConfigurator, Msg.cmMsgKeys[sysConfigUtility]];    CheckPresence [OdiExtra.RunScannerTests, Msg.cmMsgKeys[runScannerTests]];    CheckPresence [OdiExtra.RunCartridgeTapeTests, Msg.cmMsgKeys[runCartridgeTapeTests]];        RETURN[clientCount#0];    END;END...  -- OfflineDiagnosticControlModuleBLOG.10-Feb-87 12:20:01 by KXW, Separated from OfflineDiagnosticControlModule.12-Mar-87 13:47:34 by JMA, Added RunScannerTest entries26-Oct-87 15:45:32 by JMA, Added RunCartridgeTapeTests entries