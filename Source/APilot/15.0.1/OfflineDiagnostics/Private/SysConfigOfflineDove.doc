-- File: SysConfigOfflineDove.doc-- Last edited on   9-Aug-85 11:15:34 by AMR-- Copyright (C) 1985 Xerox Corporation. All rights reserved.1 IntroductionThis document describes the Dove System Configuration Tool package, SysConfigOfflineDove.boot, version 12.0.  This package is not a diagnostic, and presumes a healthy machine. This tool is to be used to program i.e. write values into the EEProm for system configuration purposes.1.1 Related Document	1) OFLDiagKernelDove.doc - standard user interface for offline diagnostics2 GeneralThe SysConfigOfflineDove utility is provided as a boot file.  It can be booted from Ethernet or from floppy disks. 3 User Interface and Command DescriptionsThe initial screen displays a "old" example of the current system configuration; this has to be removed eventually. Currently a "CR" will take you to login.     For a description of the the login sequence, and for a description of the user interface basics, see document "1" referenced under Related Documents.After loging in successfully you are presented with a menu of 16 items.3.1 RAM bad page ConfiguratorChoosing this selection takes you to a sub-menu where choosing "Go to next selection" takes you to the main body of this option.        This option displays the bad memory pages, in decimal, in the EEProm; currently 26 words of the    EEProm.    1. You may enter a value of 1-26 to access any of the Bad Memory Page  locations.    2. The current contents of the EEProm location will be used as the default value to be placed       in the EEProm. Just a "CR" will retain this value or typing a new value in the range of       0-65535 decimal followed by a "CR" will place a new value in the EEProm.    3. After entring a new value or retaining the old value a prompt will appear to continue.       Entering a "Y" will allow you to enter another value, entering a "N" will take you to the       Previous menu i.e. The 16 top level menu choices.    4. New values must eventually be written to the EEProm with Menu selection "5". If this is not       done the "new" values are lost.           Note: Pressing the "Stop/red" key will exit the sub-menu immediately, BUT, any "new" values    that have been entered will be retained as part of the temporary EEProm image that still needs    to be written to the real EEProm to become permanent.3.2 Boot ConfiguratorChoosing this selection takes you to a sub-menu where the selections are for the Device that will determine the "Default boot device".        1. If you choose a boot device then,  that boot device will be displayed as the default boot       device and    2. the current settings for Icons at boot time and whether Rigid Disk, Floppy Disk,       Ethernet and RS232C booting are allowed or not allowed  will be displayed.    2. At this point you are prompted fot a "Y" or "N" response for each number (2) choice.    3. After entering a "Y" or "N" for each prompt the display will be updated showing the current       settings which are now part of the temporary EEProm image.        Note: Pressing the "Stop/red" key will exit the sub-menu immediately, BUT, any "new" values    that have been entered will be retained as part of the temporary EEProm image that still needs    to be written to the real EEProm to become permanent.  3.3 DTE and DCE ConfiguratorChoosing this selection takes you to a sub-menu where the selections are for DTE and DCE to be installed. This has only "logical" significence, as the ports are always physically part of the system i.e. will the software/system recognize their presense.        1. Upon selecting either DTE or DCE as installed or not installed your next choice is        2. DCE attributes followed by DTE attributes, the default selections are the current settings       in the EEProm, if the "Device" was set to NOT installed then the attribute settings are       meaningless.        Note: Pressing the "Stop/red" key will exit the sub-menu immediately, BUT, any "new" values    that have been entered will be retained as part of the temporary EEProm image that still needs    to be written to the real EEProm to become permanent.  3.4 Display ConfiguratorChoosing this selection takes you to a sub-menu where the selections are for Display (CRT) to be present or NOT present. If you choose NOT present then the temporary EEProm image will be set accordingly and the Display configurator will be exited. If you choose "Present" the temporary EEProm image will be set accordingly and you proceed to        1. Screen black&Wwite or Color, screen BitMapped or NOT bitmapped, screen size is small or       large, XAlignment and YAlignment.        2. The first 3 are "Y" or "N" choices.        3. The  XAlignment and YAlignment are numeric inputs defaulted to what is currently in the       EEProm in the range of 0-255. These values are used by the Daisy machine.        Note: Pressing the "Stop/red" key will exit the sub-menu immediately, BUT, any "new" values    that have been entered will be retained as part of the temporary EEProm image that still needs    to be written to the real EEProm to become permanent.    3.5 Configurator to WRITE the EEPromChoosing this selection takes you to a sub-menu where choosing "Go to next selection" takes you to the main body of this option.        1. A message is displayed at this point saying, "The temp EEProm image will be written to the REAL       EEProm. Okay[Y/N]?" A "N" will display a message "EEPromUpdate ABORTED" and will return you       to the sub-menu containing "Go to next selection" or "Return to the previous Menu". A "Y" takes       you to number 2.        2. A message is displayed at this point saying, "Booting will use new EEProm values. Do you still       wish to continue [Y/N]:" A "N" will display a message "EEPromUpdate ABORTED" and will return       you to the sub-menu containing "Go to next selection" or "Return to the previous Menu". A "Y"       takes you to number 3.        3. THE TEMPORARY EEPROM VALUES WILL BE WRITTEN TO THE EEPROM ITSELF. The next time the machine is       booted there will be new values in the EEProm.         Note: Pressing the "Stop/red" key will exit the entire Write EEProm Configurator without doing          anything to the EEProm.3.6 Configurator to READ the EEPromChoosing this selection takes you to a sub-menu where choosing "Go to next selection" takes you to the main body of this option.        1. If you choose "Go to next selection" and if there were NO temporary EEProm changes outstanding       the message "EEProm read success" will be displayed and you are left at the "Go to next       selection"  menu.        2. If you choose "Go to next selection" and if there ARE temporary EEProm changes outstanding       the message "The temporary EEProm changes will be erased. Do you still wish to continue?       [Y/N]:" will be displayed.  A "N" response will take you back to the "Top level menu", a "Y"       response will display the message, assuming the EEProm was read successfully, "EEProm Read       Success" and will leave you at the sub-menu. If the attempt to read the EEProm is in fact       UNSUCCESSFUL the message "EEProm Read FAILURE" will be displayed. This is very serious and       probably will necessitate a call to a service represenative.        Note: Pressing the "Stop/red" key will exit the entire Read EEProm Configurator without attempting          to read the  EEProm.3.7 Configurator to recalculate and display the EEProm checksum and inverted checksumChoosing this selection takes you to a sub-menu consisting of "Checksum Override False" or "ChecksumOverride True". Also entering this Configurator recalculates the checksum and inverted checksumimmediately upon entry based on the EEProm TEMPORARY image i.e. using ALL of the outstanding EEPromchanges entered as of this point in time.        1. If you choose "Checksum Override False" then a Boolean is set accordingly and the Checksum       and Inverted Checksum are displayed and you are placed at the sub-menu consisting of "Checksum       Override False" or "Checksum Override True". Leaving this Boolean set in this manner, which       is in fact the default setting, will allow the Write EEProm Configurator to recalculate the       Checksums whenever it is activated.        2. If you choose "Checksum Override True" then a Boolean is set accordingly and the Checksum       and Inverted Checksum are displayed and you are Prompted for Checksum values using the       "Current" values as the defaults. This allows one to enter checksum values that are ILLEGAL,       and will NOT allow the Write EEProm Configurator to recalculate the Checksums. This is        provided for testing purposes and should be used with CAUTION        Note: Pressing the "Stop/red" key will exit the entire Recalculate EEProm Configurator, but if    	  if the Boolean has been set, True or False, this condition will be retained. The setting	  of this Boolean can be changed at any time. 3.8 Floppy Disk ConfiguratorChoosing this selection takes you to a sub-menu consisting of None, SA455, SA465, new disk value,Return.        1. Choosing Return is obvious and you will be returned to the Top level menu..        2. None gives a setting of NO floppy disk, SA455 & SA465 are obvious and choosing new disk value       activates a prompt for a numeric value in the range of 0-15 defaulting to 15.         Current meaning to values:	   0 => NO floppy disk.	   1 => sa800.	   2 => anyFloppyDiskDrive; a Mesa type.	   3 => sa850.	   4 => sa455	   5  => sa465.	   6-15 => No meaning assigned.        3. After choosing a "type" of floppy disk  you are prompted for a "Y" or "N" response for each       of drives zero - three, Example: "Use selected Type for Drive XXXX (Y/N)?" Entering a "Y"       response will set that drive to that disk type, entering a "N" response will leave that       drive in it's current setting.        Note: Pressing the "Stop/red" key will exit the Floppy Disk Configurator immediately, however          all drive settings that were entered either "Y" or "N" will be retained. 3.9 Keyboard ConfiguratorChoosing this selection takes you to a sub-menu consisting of No Keyboard, English, European, Japanese,Lear-Siegle, New type, Return.        1. Choosing Return is obvious and you will be returned to the Top level menu..        2. No Keyboard gives a setting of NO Keyboard; English, European, Japanese, Lear-Siegle are        obvious and choosing "Enter New Type" activates a prompt for a numeric value in the range of       0-15 defaulting to the current keyboard setting.         Current meaning to values:	   0 => NO Keyboard.	   1 => English.	   2 => European.	   3 => Japanese.	   4 => Lear-Siegle	   5-15  => No meaning assigned.        Note: Pressing the "Stop/red" key will exit the Keyboard Configurator immediately, any change          entered will be retained.3.10 Main and Expansion Memory ConfiguratorChoosing this selection takes you to a sub-menu consisting of Low Memory, High Memory or Return.        1. Choosing Return is obvious and you will be returned to the Top level menu..        2. If you choose Low Memory/MPB then:       a. First you are prompted to continue (Y/N)? "N" returns to the sub-menu at number 1.       b. "Y" presents you with an array of 128K byte chunks of Low Memory/MPB and a prompt to          choose one of those chunks or return to the sub-menu at number 1.       c. If you choose a "chunk" of memory to deal with than you are presented with a prompt asking          if this particular memory chunk is to be mapped present or NOT present.       d. Upon typing "Y" or "N" you are continuely presented with the 16 memory chunk options          and a listing of both the Low Memory/MPB and High Memory/MEB current configurations.	  Also, there is an intervening prompt to "Continue? "Y" or "N"  between selecting each	  chunk and setting it present or NOT present. A "N" response will return you to the 	  sub-menu at number 1.    3. If you choose High Memory/MEB then:       a. First you are prompted to continue (Y/N)? "N" returns to the sub-menu at number 1.       b. "Y" presents you with an array of choices for the MEB/High Memory.       c. You may choose high memory in 256K bytes or No high memory.       d. Whatever you choose will be displayed in the current settings listing.          Also, after selecting a high memory setting you are presented with a prompt to "Continue?	  "Y" or "N", a "N" response will return you to the sub-menu at number 1 a "Y" will place	  you at number "3c" above.         Note: Pressing the "Stop/red" key will exit the Main and Expansion Memory Configurator    	  immediately, any change entered will be retained.3.11 Option Boards ConfiguratorChoosing this selection takes you to a sub-menu where choosing "Go to next selection" takes you to the main body of this option. Choosing Return is obvious and you will be returned to the Top level menu.        1. Upon entering the main body of this Configurator the curent settings of the option boards       are listed in the lower portion of the screen.       Note: all values are defaulted to the current settings.         2. You are now presented with the PC emulation option board prompt:       a. PC Option numeric prompt in the range of: 0-255. 0 = PC option NOT present.       b. PC Option Hardware1 numeric prompt in the range of: 0-255.       c. PC Option Hardware2 numeric prompt in the range of: 0-65535.        3. Option Board One numeric prompt in the range of: 0-65535.        4. Option Board Two numeric prompt in the range of: 0-65535.        5. Option Board Three numeric prompt in the range of: 0-65535.        Note: Pressing the "Stop/red" key will exit the Option Boards Configurator    	  immediately, any change entered will be retained.3.12 Rigid Disk ConfiguratorChoosing this selection takes you to a sub-menu consisting of several disk types, a new disk typeentry and a Return entry.        1. Choosing Return is obvious and you will be returned to the Top level menu..        2. Choosing any other entry will display the default entries for the disk type selected and       the current settings for the Rigid Disk.       a. If the "New Disk Type" was choosen there is an additional prompt for the "New Disk Type",          this is a numeric prompt in the range of 0-255. Defaulted to the current Type setting.       b. The ranges for the different values are as follows:          Sectors Per Track:  0-255.	  Heads Per Cylinder:  0-255.	  Cylinders Per Drive:  0-65535.	  Reduce Drive Current Cylinder:  0-65535.	  Precompensation Cylinder:  0-65535.        c. The default values for the different kinds of disk drives are "built in".          Note: The actual values for the Disk Drive Type currently assigned are 1-8, if you enter	        the "New Disk Type" mode you could enter one of these predefined numbers leading		to unpredictable results.            Note: Pressing the "Stop/red" key will exit the Rigid Disk Configurator immediately, any changes   	  entered will ONLY be retained if a complete set of changes from Type through Precompensation	  Cylinder have been entered otherwise the last complete set is retained.3.13 Virtual Memory and Control Store ConfiguratorChoosing this selection takes you to a sub-menu consisting of 3 choices plus a Return choice.        1. Choosing Return is obvious and you will be returned to the Top level menu..        2. Choosing Virtual Memory or Control Store will display the current settings for these two       entries plus the current setting for the Hardware Version and will go to either (a) or (b).              a. The Virtual Memory prompt is a numeric prompt in the range of 0-15, defaulted to the          current setting.       b. The Control Store prompt is a numeric prompt in the range of 0-15, defaulted to the          current setting.    3. Choosing Hardware Version will display the Hardware Version prompts including a "New       Hardware Version" prompt which is a numeric prompt in the range of 0-255. Initially       1 = B0 or B1, 2 = B2.            Note: Pressing the "Stop/red" key will exit the Virtual Memory and Control Store Configurator	  immediately, any changes entered will be retained.   3.14 Total EEProm ConfiguratorChoosing this selection takes you to a sub-menu consisting of "Go To The Next Selection",which takes you to the main body of the option, "Return", goes to the Top level menu.        1. Entering this Configurator displays the entire contents of the EEProm in hexidecimal from       word 1 through word 64.        2. The prompts are for, first, word location in the range 1-64 decimal.        3. Upon entering a legal "index" in the range 1-64 decimal you are prompted for the numeric       value to place in the EEProm at that location. This value is defaulted to the current       contents of that location and is displayed in hexidecimal and must be entered as a hexidecimal       number in the range 0-FFFFH.            Note: Pressing the "Stop/red" key will exit the Virtual Memory and Control Store Configurator	  immediately, any changes entered will be retained.3.15 Show EEProm Contents ONLY ConfiguratorChoosing this selection takes you to a sub-menu consisting of "Go To The Next Selection",which takes you to the main body of the option, "Return", goes to the Top level menu.        1. This "Configurator" displays the contents of the entire EEProm as numeric values,       either decimal or hexidecimal depending on what is appropriate, or translated into enumerated       types as appropriate.         Note: Pressing the "Stop/red" key will exit the Show EEProm Contents ONLY Configurator	  immediately.Appendix A.The EEPromDefs.mesa file is a good place to look for a detailed description of the EEProm.Also the following is a file that was first created by Chuck Fay and Later Updated by Pierre Elie and myself (Allen Roberts) it is included for the additional information it contains.NOTE: In the following message the numbering of the EEProm begins with word ZERO in the previous part of this document it begins with word ONE.This is a revised version of Chuck Fay's June 27th release of EEPROMContents.txtRevised version of July 321,1985 by: Pierre Elie, Jr.VERSION NUMBERSThree version numbers in the EEPROM are the first three contiguous words, one for each of the three sections of the EEPROM.  They should be incremented every time an incompatible change is made to the contents of the corresponding section of the EEPROM. The version numbers should be checked during booting by the EPROM-resident software and by RAM-resident code (probably the initial IOP code).  If the software is incompatible with the version number, the contents of the EEPROM should be treated the same way they would be if the checksum were invalid.  The current plan is for Opie to set the carry flag in the ReadEEPROM macro to indicate whether the EEPROM contents returned should be trusted.INITIAL CONTENTSThe following EEPROM contents and layout incorporates the partitioning and version numbers with the current contents of the EEPROMs as defined in EEPDefs.asm.  This layout should require minimal conversion of Opie and handlers.  The three parts of the EEPROM Configuration are specified below in contiguous pieces, but that is not a requirement. A). Configuration information for EPROM-resident softwareWord	Byte	Contents0	0+1	Version number for the definition of the EPROM-relative section1	0+1	Version number for the definition of the RAM-relative section2	0+1	Version number for the definition of this section3	0+1	Booting parameters		  Default boot device type (4 bits)		  Default boot type bit1 (normal [icons] or fast [no icons])		  Rigid disk booting allowed bit (no or yes)		  Floppy booting allowed bit (no or yes)		  Ethernet booting allowed bit (no or yes)		  RS-232-C booting allowed bit (no or yes)		  Spare bits (7 bits)4	0	Display type		  bit0: 0=no display present, 1=display present		  bit1: 0=black and white display, 1= color display		  bit2: spare		  bit3: spare		  bit4: spare		  bit5: spare		  bit6: spare		  bit7: 0=bitmap display type, 1=non-bitmap display type4	1	Daisy display X alignment5	0	Daisy display Y alignment5	1	Keyboard type		  Physical type (0=none, 1=english, 2=european		  		 3=japanese, 4=learSiegler)6:0 - 11:0	Rigid disk parameters6	0	  sectors per track6	1	  heads per cylinder7	0+1	  cylinder count8	0+1	  RWC (Reduced Write Cylinder)9	0+1	  PCC (Pre-Compensation Cylinder)10	0	  type10	1	Spare	---------------------------------------------------------------------B). Configuration information for local RAM/system memory-resident softwareWord	Byte	Contents11:0 - 12:0	System memory size11	0+1	  low mem12	0	  high mem12	1	VM and control store sizes (4 bits each)		  bits0-3: up to 16 different encoded VM sizes		    Possible encoding:  n*64 VM map pages		    0 => none		    1 => 64 VM map pages		    2 => 128 VM map pages		    3 => 256 VM map pages		  bits4-7: up to 16 different encoded control store sizes		    Possible encoding:  n*4K control store		    0 => none		    1 => 4K control store		    2 => 8K control store13	0	Hardware version (B0, B1, B2, ...)		  0: none		  1: B0/B1		  2: B2		  3-255: spare encodings13	1	Miscellaneous bits		  Default boot type bit2 (with or without diagnostics)		  Default diagnostic boot type bit (short or long)		  Spare bits (6 bits)14:0 - 15:1	RS-232-C information (is this necessary?  not clear to me)14	0	  DCE port device type14	1	  DCE port attributes15	0	  DTE port device type15	1	  DTE port attributes16:0 - 17:1	PC emulation information		  Default memory size (1 byte?) 0 => PCE option not installed		  Default emulated hardware configuration (3 bytes?)18:0 - 20:1	Other options (max of three options plus PCE on Daisy)18	0+1	  Option 1 type and attributes, 0 => no option installed19	0+1	  Option 2 type and attributes, 0 => no option installed20	0+1	  Option 3 type and attributes, 0 => no option installed21	0+1	Floppy type and attributes22:0 - 33:1	Spare words (12 words) for expansion of either the ROM- or		  RAM-relative section	---------------------------------------------------------------------C). System memory bad page list section34:0 - 35:1	Real memory address of last reported memory parity error36:0 - 61:1	System memory bad page list (26 words)		  26 entries @ 1 word each		    OR		  13 entries @ 2 words each	62	0+1	Checksum63	0+1	Checksum 1's complement	---------------------------------------------------------------------