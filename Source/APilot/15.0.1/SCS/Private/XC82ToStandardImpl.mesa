-- XC82ToStandardImpl.mesa-- Last edited by Alfvin 29-Jun-84 18:45:13DIRECTORY  JapaneseKanji,  NSString,  NSStringConvert,  NSStringConvertInternal;XC82ToStandardImpl: PROGRAM  IMPORTS NSStringConvert  EXPORTS NSStringConvertInternal =  BEGIN OPEN NSStringConvertInternal, JapaneseKanji;  ConvertXC82ToStandard: PUBLIC PROC [c: NSString.Character]    RETURNS [newChar: NSString.Character] =    BEGIN    SELECT c.chset FROM      0 =>        newChar _	  SELECT c.code FROM	    IN [41B..175B] => c,	    176B => [356B, 176B],	    211B => c,	    215B => c,	    IN [241B..376B] => c,	    ENDCASE => unknownChar;      41B =>        newChar _	  SELECT c.code FROM	    IN[41B..43B] => c,	    IN[53B..54B] => c,	    IN[63B..74B] => c,	    76B => c,	    102B => c,	    IN[104B..105B] => c,	    IN[114B..115B] => c,	    IN[126B..133B] => c,	    142B => c,	    IN[145B..152B] => c,	    IN[154B..156B] => c,	    IN[171B..176B] => c,	    ENDCASE => unknownChar;      42B =>        newChar _	  SELECT c.code FROM	    IN[41B..51B] => c,	    56B => c,	    ENDCASE => unknownChar;      43B =>        newChar _	  SELECT c.code FROM	    254B => c,	    256B => c,	    IN[260B..263B] => c,	    IN[274B..276B] => c,	    300B => c,	    311B => c,	    IN[313B..314B] => c,	    316B => c,	    IN[321B..322B] => c,	    IN[324B..327B] => c,	    IN[331B..313B] => c,	    IN[335B..337B] => c,	    ENDCASE => unknownChar;      44B =>        newChar _	  SELECT c.code FROM	    IN[41B..176B] => c,	    IN[241B..376B] => c, -- Bopomofo	    ENDCASE => unknownChar;      45B =>        newChar _	  SELECT c.code FROM	    IN[41B..166B] => c,	    ENDCASE => unknownChar;      46B =>        newChar _	  SELECT c.code FROM	    IN [41B..42B] => [46B, 40B + c.code],	    IN [43B..45B] => [46B, 41B + c.code],	    IN [46B..60B] => [46B, 43B + c.code],	    IN [61B..62B] => [46B, 44B + c.code],	    IN [63B..70B] => [46B, 45B + c.code],	    IN [101B..102B] => [46B, 40B + c.code],	    IN [103B..105B] => [46B, 41B + c.code],	    IN [106B..120B] => [46B, 43B + c.code],	    IN [121B..122B] => [46B, 44B + c.code],	    IN [123B..130B] => [46B, 45B + c.code],	    140B => [46B, 46B],	    141B => [46B, 45B],	    142B => [46B, 47B],	    ENDCASE => unknownChar;      47B =>        newChar _	  SELECT c.code FROM	    IN [41B..101B] => c,	    IN [121B..161B] => c,	    ENDCASE => unknownChar;      50B =>        newChar _	  SELECT c.code FROM	    IN [43B..52B] => c,	    ENDCASE => unknownChar;      IN StandardJIS1Chset => newChar _ c;      IN StandardJIS2Chset => newChar _ c;      164B =>        newChar _          SELECT c.code FROM	    IN [41B..57B] => c,	    ENDCASE => unknownChar;      IN ChineseKanjiChset => newChar _ c;      356B =>         newChar _          SELECT c.code FROM	    IN [41B..44B] => c,	    <<	    57B => c,	    175B => c,	    177B => c,	    >>  -- the above look like typos, fixed below by JDB	    56B => c,	    174B => c,	    176B => c,	    ENDCASE => unknownChar;      357B =>        newChar _          SELECT c.code FROM	    IN [41B..176B] => c,	    IN [241B..376B] => c,	    ENDCASE => unknownChar;      360B =>        newChar _	  SELECT c.code FROM	    IN [41B..46B] => c,	    176B => [46B, 167B],	    IN [270B..275B] => c,	    IN [302B..304B] => c,	    IN [312B..314B] => c,	    316B => c,	    331B => c,	    335B => c,	    IN [341B..351B] => c,	    IN [354B..357B] => c,	    IN [366B..375B] => c,	    ENDCASE => unknownChar;      361B =>         newChar _	  SELECT c.code FROM	    IN [41B..44B] => c,	    IN [50B..51B] => [361B, c.code - 1],	    IN [61B..64B] => [361B, c.code + 160B],	    IN [70B..71B] => [361B, c.code + 160B - 1],	    IN [101B..103B] => [361B, c.code - 21B],	    110B => [361B, 65B],	    IN [121B..123B] => [361B, c.code + 160B - 21B],	    130B => [361B, 265B],	    IN [141B..143B] => [361B, c.code - 43B],	    150B => [361B, 104B],	    IN [161B..163B] => [361B, c.code + 160B - 43B],	    170B => [361B, 304B],	    IN [241B..244B] => [361B, c.code - 122B],	    250B => [361B, 124B],	    IN [261B..264B] => [361B, c.code + 160B - 122B],	    270B => [361B, 324B],	    IN [301B..303B] => [361B, c.code - 142B],	    310B => [361B, 145B],	    IN [321B..323B] => [361B, c.code + 160B - 142B],	    330B => [361B, 345B],	    ENDCASE => unknownChar;      362B =>         newChar _	  SELECT c.code FROM	    112B => [361B, 55B],	    132B => [361B, 255B],	    ENDCASE => unknownChar;      363B =>         newChar _	  SELECT c.code FROM	    304B => [361B, 114B],	    324B => [361B, 314B],	    ENDCASE => unknownChar;      364B =>         newChar _ unknownChar;      365B =>         newChar _ unknownChar;      375B =>         newChar _	  SELECT c.code FROM            IN [320B..323B] => c,	    ENDCASE => unknownChar;      ENDCASE => newChar _ unknownChar;    IF newChar = unknownChar THEN newChar _ NSStringConvert.Error[unknownChar, c];    END;  END.29-Jun-84 18:45:46 - Alfvin - Map [0, 211B], [0, 215B] straight across.