-- StandardToXC82Impl.mesa-- Last edited by JDB 17-Apr-84 12:34:39DIRECTORY  JapaneseKanji,  NSString,  NSStringConvert,  NSStringConvertInternal;StandardToXC82Impl: PROGRAM  IMPORTS NSStringConvert  EXPORTS NSStringConvertInternal =  BEGIN OPEN NSStringConvertInternal, JapaneseKanji;  ConvertStandardToXC82: PUBLIC PROC [c: NSString.Character]    RETURNS [newChar: NSString.Character] =    BEGIN    SELECT c.chset FROM      0 =>        newChar _	  SELECT c.code FROM	    IN [40B..176B] => c,	    IN [241B..245B] => c,	    247B => c,	    IN [251B..277B] => c,	    IN [301B..310B] => c,	    IN [312B..325B] => c,	    IN [334B..344B] => c,	    IN [346B..376B] => c,	  ENDCASE => unknownChar;      41B =>        newChar _	  SELECT c.code FROM	    IN [42B..43B] => c,	    IN [53B..54B] => c,	    IN [63B..74B] => c,	    76B => c,	    102B => c,	    IN [104B..105B] => c,	    IN [114B..115B] => c,	    IN [126B..133B] => c,	    142B => c,	    IN [145B..156B] => c,	    IN [171B..176B] => c,	  ENDCASE => unknownChar;      42B =>        newChar _	  SELECT c.code FROM	    IN[41B..51B] => c,	    56B => c,	    ENDCASE => unknownChar;      43B =>        newChar _	  SELECT c.code FROM	    254B => c,	    256B => c,	    IN[260B..263B] => c,	    IN[274B..276B] => c,	    300B => c,	    311B => c,	    IN[313B..314B] => c,	    316B => c,	    IN[321B..322B] => c,	    IN[324B..327B] => c,	    IN[331B..313B] => c,	    IN[335B..337B] => c,	    ENDCASE => unknownChar;      44B =>        newChar _	  SELECT c.code FROM	    IN[41B..163B] => c,	    IN [241B..376B] => c, -- Bopomofo	    ENDCASE => unknownChar;      45B =>        newChar _	  SELECT c.code FROM	    IN[41B..166B] => c,	    ENDCASE => unknownChar;      46B =>        newChar _	  SELECT c.code FROM	    45B => [46B, 141B],	    46B => [46B, 140B],	    47B => [46B, 142B],	    -- IN [64B..65B] => ,	    -- 73B => ,	    IN [101B..102B] => [46B, 41B + c.code - 101B],	    IN [104B..106B] => [46B, 43B + c.code - 104B],	    -- 107B, 110B => ,	    IN [111B..123B] => [46B, 46B + c.code - 111B],	    -- 124B => ,	    IN [125B..126B] => [46B, 61B + c.code - 125B],	    IN [130B..135B] => [46B, 63B + c.code - 130B],	    -- 136B => ,	    IN [141B..146B] => [46B, 101B + c.code - 141B],	    -- 147B, 150B => ,	    IN [151B..163B] => [46B, 106B + c.code - 151B],	    -- 164B => ,	    IN [165B..166B] => [46B, 121B + c.code - 165B],	    167B => [360B, 176B],	    IN [170B..175B] => [46B, 123B + c.code - 170B],	    -- 176B => ,	    ENDCASE => unknownChar;      47B =>        newChar _	  SELECT c.code FROM	    IN [41B..101B] => c,	    IN [121B..161B] => c,	    ENDCASE => unknownChar;      50B =>        newChar _	  SELECT c.code FROM	    IN [43B..52B] => c,	    ENDCASE => unknownChar;      IN StandardJIS1Chset => newChar _ c;      IN StandardJIS2Chset => newChar _ c;      164B =>        newChar _          SELECT c.code FROM	    IN [41B..57B] => c,	    ENDCASE => unknownChar;      IN ChineseKanjiChset => newChar _ c;      356B =>         newChar _          SELECT c.code FROM	    IN [41B..44B] => c,	    57B => c,	    175B => c,	    176B => [0, 176B],	    177B => c,	    ENDCASE => unknownChar;      357B =>        newChar _          SELECT c.code FROM	    IN [41B..176B] => c,	    IN [241B..244B] => c,	    IN [247B..376B] => c,	    ENDCASE => unknownChar;      360B =>        newChar _	  SELECT c.code FROM	    IN [41B..45B] => c,	    IN [271B..272B] => c,	    275B => c,	    IN [302B..304B] => c,	    312B => c,	    331B => c,	    335B => c,	    IN [341B..351B] => c,	    IN [354B..357B] => c,	    IN [366B..375B] => c,	    ENDCASE => unknownChar;      361B =>         newChar _	  SELECT c.code FROM	    IN [41B..44B] => c,	    IN [47B..50B] => [361B, c.code + 1],	    55B => [362B, 112B],	    IN [60B..62B] => [361B, c.code + 21B],	    65B => [361B, 110B],	    IN [76B..100B] => [361B, c.code + 43B],	    104B => [361B, 150B],	    114B => [363B, 304B],	    IN [117B..122B] => [361B, c.code + 122B],	    124B => [361B, 250B],	    IN [137B..141B] => [361B, c.code + 142B],	    145B => [361B, 310B],	    IN [247B..250B] => [361B, c.code - 160B + 1],	    255B => [362B, 132B],	    IN [260B..262B] => [361B, c.code - 160B + 21B],	    265B => [361B, 130B],	    IN [276B..300B] => [361B, c.code - 160B + 43B],	    304B => [361B, 170B],	    314B => [363B, 324B],	    IN [317B..322B] => [361B, c.code - 160B + 122B],	    324B => [361B, 270B],	    IN [337B..341B] => [361B, c.code - 160B + 142B],	    345B => [361B, 330B],	    ENDCASE => unknownChar;      IN [362B..365B] => newChar _ unknownChar;      375B =>         newChar _	  SELECT c.code FROM            IN [320B..323B] => c,	    ENDCASE => unknownChar;      ENDCASE => newChar _ unknownChar;    IF newChar = unknownChar THEN newChar _ NSStringConvert.Error[unknownChar, c];    END;END.