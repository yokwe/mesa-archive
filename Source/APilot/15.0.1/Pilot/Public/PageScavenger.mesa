-- Copyright (C) 1982, 1986  by Xerox Corporation. All rights reserved.-- PageScavenger.mesa    19-Nov-86 16:34:23 by RSVPageScavenger: DEFINITIONS =  BEGIN  Error: ERROR [errorType: ErrorType];    ErrorType: TYPE = {     driveNotAvailable, driveNotReady, invalidPageNumber,     unknownDrive};    Action: TYPE = {    fixDataCRCError, fixHardware, fixLabelCRCErrorFirst, fixPVRootPageFirst,    boot, lvScavenge, pvScavenge};  PageNumber: TYPE = LONG CARDINAL;    DeviceIndex: TYPE = CARDINAL;    DiskStatus: TYPE = {    goodCompletion, noSuchPage, seekFailed, checkError, dataError,    hardwareError, notReady};      Scavenge: PROCEDURE [    device: DeviceIndex, diskPage: PageNumber, overwrite: BOOLEAN]    RETURNS [      action: Action, contentsReliable: BOOLEAN, diskStatus: DiskStatus];    -- Page diskPage of the Pilot disk on drive device (e.g., 0 for RD0) is  -- presumed to have caused an unrecoverable disk error while running Pilot.  -- This procedure will attempt to make that page readable again.  -- overwrite determines whether or not this procedure is permitted to destroy  --   the old data in the page if that is necessary.  For certain Pilot pages,  --   this argument is ignored.  -- action indicates the action that the client is expected to now perform so as  --   to resume operation.  --    fixDataCRCError => implies that the Scavenge is unable to proceed without  --       the ability to overwrite the client's data.  Based upon the value of  --       contentsReliable the client may be able to decide if overwriting is  --       okay.  --    fixLabelCRCErrorFirst => this error should only be gotten on labelled  --       hardware.  Implies that the the Scavenge is unable to proceed without  --       the ability to overwrite the client's data or that the label should  --       be fixed first by some other utility.  --    fixHardware => the specified page may have a header CRC error (try  --       Diagnostics).  Another possibility is that the hardware is broken.  --    boot => reboot the volume containing the offending page and all will be  --       well.  --    lvScavenge => run the logical volume scavenger on the volume containing  --       the specified page.  --    pvScavenge => run the physical volume scavenger on the physical volume  --       containing the specified page.  If it reports no problems then run the  --       logical volume scavenger on the volume containing the specified page.  --    fixPVRootPageFirst => implies that the PV root page was unreadable, thus  --       it should be fixed first before proceeding  -- contentsReliable is returned as TRUE if and only if the data was read without  --   great difficulty.  If it is returned as FALSE, the page's contents should  --   be regarded with suspicion.  -- diskStatus is the status returned to Scavenge by Pilot's disk machinery.  It  --    provides diagnostic information to track the cause of unrecoverable disk  --    errors.  Its fields have the following meanings (note that some are  --    "funny" due to limitations in the current Pilot implementation.  --    goodCompletion => Pilot had no problems reading the page.  --    noSuchPage => the specified page should be on the disk but the hardware  --      does not believe so.  --    seekFailed => the hardware was unable to seek to the cylinder containing  --      the specified page.  --    checkError => the ahrdware thought we were trying to verify the contents  --      of the data and that failed.  --    dataError => CRC error on the data portion of the disk page.  --    hardwareError => covers a multitide of sins including header CRC errors,  --      label CRC errors (only on old labelled hardware), recalibration error,  --      header not found, over runs, memory errors, write faults, memory  --      faults and resetting of the controller. file, filePage and type  --      describe the effected file page.  --    notReady => the drive is not ready.  END.LOGTime: 10-Feb-82 16:34:50                By: AWL         Created fileTime: 29-Sep-86 12:21:00                By: RSV   Changed to reflect label-less worldTime: 13-Nov-86 12:10:38                By: RSV   Added Action type fixLabelCRCError back (for old hardware only)Time: 19-Nov-86 16:34:23                By: RSV   Changed order of Action type.