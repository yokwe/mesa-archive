-- Copyright (C) 1983, 1986, 1987  by Xerox Corporation. All rights reserved. -- FileBasicsPerf.mesa    8-Feb-87 15:14:37 by RSV     -- This Friends interface provides access to the metering data within the File Basics-- configuration of Pilot Kernel. Each module which exports some kind of meter has its-- own section in this interface. Within each such section the items are-- presented data first, followed by any procedures.DIRECTORY  System USING [Pulses],  Volume USING [ID];FileBasicsPerf: DEFINITIONS =  BEGIN    --======== Items from ETableImpl modules:    totalAcquireBuckets: READONLY LONG CARDINAL;  -- total number of lvBucketInfo acquires    acquireBucketWaits: READONLY LONG CARDINAL;  -- total number of times lvBucketInfo acquire requests had to wait.  --======== Items from DataTransferImpl:  logging: READONLY BOOLEAN;  -- indicates validity of hist below.  HistIndex: TYPE = [0..16];  hist: READONLY ARRAY HistIndex OF LONG CARDINAL;  -- hist[j] counts requests of size [2­(j-1)..(2­j)-1]  -- hist is valid data only if logging = TRUE.  --======== Items from SimpleFileImpl:  setSizeRequests: READONLY LONG CARDINAL;  -- Counts number of requests to change the size of a file.  --======== Items from VolAllocMapImpl:  totalAllocs: READONLY LONG CARDINAL;  -- total number of allocate requests.  totalFrees: READONLY LONG CARDINAL;  -- total number of free requests.  expands: READONLY LONG CARDINAL;  -- The number of allocate requests in which the new pages provided  -- were contiguous to the last page group in the file. Note that File  -- Creates never look like expansions. To get a true percentage  -- of contiguous expansions use:  --   % = expands/(totalAllocs - number of File.Creates)   --======== Items from VolBackingStoreImpl:  transfers: READONLY CARDINAL;  -- Total number of transfer requests.  --======== Items from VolTableImpl:  locks: READONLY CARDINAL;  -- total number of locks aquired so far, excluding table locks.  lvLockWaits: READONLY CARDINAL;  -- number of times someone wanted to lock an LV and it was already locked.  pvLockWaits: READONLY CARDINAL;  -- number of times someone wanted to lock an PV and it was already locked.  svLockWaits: READONLY CARDINAL;  -- number of times someone wanted to lock an SV and it was already locked.  timeInClientProc: READONLY System.Pulses;  -- total time spent in client procs during an Access.  -- Disk Consistency Management:  -- Normally when Pilot makes modifications to disk data which are  -- required to be mutually consistent, the modifications are done  -- under to protection of a transaction mechanism; all such data  -- is forced to disk before the operation completes. This is done  -- so as to reduce the window in which a crash will force  -- a subsequent scavenge.  -- The procedures below allow a client to enlarge this window,  -- perhaps to bracket a series of file operations.  -- This allows higher performance; the price paid is the increased  -- probability that a boot after a crash will cause a scavenge.  -- The four procedures below may raise Volume.Unknown.  BeginOperationSequence: PROCEDURE [volume: Volume.ID];  -- Declares the beginning of a series of file operations on volume.  -- The client does not require the disk to be self-consistent  -- until a matching call to EnableForceOuts is done.  -- Calls to this procedure may nest.  EndOperationSequence: PROCEDURE [volume: Volume.ID];  -- Declares the end of a series of file operations on volume.  -- If there are no remaining operation sequences in progress,  -- the disk is made self-consistent before returning.   -- Excess calls to this proc are ignored.    ForceConsistency: PROCEDURE [volume: Volume.ID];  -- Regardless of the number of operation sequences currently  -- in progress, make the disk self-consistent.  GetOperationSequenceCount: PROCEDURE [    volume: Volume.ID] RETURNS [count: CARDINAL];  -- Returns the number of operation sequences currently in progress.  END.   LOG9-Nov-82 20:07:07	JXP   	Created File.	   16-Nov-82 15:11:34	JXP      Moved Augment and Shrink Pool from VolFileMap. Made names more mnemonic.12-Dec-82 14:05:21	JXP      Add HistIndex TYPE. Added GetChangingCount[], SetChangingCount[],   MakeConsistent[], and GetCountChangesSoFar[].13-Jan-83 11:25:47	JXP      Change VolTable ForceOut procedures to use a stacking mechanism like   interrupts.22-Feb-83 13:18:50	WDK        Redid disk consistency facilities.16-May-86 11:30:31      RSV        Deleted things from VolFileMapImpl section. 6-Feb-87 16:36:07      RSV        Added totalAcquireBuckets and acquireBucketWaits. 8-Feb-87 15:14:46      RSV        Cleaned up.