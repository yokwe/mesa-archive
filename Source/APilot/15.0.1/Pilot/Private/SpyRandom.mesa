-- Copyright (C) 1981  by Xerox Corporation. All rights reserved. -- SpyRandom.mesa--  edited by:  BXM    February 12, 1981  9:00 PM--  Last edited by MXB    on 17-Aug-81 17:02:02--  last edited by RXL   on 24-Aug-81  9:17:01DIRECTORY  SpyClient USING [];  SpyRandom: PROGRAM  EXPORTS SpyClient =  BEGIN  Degree: CARDINAL = 33;  MidPower: CARDINAL = 13;  randomTable: ARRAY [0..Degree) OF CARDINAL;  randomIndex: CARDINAL;  randomTrailer: CARDINAL;    InitRandom: PUBLIC PROC [seed: CARDINAL] =    BEGIN    randomTable ¬ [        56572B, 112312B, 4714B, 100763B, 62510B, 1572B, 12255B, 132113B,	166574B, 2440B, 104704B, 105254B, 106030B, 7053B, 56322B, 41163B,	11105B, 136203B, 55327B, 125100B, 76206B, 167173B, 173672B, 33211B,	134253B, 153317B, 25327B, 136567B, 171517B, 23161B, 44276B, 72324B,	143455B];    randomTable[0] ¬ 2*seed + 1;    FOR i: CARDINAL IN [1..MIN[16, Degree - 1]] DO      randomTable[i] ¬ IF LOOPHOLE[seed, INTEGER] < 0 THEN 1 ELSE 0;      seed ¬ 2*seed;      ENDLOOP;    randomIndex ¬ 0;    randomTrailer ¬ Degree - MidPower;    THROUGH [1..2000] DO [] ¬ Random[] ENDLOOP;    RETURN;    END;  Random: PUBLIC PROC RETURNS [result: CARDINAL] =    BEGIN    result ¬ randomTable[randomIndex] + randomTable[randomTrailer];    randomTable[randomIndex] ¬ result;    SELECT randomIndex + 1 FROM      < Degree => {	randomIndex ¬ randomIndex + 1;	randomTrailer ¬	  IF randomTrailer < Degree - 1 THEN randomTrailer + 1 ELSE 0};      = Degree => {randomIndex ¬ 0; randomTrailer ¬ Degree - MidPower};      ENDCASE => ERROR;    END;      RandomDelay: PUBLIC PROC = {    delay: CARDINAL = Random[] MOD 200;    a: CARDINAL;    FOR i: CARDINAL IN [0..delay) DO a ¬ a + 1 ENDLOOP};      -- mainline  InitRandom[123123B];  END..