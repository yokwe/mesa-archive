-- Copyright (C) 1986, 1987, 1988, 1989  by Xerox Corporation and Fuji Xerox Co., Ltd. All rights reserved. -- SpaceInternal.mesa          16-May-89 10:57:12 by TxH     DIRECTORY  File USING [File],  KernelFile USING [Cache],  Space USING [Access, Interval, Window],  VM USING [BackingStoreRuns, PageCount];SpaceInternal: DEFINITIONS =  BEGIN    AllocationSource: TYPE = {frame, createdSpace};    Runs: TYPE = RECORD [    runs: VM.BackingStoreRuns,    storage: SELECT allocated: AllocationSource FROM      frame => [], createdSpace => [interval: Space.Interval] ENDCASE];        defaultRunSize: CARDINAL = 5;  -- size of run array allocated from local frames.  If this is too small,  -- the emergency storage allocator will be used.  incrementOnPilot: CARDINAL = 6;    -- must be evenly divisible into SpaceInternal.fileLockSpace.count    -- (which is currently 366)  hasSystemVolume: READONLY BOOLEAN;        maxNumberNodes: CARDINAL = 9362;    -- (SIZE[RunTable]*Environment.wordsPerPage)/SIZE[BackingStore.Data]  lastLockPageMapped: CARDINAL;  fileLockSpace: READONLY Space.Interval;  lockAllocationPoolSpace: READONLY Space.Interval;  fileLockFile: READONLY File.File;    lowerBound: LONG POINTER;    cache: KernelFile.Cache;    invalidSizeNode: ERROR;    AllocateStorage: PROCEDURE RETURNS [node: LONG POINTER];    DeallocateStorage: PROCEDURE [node: LONG POINTER, length: CARDINAL]    RETURNS [LONG POINTER];      BiggerRuns: PROCEDURE [runs: Runs] RETURNS [newRuns: Runs];      FinishWithRuns: PROCEDURE [runs: Runs];  GetRuns: PROCEDURE [initialRuns: Runs, window: Space.Window, usedVMBF: BOOLEAN]    RETURNS [newRuns: Runs];    InsertLockIntoRuns: PROCEDURE [runs: VM.BackingStoreRuns, mappedCount: VM.PageCount, window: Space.Window, access: Space.Access];      END.  --LOG  12-Nov-86 16:51:14   RSV     	Created file.14-Jan-87 22:14:11   ET		Moved cache and BiggerRuns from SpaceImplA to here.17-Dec-87 20:07:02   RSV        Added lowerBound. 6-Jan-88 18:54:35   RSV        Moved incrementOnPilot here from SpaceImplB.26-Jan-88 22:08:28   RSV        incrementOnPilot now 6 (was 10) since AR 12673 was fixed (which changed SpaceInternal.fileLockSpace.count from 110 to 366).30-Mar-89 13:45:19   TXT        Add InsertLockIntoRuns due to StorageOverflow on compiling spaceImplA11-Apr-89 11:28:53   TxH        Added mapUnitIndex. (SS-FX: AR#6, AR#26)16-May-89 10:57:10   TxH        undo my previous change. 