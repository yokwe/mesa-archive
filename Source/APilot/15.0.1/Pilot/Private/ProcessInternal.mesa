-- Copyright (C) 1983  by Xerox Corporation. All rights reserved. -- PilotKernel>ProcessInternal.mesa       7-Jul-83 14:14:36 by JXP   DIRECTORY  ESCAlpha USING [aSPP],  Mopcodes USING [zESC],  Process USING [Priority],  ProcessOperations USING [HandleToIndex, IndexToHandle, ReadPSB, Requeue],  PSB USING [PDA, PsbHandle, PsbIndex];ProcessInternal: DEFINITIONS IMPORTS ProcessOperations, PSB =  BEGIN OPEN ProcessOperations;  -- Process operations for Pilot Kernel:  GetCurrent: PROCEDURE RETURNS [process: PROCESS] = INLINE {    RETURN[LOOPHOLE[HandleToIndex[ReadPSB[]], PROCESS]]};  GetPriority: PROCEDURE[] RETURNS [priority: Process.Priority] = INLINE {    RETURN[PSB.PDA[ReadPSB[]].link.priority]};  SetPriority: PROCEDURE [priority: Process.Priority] = MACHINE CODE {    Mopcodes.zESC, ESCAlpha.aSPP};  Yield: PROCEDURE[] = INLINE {    Requeue[@PSB.PDA.ready, @PSB.PDA.ready, ReadPSB[]]};  -- The following are here TEMPORARILY until AR 12259 is fixed:  IndexFromProcess: PROCEDURE [process: PROCESS] RETURNS [PSB.PsbIndex] = INLINE {    RETURN[LOOPHOLE[process]]};  ProcessFromIndex: PROCEDURE [index: PSB.PsbIndex] RETURNS [PROCESS] = INLINE {    RETURN[LOOPHOLE[index]]};  HandleFromProcess: PROCEDURE [process: PROCESS] RETURNS [PSB.PsbHandle] = INLINE    {RETURN[ProcessOperations.IndexToHandle[IndexFromProcess[process]]]};  ProcessFromHandle: PROCEDURE [handle: PSB.PsbHandle] RETURNS [PROCESS] = INLINE    {RETURN[ProcessFromIndex[ProcessOperations.HandleToIndex[handle]]]};  END.            LOG      May 16, 1980  1:56 PM   McJones   Added default for priority to AllocateNakedNotifyLevelJune 2, 1980  5:50 PM   McJones   Added DeallocateNakedNotifyLevel.July 19, 1980  2:55 PM   Forrest   Added Allocate/DeallocateNakedCondition.September 2, 1980  3:07 PM   McJones   Deleted old-style naked notify items. 8-Aug-81 12:35:02   Knutsen   Added GetPriority, SetPriority; SetPriority no longer does {DisableInterrupts;EnableInterrupts}.21-Oct-81 16:23:56   WDK       Get DisableInterrupts from ProcessOperations,9-Dec-81 17:09:19   WDK       Deleted DisableInterrupts, EnableInterrupts.2-Mar-82 14:03:23   CAJ    Use new instruction for SetPriority.23-Aug-82  9:27:49   WDK       Added GetCurrent, GetPriority, Yield, and IndexFromProcess and friends.23-Aug-82  9:27:49   JXP       ESCAlpha.a17 => aSPP.