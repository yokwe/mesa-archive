-- Copyright (C) 1982, 1983, 1984, 1986, 1987, 1989  by Xerox Corporation and Fuji Xerox Co., Ltd. All rights reserved. -- 16-May-89 11:51:20 TxH  Added IsOkToDeleteFile and AnyTrashedSpaceInternal to FileLockMisc. Moved InsertLockIntoRun to SpaceImplC from SpaceImplB and added other SpaceImplC's stuff.-- 11-Apr-89 11:58:38 TxH  Added DeleteLockInternal, DiscardLockAndVMData and AnyTrashedSpace. (SS-FX: AR#6, AR#26)-- 29-Mar-89 10:05:57 TXT  Move InsertLockIntoRun to SpaceImplB and add Bug in SpaceImplB--20-Nov-87 10:41:34  KEK per RSV  Moved GetMapUnitAttributes from SpaceMisc to SpaceUnmap (since called a lot by BWS and Services Unmap code!)--17-Jul-87  9:18:39  Added CATCH CODE for MapLogImpl.--16-Jan-87 16:11:22 ET Moved GetRuns from SpaceImplA to SpaceImplB. Added CATCH CODE in SpaceImplB.--18-Dec-86 15:57:20 Added CheckBucket to FileLockMisc.--17-Nov-86 17:19:36 Changed name of SpaceImpl to SpaceImplA.  Added SpaceImplB and FileLockImpl (including FileLockMisc code pack).-- 1-Feb-86 11:32:43 Added MapLogCleaning, CleanMapLog, InsertEntry. Also, SetUpDualLogAccounting.--6-Jan-84  9:50:59 Added DoCopyHelperProcess, SendMessageToHelper, SendNewMessageProcessed, WaitForMessageFromHelper, WaitForNewMessage--10-Jun-83 15:49:52 Split allocate stuff from Map--3-Jun-83 15:32:58 change MakeResident/MakeSwappable to SetSwappability--4-May-83 15:17:06 add IsAllocated	--2-May-83 11:40:17 add AllocateInterval--1-Apr-83 15:09:10--   Add RegisterAddressFaultFielder, RegisterFaultFielder, RegisterWriteProtectFaultFielder--1-Mar-83 22:25:24  Add MapAtInternal.--27-Feb-83 13:11:22  Add procedure SetCountThreshold to SpaceMisc.--24-Dec-82 10:52:55  Twiddles for Klamath.--25-Aug-82 12:26:41  Many mods for Klamath.-- For earlier entries, see the Pilot 8.0 archivesVMMgr: SEGMENT =BEGINSpaceMap: CODE PACK =  BEGIN  FileLockImpl [ENTRY VECTOR, GetLock];  SpaceImplA [    ENTRY VECTOR, AllocateDataWindow, FinishWithRuns,    Map, MapAt, MapAtInternal];  SpaceImplB [ENTRY VECTOR, AllocateStorage, GetRuns];  SpaceImplC [ENTRY VECTOR, InsertLockIntoRuns];  END;SpaceAllocation: CODE PACK =  BEGIN  SpaceAllocImpl [    ENTRY VECTOR, Allocate, AllocateInInterval, DoAllocate, FixUpRegion,    FixUpWithInterval, IsAllocated];  END;SpaceLargeRuns: CODE PACK =  BEGIN  SpaceImplA [BiggerRuns];  END;SpaceUnmap: CODE PACK =  BEGIN  FileLockImpl [DeleteLock, DeleteLockInternal, GetFileIDFromLock];  SpaceAllocImpl [Deallocate];  SpaceImplA [DeallocatePossibleDataWindow, GetMapUnitAttributes,     Unmap, UnmapAt];  SpaceImplB [DeallocateStorage];  END;SpaceCopying: CODE PACK =  BEGIN  SpaceImplA [CopyIn, CopyOut, DoCopy];  END;  SpaceCopyingHelper: CODE PACK =  BEGIN  SpaceImplA [DoCopyHelperProcess, SendMessageToHelper, SendNewMessageProcessed,  WaitForMessageFromHelper, WaitForNewMessage];  END;SpaceStatusOps: CODE PACK =  BEGIN  SpaceImplA [    Activate, ActivateProc, Deactivate, DeactivateProc, ForceOut,    Kill, SetAccess];  END;SpaceMisc: CODE PACK =  BEGIN  SpaceImplA [    DoneWithAddressFaultFielder, DoneWithFaultHandler,    DoneWithWriteProtectFaultFielder, GetSwapUnitAttributes,    Pointer, PointerFromPage, RegisterAddressFaultFielder,    RegisterFaultFielder, RegisterWriteProtectFaultFielder, SetCountThreshold];  END;  FileLockMisc: CODE PACK =  BEGIN  FileLockImpl [   AnyTrashedSpace, AnyTrashedSpaceInternal, CheckBucket, DiscardLockAndVMData,   GetLockHandleFromFileID, IsLocked, IsOkToDeleteFile];  END;SpaceCodeHacking: CODE PACK =  BEGIN  SpaceImplA [    MakeCatchCodeResident,   MakeCatchCodeSwappable,    MakeEntryVectorResident, MakeEntryVectorSwappable,    MakeGlobalFrameResident, MakeGlobalFrameSwappable,    MakeProcedureResident,   MakeProcedureSwappable,    SetSwappability];  END;SpaceSpecialCreates: CODE PACK =  BEGIN  SpaceAllocImpl [    AllocateAligned, AllocateForCode, FindAlignedSpace, AllocateInterval];  END;SpaceMapLogging: CODE PACK =  BEGIN  MapLogImpl [MakeDiskBackingStoreEntry, WriteLog1, ENTRY VECTOR, CATCH CODE];  END;  MapLogCleaning: CODE PACK =  BEGIN  -- these guys less used than PROCs in SpaceMapLogging.  MapLogImpl [CleanMapLog, InsertEntry, UpdateESV];  END;SpaceCatchCode: CODE PACK =  BEGIN  FileLockImpl [Bug, CATCH CODE];  SpaceAllocImpl [CATCH CODE];  SpaceImplA [Bug, BugV, CATCH CODE];  SpaceImplB [CATCH CODE];--  SpaceImplC [CATCH CODE];  END;SpaceProcesses: CODE PACK =  BEGIN  SpaceImplA [FaultFielder, FaultProcess, OperationHandler, QueueOperation];  END;VMMgrInitialization: CODE PACK =  BEGIN  FileLockImpl [FileLockInit, MAIN];  MapLogImpl [InitializeMapLog, MAIN, SetUpDualLogAccounting];  SpaceAllocImpl [InitializeSpaceAllocation, MAIN, SpaceForSpaceAllocation];  SpaceImplA      [InitializeVMMgr, MAIN];  SpaceImplB [MAIN];  SpaceImplC [MAIN];  END;END; --SEGMENT--VMMgrFrames: FRAME PACK =  BEGIN  FileLockImpl;  MapLogImpl;  SpaceAllocImpl;  SpaceImplA;  SpaceImplB;  SpaceImplC;  END;--End of VMMgrPack.pack--