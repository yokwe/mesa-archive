-- Copyright (C) 1984, 1986, 1987  by Xerox Corporation. All rights reserved. -- SOSP83HeapInternal.mesa    29-Jun-87 10:59:48 by RSVDIRECTORY  Heap USING [NWords],  PrincOpsExtras2 USING [GFTHandle],  Space USING [PageCount],  System USING [VolumeID];SOSP83HeapInternal: DEFINITIONS =  BEGIN  UncountedZoneRep: TYPE = LONG POINTER TO UncountedZoneObject;  UncountedZoneObject: TYPE = MACHINE DEPENDENT RECORD [    procs(0:0..31): LONG POINTER TO Procs, data(2:0..31): Handle];  Procs: TYPE = MACHINE DEPENDENT RECORD [    Make(0): PROC [UNCOUNTED ZONE, Heap.NWords] RETURNS [LONG POINTER],    Free(2): PROC [UNCOUNTED ZONE, LONG ORDERED POINTER]];  Data: TYPE = RECORD [    seal: INTEGER ¬ currentSeal,    lock: MONITORLOCK,    maxSize, currentSize, increment, swapUnit: Space.PageCount,    resident: BOOLEAN ¬ FALSE,    ownerChecking, checking: BOOLEAN,    volumeID: System.VolumeID,    v1: SELECT tag: * FROM      normal => [	root: NodePointer,	threshold, largeNodeThreshold: CARDINAL,	largeNodes: LargeNode ¬ NIL,	segments: SegmentHandle,	v2: SELECT where: * FROM	  hyper => [uzo: UncountedZoneObject],	  mds => [mzo: MDSZoneObject],	  ENDCASE],      uniform => [        blocks: Block,	free: UniformNode,	objectSize: Heap.NWords,	uzo: UncountedZoneObject],      ENDCASE];  Handle: TYPE = LONG POINTER TO Data;  LargeNode: TYPE = LONG POINTER TO LargeNodeHeader;  LargeNodeHeader: TYPE = MACHINE DEPENDENT RECORD [    next(0): LargeNode,    node(2): NodeHeader];  OwnerHandle: TYPE = LONG POINTER TO OwnerObject;  OwnerObject: TYPE = RECORD [    frame: PrincOpsExtras2.GFTHandle];  -- Normal  HyperHandle: TYPE = LONG POINTER TO hyper normal Data;  NormalHandle: TYPE = LONG POINTER TO normal Data;  NodeLength: TYPE = CARDINAL;    NodeHeader: TYPE = MACHINE DEPENDENT RECORD [    length(0): NodeLength,    left(1), right(3): NodePointer];    NodePointer: TYPE = LONG ORDERED POINTER TO NodeHeader;    RootPointer: TYPE = LONG POINTER TO NodePointer;    SegmentHandle: TYPE = LONG POINTER TO SegmentObject;  SegmentObject: TYPE = RECORD [    next: SegmentHandle,    base: NodePointer,    length: NodeLength,    initial: BOOLEAN];    maxSegmentPages: CARDINAL = 256;  -- Uniform  UniformHandle: TYPE = LONG POINTER TO uniform Data;  UniformNode: TYPE = LONG ORDERED POINTER TO UniformNodeObject;  UniformNodeObject: TYPE = RECORD [next: UniformNode];  Block: TYPE = LONG ORDERED POINTER TO BlockObject;  BlockObject: TYPE = RECORD [next: Block, length: NAT, initial: BOOLEAN];  -- MDS  MdsHandle: TYPE = LONG POINTER TO mds normal Data;  ShortMdsHandle: TYPE = POINTER TO mds normal Data;  MDSZoneRep: TYPE = POINTER TO MDSZoneObject;  MDSZoneObject: TYPE = MACHINE DEPENDENT RECORD [    procs(0): POINTER TO MDSProcs, data(1): ShortMdsHandle];  MDSProcs: TYPE = MACHINE DEPENDENT RECORD [    Make(0): PROC [MDSZone, Heap.NWords] RETURNS [POINTER],    Free(2): PROC [MDSZone, ORDERED POINTER]];  -- Constants  currentSeal: INTEGER = 01094;  END....LOG31-Jan-84  8:26:10 XXJ  Created file.27-Jun-86 13:52:58 RSV  Changed file name to SOSP83HeapInternal and changed _ to ¬.18-Mar-87 14:28:25 RSV  Use PrincOpsExtras2.GFTHandle instead of PrincOps.GlobalFrameHandle.29-Jun-87 11:00:01 RSV  Added volumeID to Data record.