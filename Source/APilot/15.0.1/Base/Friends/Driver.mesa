-- File: Driver.mesa - last edit:-- AOF                 18-Aug-86 17:33:10-- SMA                 23-May-86  9:00:17-- Copyright (C) 1984, 1986 by Xerox Corporation. All rights reserved. DIRECTORY  Buffer USING [Buffer, DeviceType],  Protocol1 USING [Action, Matrices];Driver: DEFINITIONS  IMPORTS Buffer =  BEGIN  --Interface from device drivers to Dispatcher and QueuePackage  PutOnGlobalInputQueue: PROC[Buffer.Buffer];  PutOnGlobalDoneQueue: PROC[Buffer.Buffer];  GetInputBuffer: PROC[wait: BOOLEAN ¬ FALSE, minimumSize: CARDINAL]    RETURNS [Buffer.Buffer];  ReturnFreeBuffer: PROC[Buffer.Buffer];      --Interface to Device Drivers  nilDevice: Device = NIL;  Device: TYPE = LONG POINTER TO DeviceObject;  DeviceObject: TYPE = RECORD [    next: Device,  --to the linked list of drivers    activateDriver, deactivateDriver, deleteDriver: PROC,    matrix: LONG DESCRIPTOR FOR Protocol1.Matrices,  --driver X family    sendRawBuffer: PROC[Buffer.Buffer],  --short cut    receiveBufferLen: CARDINAL,  --size this device supports    changeNumberOfInputBuffers: PROC[--increaseBuffers--BOOLEAN] ¬ NIL,    index: [0..400B), -- assigned by AddDeviceToChain (starts at 1)    device: Buffer.DeviceType, -- 4 bits    alive: BOOLEAN,  --can't use if not alive    buffers: [0..256),  --for use by driver to support i/o    getThroughput: PROC RETURNS [CARDINAL],  --of this device    lineSpeed: CARDINAL,  --line speed in kbit/sec    lineNumber: CARDINAL,  --of the device    stats: LONG POINTER]; -- statistics of the level-0 driver        --ON/OFF  GetUseCount: PROC RETURNS [CARDINAL];  --Device Things  AddDeviceToChain: PROC[Device];  RemoveDeviceFromChain: PROC[Device];  GetDeviceChain: PROC RETURNS [Device];  GetNthDevice: PROC[CARDINAL, Buffer.DeviceType] RETURNS[Device];  NetworkNonExistent: ERROR;  --raised by GetNthDevice.  SmashDeviceChain: PROC; -- only used by LoopBackPlug (to forget Ethernet)  ChangeNumberOfInputBuffers: PROC[increaseTheBuffers: BOOLEAN];  StateChange: PROC[Device, Protocol1.Action];    --General catchall for things that shouldn't happen  Glitch: PROC[ERROR];  END.LOG14-May-84 11:18:05  AOF  Post Klamath 9-May-86 11:28:34  SMA  Support for different encapsulations and buffer sizes.16-May-86  9:07:05  SMA  Added getThroughput.17-Jun-86 17:59:38  AOF  Added 'minimumSize' to GetInputBuffer18-Aug-86 17:31:45  AOF  Added StateChange proc for device drivers