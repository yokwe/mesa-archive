-- File: Protocol1.mesa - last edit:-- AOF                 17-Jun-86 17:52:28-- SMA                 19-May-86 14:47:42-- Copyright (C) 1984, 1986 by Xerox Corporation. All rights reserved. DIRECTORY  Buffer USING [Buffer, Device, Function, Type];Protocol1: DEFINITIONS =  BEGIN  --Ties level-0 driver to level-1 protocol families  Action: TYPE = {add, remove, modify};  DecapsulatorProc: TYPE = PROC[b: Buffer.Buffer] RETURNS[Buffer.Type];  EncapsulatorProc: TYPE = PROC[b: Buffer.Buffer, immediate: LONG POINTER];  FamilyStatus: TYPE = {alive, dead};  ProtocolFamily: TYPE = Buffer.Type(FIRST[Buffer.Type]..LAST[Buffer.Type]);  Family: TYPE = LONG POINTER TO FamilyUnit;  FamilyIndex: TYPE = CARDINAL[0..ORD[LAST[ProtocolFamily]] - 2);  FamilyUnit: TYPE = RECORD [    name: ProtocolFamily,  --name of this family    state: LONG POINTER,  --to family unique state    status: FamilyStatus,  --current status of family    maxBufferSize: CARDINAL,  --requested by this family    receive: PROC[Buffer.Buffer],  --incoming packets    broadcast: PROC[Buffer.Buffer],  --to all connected nets    stateChanged: PROC[Buffer.Device, LONG POINTER, Action],    spy: PROC[Buffer.Buffer, Buffer.Function]      RETURNS[Buffer.Buffer]];  --level-1 spy proc  Matrix: TYPE = LONG POINTER TO MatrixRecord;  Matrices: TYPE = ARRAY FamilyIndex OF MatrixRecord;  MatrixRecord: TYPE = RECORD[    family: Family,  --back pointer to family unit    context: LONG POINTER,  --to device/family specific data    encapsulator: EncapsulatorProc, decapsulator: DecapsulatorProc];  UniqueName: TYPE = ProtocolFamily(arpa..orphan);  --only ones available  NoVacancy: ERROR;  --no more UniqueNames available  NotInterested: ERROR;  --don't add family support  TenentNotRegistered: ERROR;  --not found from GetFamilyUnit    AcquireUniqueName: PROC RETURNS[UniqueName];  --returns and consumes name  EvictFamily: PROC[name: ProtocolFamily];  --entire family  GetFamilyUnit: PROC[ProtocolFamily] RETURNS[Family];  --locator  RegisterFamily: PROC[family: Family];  --starts protocol  ReleaseUniqueName: PROC[UniqueName];  --undoes AcquireUniqueName  AddFamilyMember: PROC[driver: Buffer.Device, matrix: Matrix];  RemoveFamilyMember: PROC[driver: Buffer.Device, family: Family];  SetMaximumBufferSize: PROC[    driver: Buffer.Device, family: Family, size: CARDINAL];  DecapsulateAndRoute: DecapsulatorProc;  EncapsulateAndTransmit: EncapsulatorProc;  GetContext: PROC[Buffer.Device, ProtocolFamily] RETURNS[LONG POINTER];    END.... Capsulation(DEFINITIONS)LOG14-May-84 10:16:20  AOF  Created file 9-May-86 18:38:11  SMA  Added TenentNotRegistered.17-Jun-86 17:51:37  AOF  FamilyUnit.maxBufferSize and SetMaximumBufferSize proc