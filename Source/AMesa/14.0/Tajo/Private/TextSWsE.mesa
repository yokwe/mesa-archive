-- Copyright (C) 1982, 1983  by Xerox Corporation. All rights reserved. -- TextSWsE.mesa, last edited by:-- SXS   	17-Oct-82 20:45:12-- AXD    	25-Jan-83 23:19:58-- Standard TIP Interpreter for TextSWDIRECTORY  Atom: TYPE USING [ATOM, GetPName],  Profile: TYPE USING [debugging],  Put: TYPE USING [Text],  System: TYPE USING [Pulses],  TEdit: TYPE USING [    CancelMultiClick, CommandProc, CommandProcFromAtom, SetInitialState],  TextSWOps: TYPE,  TIP: TYPE USING [First, NotifyProc, Rest, Results, ResultsList],  UserInput: TYPE USING [StuffCharacter, StuffString],  UserTerminal: TYPE USING [BlinkDisplay],  Window: TYPE USING [Handle, Place];  TextSWsE: PROGRAM   IMPORTS Atom, Profile, Put, TEdit, TIP, UserInput, UserTerminal  EXPORTS TEdit, TextSWOps =     PUBLIC BEGIN    ATOM: TYPE = Atom.ATOM;    -- Interpreter stuff    int: LONG INTEGER;  place: Window.Place;  time: System.Pulses;    lastTime: System.Pulses;  lastPlace: Window.Place;    clickTimeout: System.Pulses;    <<closeEvent: PRIVATE BOOLEAN ¬ TRUE; -- for EditHistory?  CloseEvent: PROC = {closeEvent ¬ TRUE};>>    InterpAtom: PROC [window: Window.Handle, atom: ATOM] = {    command: TEdit.CommandProc = TEdit.CommandProcFromAtom[atom];    IF command = NIL THEN {      IF Profile.debugging THEN {        UserTerminal.BlinkDisplay[];        Put.Text[NIL, "Unknown atom ("L];        Put.Text[NIL, Atom.GetPName[atom]];        Put.Text[NIL, ") given to TEdit."L]}}    ELSE IF command[window] THEN --RecordAtom[atom]--NULL};    InterpretAtom: PUBLIC --ENTRY-- PROC [window: Window.Handle, atom: ATOM] = {    --ENABLE UNWIND => NULL;    InterpAtom[window, atom]};    DontDoIt: SIGNAL = CODE;    <<InterpretInput, TIPMe: ENTRY TIP.NotifyProc = {    ENABLE UNWIND => NULL; InterpInput[window, results]};>>  InterpInput, TIPMe, InterpretInput: TIP.NotifyProc = {    TEdit.SetInitialState[];    FOR input: TIP.Results ¬ results, input.Rest UNTIL input = NIL DO      WITH z: input.First SELECT FROM        char => {	  TEdit.CancelMultiClick;	  IF UserInput.StuffCharacter[window, z.c] THEN NULL--RecordChar[z.c]--	  ELSE UserTerminal.BlinkDisplay};        coords => place ¬ z.place;        atom => InterpAtom[window, z.a ! DontDoIt => EXIT];        int => {int ¬ z.i; --RecordInt[n]--};        string => {	  TEdit.CancelMultiClick;	  IF UserInput.StuffString[window, z.s] THEN NULL--RecordString[z.s]--	  ELSE UserTerminal.BlinkDisplay};	time => time ¬ z.time;        ENDCASE;      ENDLOOP};    END.  