TS.doc, last edited on 20-Jun-86 11:38:41 by kamTS is a program that allows an administrator to look at the time service and modify the time in the service. TS runs in a XDE, such as CoPilot, an integration machine or a Pup Server. It has no dependencies on the Pup protocol, since it deals only with XNS-based time servers.TS registers the command TS.~ with the executive. To interact with TS, the user types a command of the form	TS action parameters.There are 19 actions. The actions can be divided into 4 categories: working with the local clock, surveying time servers, analyzing the results of surveys, and operating on time servers. There is also a help action. One action (Monitor) is not implemented. WORKING WITH THE LOCAL CLOCK> TS Me {start, stop}starts or stops a local time server. When TS starts, the local time server alsio starts. The command "TS Me" tells the user whether the local server is active or not. > TS Clock offset errorsets the local clock ahead or back the number of seconds in "offset" and sets the local error in the time to "error" milliseconds. You should probably never specify an error less than 3000, given the granularity of our clocks and the inaccuracy of this command.If offset has the N switch, the time service version number is incremented. This will force your time to propogate through the time service if your local time service is started.If no value of offset and error is given, this command will report the current time, error and version number.To "inject" a new time into the time service, an administrator can follow the following procedure:Type TS me start. It can take up to 15 seconds or so for the local time server to get the time from the network once it is started. Use the "TS clock" to see when the clock is reset (the error is not huge, and the version is not zero). Then, using the TS clock command and a time source estimate the difference between your clock and the time standard you're using. Reset your clock using TS offset without specifying an error. Once your clock is correct, type the command	TS clock 0/n 3000(or whatever error you wish to specify). This will increment the version number and start the time propogating.SURVEYING TIME SERVERSTS will conduct a survey of the time servers on a set of networks. It collects clock offsets, clock rates and other information into an internal database.> TS FindServersThis command looks at all the networks and lists those nets with time servers on them. It doesn't affect the current surveying.> TS SurveyNetwork <nets><nets> is a list of octal network numbers separated by spaces. This command will have TS include these networks in the surveying (which is started, if these are the first nets in the survey).> TS SetParameters [processes/p] [delay/d] [trim/t]This command sets:  - the number of networks that can be concurrently surveyed (default 40)  - the minimum delay between surveys of a network, in seconds (default 60)  - the number of surveys for which after a server does not respond    its value is ignored to in the analysis command (trim = 0 means never    ignore, which is the default value)> TS InformationLists various information about the survey. For example,   >TS information  The maximum number of processes is 40  The minimum delay between surveys of a network is 60 seconds  All collected values will be used  The local server is active  The following nets are being surveyed: 1234~ 142~ 140~ 1750 204 131~ 1233~   All nets have been surveyed 6 timesThe list of nets contains all networks that are being surveyed. If a tilda follows a network, TS is currently actively collecting information from the time servers on that net.> TS Pause [n]This command will return after n more surveys complete (default one). TS pause 0 will immediately return.> TS QuitStops all surveying and clears the internal database. This command will not complete until all other TS commands have completed.ANALYZING THE RESULTS OF SURVEYSIn these commands, <nets> is a list of octal network numbers separated by spaces, and <addresses> is a list of machine addresses in octal separated by spaces.> TS ServerInfo <addresses>Lists the information collected on the specified time servers. For example,  >TS server 1234.25200000763.  1234.25200000763. +/- 4.086 + .010 off -1 version 12548 rate .000006 +/- .026453 reset 20-Jun-86 10:36:11 by 2 from 1234.25200003377. 79460 req  The time server on machine 1234.25200000763.:  - has an error of 4.086 seconds  - took 0.010 seconds to answer the last time request  - has a clock -1 second different from the local clock (1 second slow)  - has a time version number of 12548  - has a rate of .000006 +/- .026453 seconds/second compared to the local clock  - last reset on 20-Jun-86 10:36:11 from 1234.25200003377. by 2 seconds  - has answered 79460 time requests since last booted> TS EnumerateNetwork <nets>For each net, lists the information collected on its time servers. > TS BestServer <nets>> TS BestServer diffence/d <nets>The first form of the command displays information on the server in all the nets listed with the smallest error. The second form of the command finds the server in the list of nets with the smallest error, and looks at the best servers on each other net. If one of these best servers is less accurate than the overall best one by "diffence" seconds, it is displayed.> TS Consistency [number/m] <nets>Checks the servers on the listed nets for consistency. If the servers are inconsistent, this command will tell you the minimum number of servers that must be incorrect, and give a list of hosts that are most probably incorrect. If you specify the optional "number", this command will assume that at least "number" servers are incorrect, and give you a list of hosts that are most probably incorrect.> TS Consonance [number/m] <nets>This command has the same form as the consistency command, but it checks the rates of the clocks rather than the values of the clocks. Given the difficulty in measuring this information, however, you should treat the results from this command as hints rather than hard facts.> TS Diagnose [hops/h] [timeCheck/t] [rateCheck/r]The diagnose command bundles up several of the above commands. It:  - starts surveying all networks with time servers and within "hops" hops  - waits for "timeCheck" surveys, then runs a consistency command over    all surveyed networks  - waits for "rateCheck" surveys, then runs a consonance command over    all surveyed networksThe survey is left running at termination.OPERATING ON TIME SERVERS> TS Reset address <addresses>Resets the servers in the address list from the first server. For example,   > TS reset 1234.25200003377. 1234.25200012117. 1234.25200000116.will have the time servers on 1234.25200012117. 1234.25200000116. synchronize with 1234.25200003377.> TS Stop <addresses>Stops the time servers on the specified machines.> TS Start <addresses>Starts the time servers on the specified machines.