-- Copyright (C) 1987  by Xerox Corporation. All rights reserved. -- FTTMakeFormBImpl.mesa, last edited by:   RSV on  1-May-87 15:42:02DIRECTORY  Floppy,  FormSW USING [    AllocateItemDescriptor, BooleanItem, ClientItemsProcType,     CommandItem, Enumerated, EnumeratedItem, NumberItem, LongNumberItem,    StringItem, line0, line1, line2, line3, line4, line5, line6, ProcType],  FTTDefs,  UserTerminal USING [];  FTTMakeFormBImpl: PROGRAM   IMPORTS FormSW, FTTDefs  EXPORTS FTTDefs  SHARES Floppy =  BEGIN OPEN FTTDefs;  CompactMakeOptions: PUBLIC FormSW.ClientItemsProcType =    BEGIN OPEN FormSW;    nOptions: CARDINAL = 4;    items ¬ AllocateItemDescriptor[nOptions];    items[0] ¬ NumberItem[tag: "VolumeHandle word1"L, place: [0, line0],      signed: FALSE, notNegative: TRUE, value: @toolData.volumeHandle.lowbits];    items[1] ¬ NumberItem[      tag: "word2"L, place: [180, line0], signed: FALSE, notNegative: TRUE,      value: @toolData.volumeHandle.highbits];    items[2] ¬ CommandItem[tag: "Abort"L, place: [250, line1],      proc: RemoveOptions];    items[3] ¬ CommandItem[tag: "Do it"L, place: [250, line2],       proc: CompactApplyOptions];    RETURN[items, TRUE]     END;      ScavengeMakeOptions: PUBLIC FormSW.ClientItemsProcType =    BEGIN OPEN FormSW;    nOptions: CARDINAL = 3;    items ¬ AllocateItemDescriptor[nOptions];    items[0] ¬ NumberItem[tag: "Drive"L, place: [0, line0],      signed: FALSE, notNegative: TRUE, value: @toolData.drive];    items[1] ¬ CommandItem[tag: "Abort"L, place: [250, line0],      proc: RemoveOptions];    items[2] ¬ CommandItem[tag: "Do it"L, place: [250, line1],       proc: ScavengeApplyOptions];    RETURN[items, TRUE]     END;      GetNextBadSectorMakeOptions: PUBLIC FormSW.ClientItemsProcType =    BEGIN OPEN FormSW;    nOptions: CARDINAL = 5;    items ¬ AllocateItemDescriptor[nOptions];    items[0] ¬ NumberItem[tag: "VolumeHandle word1"L, place: [0, line0],       signed: FALSE, notNegative: TRUE, value: @toolData.volumeHandle.lowbits];    items[1] ¬ NumberItem[      tag: "word2"L, place: [180, line0], signed: FALSE, notNegative: TRUE,      value: @toolData.volumeHandle.highbits];    items[2] ¬ NumberItem[      tag: "oldIndex"L, place: [0, line1], signed: FALSE, notNegative: TRUE,      value: @toolData.oldIndex];    items[3] ¬ CommandItem[tag: "Abort"L, place: [250, line1],      proc: RemoveOptions];    items[4] ¬ CommandItem[tag: "Do it"L, place: [250, line2],      proc: GetNextBadSectorApplyOptions];    RETURN[items, TRUE]     END;      ReplaceBadSectorMakeOptions: PUBLIC FormSW.ClientItemsProcType =    BEGIN OPEN FormSW;    nOptions: CARDINAL = 7;    items ¬ AllocateItemDescriptor[nOptions];    items[0] ¬ NumberItem[tag: "VolumeHandle word1"L, place: [0, line0],      signed: FALSE, notNegative: TRUE, value: @toolData.volumeHandle.lowbits];    items[1] ¬ NumberItem[      tag: "word2"L, place: [180, line0], signed: FALSE, notNegative: TRUE,      value: @toolData.volumeHandle.highbits];    items[2] ¬ NumberItem[tag: "FileID word1"L, place: [0, line1], signed: FALSE,      notNegative: TRUE, value: @toolData.fileID.a];    items[3] ¬ NumberItem[      tag: "word2"L, place: [180, line1], signed: FALSE, notNegative: TRUE,      value: @toolData.fileID.b];    items[4] ¬ LongNumberItem[tag: "page"L, place: [0, line2], signed: FALSE,      notNegative: TRUE, value: @toolData.first];    items[5] ¬ CommandItem[tag: "Abort"L, place: [250, line2],      proc: RemoveOptions];    items[6] ¬ CommandItem[tag: "Do it"L, place: [250, line3],      proc: ReplaceBadSectorApplyOptions ];    RETURN[items, TRUE]    END;  CreateInitialMakeOptions: PUBLIC FormSW.ClientItemsProcType =    BEGIN OPEN FormSW;    nOptions: CARDINAL = 7;    items ¬ AllocateItemDescriptor[nOptions];    items[0] ¬ NumberItem[tag: "VolumeHandle word1"L, place: [0, line0],      signed: FALSE, notNegative: TRUE, value: @toolData.volumeHandle.lowbits];    items[1] ¬ NumberItem[      tag: "word2"L, place: [180, line0], signed: FALSE, notNegative: TRUE,      value: @toolData.volumeHandle.highbits];    items[2] ¬ LongNumberItem[tag: "size"L, place: [0, line1], signed: FALSE,      notNegative: TRUE, value: @toolData.size];    items[3] ¬ NumberItem[      tag: "type"L, place: [100, line1], signed: FALSE, notNegative: TRUE,      value: @toolData.type];    items[4] ¬ LongNumberItem[tag: "startingPageNumber"L, place: [0, line2],       signed: FALSE, notNegative: TRUE, value: @toolData.startingPageNumber];    items[5] ¬ CommandItem[tag: "Abort"L, place: [250, line2],       proc: RemoveOptions];    items[6] ¬ CommandItem[tag: "Do it"L, place: [250, line3],       proc: CreateInitialApplyOptions ];    RETURN[items, TRUE]    END;  GetBootFilesMakeOptions: PUBLIC FormSW.ClientItemsProcType =    BEGIN OPEN FormSW;    nOptions: CARDINAL = 4;    items ¬ AllocateItemDescriptor[nOptions];    items[0] ¬ NumberItem[tag: "volumeVHw1"L, place: [0, line0],      signed: FALSE, notNegative: TRUE, value: @toolData.volumeHandle.lowbits];    items[1] ¬ NumberItem[      tag: "volumeVHw2"L, place: [150, line0], signed: FALSE, notNegative: TRUE,      value: @toolData.volumeHandle.highbits];    items[2] ¬ CommandItem[tag: "Abort"L, place: [250, line1],       proc: RemoveOptions];    items[3] ¬ CommandItem[tag: "Do it"L, place: [250, line2],       proc: GetBootFilesApplyOptions];    RETURN[items, TRUE]    END;   MakeImageMakeOptions: PUBLIC FormSW.ClientItemsProcType =    BEGIN OPEN FormSW;    nOptions: CARDINAL = 8;    items ¬ AllocateItemDescriptor[nOptions];    items[0] ¬ StringItem[tag:"Image File"L, place: [0,line0],       string: @toolData.pilotFileID];    items[1] ¬ NumberItem[tag: "Drive"L, place: [0, line1],      signed: FALSE, notNegative: TRUE, default: toolData.drive, value: @toolData.drive];    items[2] ¬ LongNumberItem[      tag: "firstPilotPage"L, place: [140, line1], signed: FALSE,      notNegative: TRUE, value: @toolData.pilotPage];    items[3] ¬ LongNumberItem[      tag: "newSize"L, place: [0, line2], signed: FALSE, notNegative: TRUE,      value: @toolData.count];    items[4] ¬ CommandItem[tag: "SetSize"L, place: [140, line2],      proc:  SetSizeOfImageFile];    items[5] ¬ CommandItem[tag: "GetAFile"L, place: [250, line2],      proc: GetAFileOptionsWindow];    items[6] ¬ CommandItem[      tag: "Abort"L, place: [140, line3], proc: RemoveOptions];    items[7] ¬ CommandItem[      tag: "Do It"L, place: [250, line3], proc: MakeImageApplyOptions];    RETURN[items, TRUE]    END;      CreateFloppyFromImageMakeOptions: PUBLIC FormSW.ClientItemsProcType =    BEGIN OPEN FormSW;    nOptions: CARDINAL = 11;    e1: ARRAY [0..3) OF Enumerated ¬ [      ["Single Density"L, Floppy.Density[single]],      ["Double Density"L, Floppy.Density[double]],      ["Default Density"L, Floppy.Density[default]]];    e2: ARRAY [0..3) OF Enumerated ¬ [      ["One Sided"L, Floppy.Sides[one]], ["Two Sided"L, Floppy.Sides[two]],      ["Default Sides"L, Floppy.Sides[default]]];    items ¬ AllocateItemDescriptor[nOptions];    items[0] ¬ StringItem[tag:"Image File"L, place: [0,line0],      string: @toolData.pilotFileID];    items[1] ¬ StringItem[tag:"Floppy Label String"L, place: [0,line1],      string: @toolData.labelString, inHeap: TRUE];    items[2] ¬ NumberItem[tag: "Drive"L, place: [0, line2], signed: FALSE,      notNegative: TRUE, default: toolData.drive, value: @toolData.drive];    items[3] ¬ NumberItem[tag: "Number of File List Entries"L,      place: [200, line2], signed: FALSE, notNegative: TRUE,      default: toolData.numberOfFiles, value: @toolData.numberOfFiles];    items[4] ¬ LongNumberItem[      tag: "firstPilotPage"L, place: [0, line3], signed: FALSE,      notNegative: TRUE, value: @toolData.pilotPage];    items[5] ¬ BooleanItem[tag: "Reformat"L, place: [200, line3],       switch: @toolData.reFormat];    items[6] ¬ EnumeratedItem[tag: "Density"L, place: [0, line4],       value: @toolData.density, choices: DESCRIPTOR[e1]];    items[7] ¬ EnumeratedItem[tag: "Sides"L, place: [200, line4],       value: @toolData.sides, choices: DESCRIPTOR[e2]];    items[8] ¬ CommandItem[tag: "GetAFile"L, place: [100, line5],      proc: GetAFileOptionsWindow];    items[9] ¬ CommandItem[      tag: "Abort"L, place: [250, line5], proc: RemoveOptions];    items[10] ¬ CommandItem[      tag: "Do It"L, place: [250, line6],      proc: CreateFloppyFromImageApplyOptions];    RETURN[items, TRUE]    END;      GetImageAttributesMakeOptions: PUBLIC FormSW.ClientItemsProcType =    BEGIN OPEN FormSW;    nOptions: CARDINAL = 5;    items ¬ AllocateItemDescriptor[nOptions];    items[0] ¬ StringItem[tag:"Image File"L, place: [0, line0],      string: @toolData.pilotFileID];    items[1] ¬ LongNumberItem[      tag: "firstPilotPage"L, place: [0, line1], signed: FALSE, notNegative: TRUE,      value: @toolData.pilotPage];    items[2] ¬ CommandItem[tag: "GetAFile"L, place: [100, line2],      proc: GetAFileOptionsWindow];    items[3] ¬ CommandItem[      tag: "Abort"L, place: [250, line2], proc: RemoveOptions];    items[4] ¬ CommandItem[      tag: "Do It"L, place: [250, line3], proc: GetImageAttributesApplyOptions];    RETURN[items, TRUE]    END;    PagesForImageMakeOptions: PUBLIC FormSW.ClientItemsProcType =    BEGIN OPEN FormSW;    nOptions: CARDINAL = 3;    items ¬ AllocateItemDescriptor[nOptions];    items[0] ¬ NumberItem[tag:"Drive"L, place: [0,line0], signed: FALSE,      notNegative: TRUE, default: toolData.drive,  value: @toolData.drive];    items[1] ¬ CommandItem[      tag: "Abort"L, place: [250, line1], proc: RemoveOptions];    items[2] ¬ CommandItem[      tag: "Do It"L, place: [300, line1], proc: PagesForImageApplyOptions];    RETURN[items, TRUE]    END;  END...  LOG29-Oct-81  9:35:03  MXF  created file.29-Oct-82  9:42:28  ET   various changes. 3-Apr-87 18:25:31  RSV  Old arrows to new arrows.  Added copyright notice.  Folded in ET's changes.  Update for new FTTDefs. 1-May-87 15:42:14  RSV  Update ScavengeMakeOptions for FloppyExtras.NewScavenge.