-- Copyright (C) 1984  by Xerox Corporation. All rights reserved. --MugInternal.mesa	last edited by: CAJ 	14-Jun-84 16:59:18-- Internal Interface for the Disk Torment-and-Scavenge ToolDIRECTORY  DiskChannel USING [DiskPageNumber, Drive],  File USING [File, ID, nullID, PageCount, PageNumber, Type],  FormSW USING [ClientItemsProcType, EnumeratedDescriptor],  PilotDisk USING [Label, Handle],  PilotDiskFace USING [OperationPtr],  Scavenger USING [RepairType],  Volume USING [ID],  Window USING [Handle];MugInternal: DEFINITIONS =  BEGIN    --TYPEs    DataHandle: TYPE = LONG POINTER TO Data;  Data: TYPE = RECORD [    -- Caution: All elements requiring less than a word are carefully sandwiched    -- between integral-word values to make each occupy a whole word for tool    -- addressing.    msgSW: Window.Handle ¬ NIL,    paramSW: Window.Handle ¬ NIL,    tSW: Window.Handle ¬ NIL,    sSW: Window.Handle ¬ NIL,    fSW: Window.Handle ¬ NIL,    logSW: Window.Handle ¬ NIL,    mode: Mode ¬ NULL,    volume: CARDINAL ¬ 0,    volIDs: LONG DESCRIPTOR FOR ARRAY OF Volume.ID ¬ NIL,    verbose: BOOLEAN ¬ NULL,    fileIDString: String ¬ NIL,    fileID: File.ID ¬ File.nullID,    filePage: File.PageNumber ¬ 0,    pvPage: DiskChannel.DiskPageNumber ¬ 0,    pageTranslation: PageSpec ¬ NULL,    logVol: CARDINAL ¬ 0,    repair: Scavenger.RepairType ¬ checkOnly,    fileSize: File.PageCount,    fileType: File.Type,    perm: BOOLEAN ¬ NULL,    fileCount: CARDINAL ¬ 0];  DiskDriveHandle: TYPE = LONG POINTER TO DiskDrive;  DiskDrive: TYPE = RECORD [    drive: DiskChannel.Drive,    deviceHandle: PilotDisk.Handle,    operation: PilotDiskFace.OperationPtr,    dataPtr: LONG POINTER TO UNSPECIFIED,    labelPtr: LONG POINTER TO PilotDisk.Label,    undoValid: BOOLEAN,    saveData: LONG POINTER TO UNSPECIFIED,    saveLabel: LONG POINTER TO UNSPECIFIED,    savePage: DiskChannel.DiskPageNumber];    Mode: TYPE = {interactive, script, exercise};    PageSpec: TYPE = {pvPage, filePage};  String: TYPE = LONG STRING;      -- Variables    diskData: DiskDriveHandle;  heap: UNCOUNTED ZONE;  nVolumes: CARDINAL;  toolData: DataHandle;  volumeDescriptor: FormSW.EnumeratedDescriptor;    -- Param window routines    FilePageToPVPage: PROC [fID: File.ID, fPage: File.PageNumber]    RETURNS [ok: BOOLEAN, page: DiskChannel.DiskPageNumber];    MakeParamSW: FormSW.ClientItemsProcType;    -- Torment window routines    MakeTSW: FormSW.ClientItemsProcType;  ValidDiskPage: PROC [page: DiskChannel.DiskPageNumber]    RETURNS[valid: BOOLEAN];    -- Scavenge window routines    MakeSSW: FormSW.ClientItemsProcType;    --File window routines    MakeFileSW: FormSW.ClientItemsProcType;    WriteFileID: PROC[h: Window.Handle, file: File.File];  -- Driver/general routines    BadCommand: PROC [s: String];  NewCommand: PROC;  Unimplemented: PROC;    END.LOG  Time:  10-Sep-81 14:38:15  By: CAJ 	 Action: Created file.  Time:   7-Dec-81 13:37:24  By: CAJ 	 Action: Converted to Trinity defs.  Time:  14-Apr-83  9:51:48  By: EKN     Action: Update To Klamath  Time:  14-Jun-84 16:35:09  By: CAJ 	 Action: Added heap.