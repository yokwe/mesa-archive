-- Copyright (C) 1984, 1985  by Xerox Corporation. All rights reserved. -- AdobeCourier.mesa - last edit by-- BJD		18-May-84 11:16:18-- RSF		26-Sep-85 17:28:37-- JCS		 9-Jan-85 10:32:26-- RLC		25-Feb-88 14:22:28DIRECTORY  AdobeOps USING [ARNumber, ARVersion, FieldList, SetOfARs],  AdobeServer USING [    ChangeList, ErrorType, FieldItemQueryValue, FieldItemValue,    StartOrStop, StringArray, Time],  Courier USING [    Arguments, Description, ErrorCode, Handle, Results, SystemElement,    VersionRange],  Environment USING [bytesPerPage],  NSFile USING [Reference],  Stream USING [Handle, InputOptions, SubSequenceType];AdobeCourier: DEFINITIONS =  BEGIN  programNumber: LONG CARDINAL = 75;  lowVersion: CARDINAL = 1;  highVersion: CARDINAL = 2;  versionRange: Courier.VersionRange = [    low: lowVersion, high: highVersion];      maxSDPageSize: CARDINAL = 50;  maxSDByteSize: CARDINAL = maxSDPageSize * Environment.bytesPerPage;  sendingInfo: Stream.SubSequenceType = 1;  streamInputOptions: Stream.InputOptions = [    TRUE, FALSE, FALSE, FALSE, FALSE, FALSE, TRUE, FALSE];  ServiceProc: TYPE = PROC [    cH: Courier.Handle, index: ProcedureType,    arguments: Courier.Arguments, results: Courier.Results];  ProcedureIndex: TYPE = CARDINAL [0..23);  ProcedureType: TYPE = MACHINE DEPENDENT{    getSubmitNumber(0), putSubmitNumber, readLastARNumber,    submitFailed, lookupARs, updateAccelerators, aboutToStore,    updateAcceleratorField, completedUpdate, getLocationOfARs,    putLocationOfARs, putVersionID, getVersion, putSystemDescription,    getSystemDescription, putSystemDefaultUser, getSystemDefaultUser,    getResidentSystemStrings, verifyVersion, putStartOrStopTime,    getStartOrStopTime, getAcceleratorInfo, makeAccelFileForField(22)};  ErrorIndex: TYPE = CARDINAL [0..ORD[LAST[AdobeServer.ErrorType]]];      LookupARsArguments: TYPE = MACHINE DEPENDENT RECORD [    systemName: LONG STRING,    version: AdobeOps.ARVersion,    fieldName: LONG STRING,    value: AdobeServer.FieldItemQueryValue,    setLength: CARDINAL,    set: AdobeOps.SetOfARs];  GetAcceleratorInfoArguments: TYPE = MACHINE DEPENDENT RECORD [    systemName: LONG STRING,    version: AdobeOps.ARVersion,    qlLength: CARDINAL,    ql: AdobeOps.SetOfARs,    fieldListLength: CARDINAL,    fieldList: LONG POINTER TO AdobeServer.StringArray];  SetOfARsRecord: TYPE = MACHINE DEPENDENT RECORD [    length: CARDINAL, set: AdobeOps.SetOfARs];  SubmitFailedArguments: TYPE = MACHINE DEPENDENT RECORD [    systemName: LONG STRING, arNumber: LONG CARDINAL,    version: AdobeOps.ARVersion];  LocationOfARs: TYPE = NSFile.Reference;  PutLocationOfARsArguments: TYPE = MACHINE DEPENDENT RECORD [    systemName: LONG STRING, loc: LocationOfARs];  PutSubmitNumberArguments: TYPE = MACHINE DEPENDENT RECORD [    systemName: LONG STRING, submitNumber: LONG CARDINAL];  PutVersionIDArguments: TYPE = MACHINE DEPENDENT RECORD [    systemName: LONG STRING, versionID: AdobeOps.ARVersion];  PutSystemDescriptionArguments: TYPE = MACHINE DEPENDENT RECORD [    systemName(0): LONG STRING,    length(2): CARDINAL,    sd(3): LONG POINTER];  VerifyVersionArguments: TYPE = MACHINE DEPENDENT RECORD [    systemName: LONG STRING, version: AdobeOps.ARVersion];  UpdateAcceleratorFieldArguments: TYPE = MACHINE DEPENDENT RECORD [    systemName: LONG STRING, arNumber: AdobeOps.ARNumber,    version: AdobeOps.ARVersion, fieldName: LONG STRING,    value: AdobeServer.FieldItemValue];  UpdateAcceleratorsArguments: TYPE = MACHINE DEPENDENT RECORD [    systemName: LONG STRING,    setLength: CARDINAL,    ars: AdobeOps.SetOfARs];  PutTimeArguments: TYPE = MACHINE DEPENDENT RECORD [    systemName(0): LONG STRING,    which(2): AdobeServer.StartOrStop,    startOrStopTime(3): AdobeServer.Time];  GetTimeArguments: TYPE = MACHINE DEPENDENT RECORD [    systemName(0): LONG STRING, which(2): AdobeServer.StartOrStop];      GetNextSubmitNumberArguments: TYPE = MACHINE DEPENDENT RECORD [    systemName(0): LONG STRING, version(2): AdobeOps.ARVersion];  UpdaterArguments: TYPE = MACHINE DEPENDENT RECORD [    systemName(0): LONG STRING, arNumber(2): AdobeOps.ARNumber,    version(4): AdobeOps.ARVersion];  ChangeLocationOfARsArguments: TYPE = MACHINE DEPENDENT RECORD [    systemName, newHost, newDirectory: LONG STRING];  ChangeFieldListArguments: TYPE = MACHINE DEPENDENT RECORD [    systemName: LONG STRING,    oldVersion: AdobeOps.ARVersion,    changeCount: CARDINAL,    changeList: AdobeServer.ChangeList];  MakeAccelFileForFieldArguments: TYPE = MACHINE DEPENDENT RECORD [    systemName: LONG STRING,    fieldName: LONG STRING,    listLength: CARDINAL,    fieldList: AdobeOps.FieldList];  -- PROCEDURES    -- From AdobeCourierClientImplA/B    translateProc: PROCEDURE [p: AdobeCourier.ProcedureType]    RETURNS [CARDINAL] = INLINE {RETURN[p.ORD]};  SignalCatcher: PROCEDURE [    server: Courier.SystemElement, proc: PROC [cH: Courier.Handle],    adobeSystem: LONG STRING];  -- From AdobeCourierUtilities  CourierToAdobeError: PROCEDURE [courierError: Courier.ErrorCode]    RETURNS [why: AdobeServer.ErrorType];  RetrieveFromCourierStream: PROCEDURE [    courierStream, destStream: Stream.Handle]    RETURNS [bytesRetrieved: CARDINAL];  SendToCourierStream: PROCEDURE [    sourceStream, courierStream: Stream.Handle];  DescribeAcceleratorInfo: Courier.Description;  DescribeARVersion: Courier.Description;  DescribeBoolean: Courier.Description;  DescribeChangeFieldListArguments: Courier.Description;  DescribeChangeLocationOfARsArguments: Courier.Description;  DescribeFieldItemObject: Courier.Description;  DescribeFieldItemValue: Courier.Description;  DescribeGetAcceleratorInfoArguments: Courier.Description;  DescribeGetTimeArguments: Courier.Description;  DescribeLocationOfARs: Courier.Description;  DescribeLookupARsArguments: Courier.Description;  DescribeMakeAccelFileForFieldArguments: Courier.Description;  DescribePutLocationOfARsArguments: Courier.Description;  DescribePutSubmitNumberArguments: Courier.Description;  DescribePutTimeArguments: Courier.Description;  DescribePutVersionIDArguments: Courier.Description;  DescribeResidentSystemStrings: Courier.Description;  DescribeSetOfARs: Courier.Description;  DescribeSubmitFailedArguments: Courier.Description;  DescribeSubmitNumber: Courier.Description;  DescribeSystemDescription: Courier.Description;  DescribeSystemName: Courier.Description;  DescribeTime: Courier.Description;  DescribeUpdateAcceleratorFieldArguments: Courier.Description;  DescribeUpdateAcceleratorsArguments: Courier.Description;  DescribeUpdaterArguments: Courier.Description;  DescribeVerifyVersionArguments: Courier.Description;  END.  -- of AdobeCourier  25-Feb-88 14:22:28 - rlc - add version 2 of protocol (for new error messages) 