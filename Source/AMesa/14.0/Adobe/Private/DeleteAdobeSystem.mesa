-- Copyright (C) 1985  by Xerox Corporation. All rights reserved. --DeleteAdobeSystem.mesa--JCS		26-Feb-85 17:43:37DIRECTORY  NSExec,  NSFile,  NSString,  TextInput;DeleteAdobeSystem: PROGRAM  IMPORTS NSExec, NSFile, NSString, TextInput =    BEGIN   S: PROC [s: LONG STRING] RETURNS [NSString.String] = INLINE {    RETURN[NSString.StringFromMesaString[s]]};    DeleteFile: NSExec.ExecProc ={       ListFile:NSFile.AttributesProc ={      filename: NSFile.String;      filename ¬ attributes.name;      NSExec.PutIndentedMessage[exec, filename]};          adobeSystemHandle, adobeFolderHandle: NSFile.Handle ¬ NSFile.nullHandle;    sessionHandle: NSFile.Session;       BEGIN ENABLE {      NSFile.Error => NSExec.PutMessage[exec, S["NSFile Error."L]];      NSExec.Error => NSExec.PutMessage[exec, S["NSExec Error."L]];      NSString.StringBoundsFault => NSExec.PutMessage[        exec, S["NSString.StringBoundsFault."L]];      NSString.InvalidString => NSExec.PutMessage[        exec, S["NSString.InvalidString."L]];      UNWIND => {	IF adobeSystemHandle # NSFile.nullHandle THEN 	  NSFile.Close[adobeSystemHandle, sessionHandle];	IF adobeFolderHandle # NSFile.nullHandle THEN	  NSFile.Close[adobeFolderHandle, sessionHandle]}};    string: LONG STRING ¬ [50];  systemName: LONG STRING ¬ [62];    text: NSString.String ¬ NSString.StringFromMesaString[string];    systemNameString: NSString.String ¬ NSString.StringFromMesaString[      systemName];    confirm: TextInput.YesOrNo ¬ TextInput.nilYesNo;    enumAllFilesScope: NSFile.Scope ¬ [filter: [matches[[name[S["*"L]]]]]];     select: NSFile.Selections;    nullHandle:NSFile.Handle = NSFile.nullHandle;    sysDir: NSFile.Handle ¬ NSExec.SystemDirectory[];    sessionHandle ¬ NSExec.SystemFilingSession[];            adobeFolderHandle ¬ NSFile.OpenByName[      directory: sysDir, path: S["AdobeFolder"L],       session: sessionHandle];    IF adobeFolderHandle # nullHandle THEN {      NSExec.PutMessage[exec, S["Adobe Systems: "L]]}    ELSE {      NSExec.PutMessage[exec, S["AdobeFolder does not exist."L]];       RETURN};    select.interpreted[name] ¬ TRUE;    NSFile.List[      directory: adobeFolderHandle, proc: ListFile, selections: select,       scope: enumAllFilesScope , session: sessionHandle];    NSExec.PutMessage[exec, S["Delete Adobe System"L]];    text ¬ TextInput.GetText[      tty: NSExec.GetTTY[exec], prompt: S["   Adobe System"L], text: text,      maxLength: text.maxlength];    IF text.length > 0 THEN {      confirm ¬ TextInput.GetYesNo[        tty: NSExec.GetTTY[exec], prompt: S["Confirm"L]];      IF confirm = yes THEN {	systemNameString ¬ NSString.AppendString[	  systemNameString, S["AdobeFolder/"L]];        systemNameString ¬ NSString.AppendString[	  to: systemNameString, from:text];	adobeSystemHandle ¬ NSFile.OpenByName[          directory: sysDir, path: systemNameString, session: sessionHandle];	IF adobeSystemHandle # nullHandle THEN {	  NSFile.Delete[adobeSystemHandle, sessionHandle];          NSExec.PutMessage[exec, S["Done."L]]}	ELSE {	  NSExec.PutMessage[exec, S["Adobe System does not exist."L]]	  }}}    END;    IF adobeFolderHandle # NSFile.nullHandle THEN      NSFile.Close[adobeFolderHandle, sessionHandle];    };     Init: PROCEDURE = {   NSExec.AddExecCommand[     command:[name: S["DeleteAdobeSystem"L], proc:DeleteFile]]};      --main line code  Init[];  END. -- of DeleteAdobeSystem