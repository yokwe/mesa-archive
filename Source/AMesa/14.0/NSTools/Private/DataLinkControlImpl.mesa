-- File: DataLinkControlImpl.mesa - last edit:-- AOF                 25-Jul-88 14:40:57-- Copyright (C) 1988 by Xerox Corporation. All rights reserved.DIRECTORY  Buffer USING [DeviceType],  DataLinkControl USING [],  Driver USING [Device, GetDeviceChain]; DataLinkControlImpl: PROGRAM  IMPORTS Driver  EXPORTS Buffer, DataLinkControl =  BEGIN  Device: PUBLIC <<Buffer>> TYPE = Driver.Device;  AdjustInputQueueLength: PUBLIC <<DataLinkControl>> PROC[    medium: Buffer.DeviceType, lineNumber, length: CARDINAL]    RETURNS[done: BOOLEAN] =    BEGIN    IF medium # ethernet THEN RETURN[FALSE];    FOR device: Device ¬ Driver.GetDeviceChain[], device.next      UNTIL device = NIL DO      IF (device.device = ethernet) AND (device.lineNumber = lineNumber) THEN        BEGIN	action: {up, down};	IF (length < 6) THEN {action ¬ down; length ¬ 1}  --that's shutting down	ELSE {action ¬ up; length ¬ MIN[length, 15]};  --don't run over a page	IF action = down THEN device.changeNumberOfInputBuffers[FALSE];	device.deactivateDriver[];  --slow him up somewhat	device.buffers ¬ length;  --make him "different"	device.activateDriver[];  --wake him back up	IF action = up THEN device.changeNumberOfInputBuffers[TRUE];	EXIT;	END;      ENDLOOP;    END;  --AdjustInputQueueLength  AdjustOutputQueueLength: PUBLIC <<DataLinkControl>> PROC[    medium: Buffer.DeviceType, lineNumber, length: CARDINAL]    RETURNS[done: BOOLEAN] =    BEGIN    RETURN[FALSE];  --not this time    END;  --AdjustOutputQueueLength      END....  LOG25-Jul-88 10:53:24  AOF  Created  