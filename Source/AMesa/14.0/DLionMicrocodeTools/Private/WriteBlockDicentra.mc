{ WriteBlockDicentra.mc, HGM, 26-May-83 15:59:32 Description: Write CP Memory Block overlay, Author: PXJ   , Created: 26 Sept 1979, Last Edited: PXJ   , February 6, 1980  9:05 AM}Reserve[0, Sub[KBufferExtenLoc, 1]];Reserve[Add[KBufferExtenEnd, 1], Sub[KBufferLoc, 1]];Reserve[Add[KBufferEnd, 1], 0FFF];{  WriteCPMemoryBlock	}{IOP sets up uKAddr, uKCount, and RHrK with KWriteU.  IOP must be careful to load the high word of the address last because KWriteUReg writes the low order byte of the U register into RHrK as a side effect.  The IOP then sends 2*count bytes of data.}KBuffer:	rK¬ 0C0, GOTOABS[GetIOPByteLoc],		c1, at[KBufferLoc];		rK¬ rK LRot8,					c3, at[Add[0C, GetIOPByteLoc]];		UKernMD¬ rK,					c1;		rK¬ 0A0, GOTOABS[GetIOPByteLoc],		c2;		rK¬ rK or UKernMD,				c3, at[Add[0A, GetIOPByteLoc]];				UKernMD¬ rK,					c1;		Noop,						c2;		rK¬ uKAddr,					c3;				MAR¬ [RHrK, rK+0], RawRef,			c1;		MDR¬ UKernMD,					c2;		rK¬ rK+1, CarryBr,				c3;				uKAddr¬ rK, BRANCH[$, BankCrossed],		c1;		rK¬ RHrK,					c2;MoreB4:		RHrK¬ rK LRot0,					c3;		rK¬ uKCount,					c1;		rK¬ rK-1, ZeroBr,				c2;MoreBlock:	uKCount¬ rK, BRANCH[KBuffer, DoneBlock],	c3;DoneBlock:	rK¬ 0, GOTOABS[KWaitLoc],			c1;BankCrossed:	rK¬ RHrK{+1},					c2; 		rK¬ rK+1, GOTO[MoreB4],				c*;