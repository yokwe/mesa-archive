-- Copyright (C) 1983  by Xerox Corporation. All rights reserved. -- IOPSymsBasic.mesa, HGM,  8-Jan-83 11:54:34DIRECTORY  String USING [AppendString, Equivalent],  IOP USING [Register, RegPair],  IOPSyms USING [Symbol];IOPSymsBasic: PROGRAM  IMPORTS String  EXPORTS IOPSyms =  BEGIN  LookUpInRegTable: PUBLIC PROCEDURE [s: LONG STRING]    RETURNS [ok: BOOLEAN, value: IOPSyms.Symbol] =    BEGIN    SELECT TRUE FROM      String.Equivalent[s, "B"L] => RETURN[TRUE, [reg[b]]];      String.Equivalent[s, "C"L] => RETURN[TRUE, [reg[c]]];      String.Equivalent[s, "D"L] => RETURN[TRUE, [reg[d]]];      String.Equivalent[s, "E"L] => RETURN[TRUE, [reg[e]]];      String.Equivalent[s, "H"L] => RETURN[TRUE, [reg[h]]];      String.Equivalent[s, "L"L] => RETURN[TRUE, [reg[l]]];      String.Equivalent[s, "M"L] => RETURN[TRUE, [reg[m]]];      String.Equivalent[s, "A"L] => RETURN[TRUE, [reg[a]]];      String.Equivalent[s, "PCH"L] => RETURN[TRUE, [reg[pcH]]];      String.Equivalent[s, "PCL"L] => RETURN[TRUE, [reg[pcL]]];      String.Equivalent[s, "SPH"L] => RETURN[TRUE, [reg[spH]]];      String.Equivalent[s, "SPL"L] => RETURN[TRUE, [reg[spL]]];      String.Equivalent[s, "Flags"L] => RETURN[TRUE, [reg[flags]]];      String.Equivalent[s, "RIM"L] => RETURN[TRUE, [reg[rim]]];      String.Equivalent[s, "BC"L] => RETURN[TRUE, [pair[bc]]];      String.Equivalent[s, "DE"L] => RETURN[TRUE, [pair[de]]];      String.Equivalent[s, "HL"L] => RETURN[TRUE, [pair[hl]]];      String.Equivalent[s, "SP"L] => RETURN[TRUE, [pair[sp]]];      String.Equivalent[s, "PSW"L] => RETURN[TRUE, [pair[psw]]];      String.Equivalent[s, "PC"L] => RETURN[TRUE, [pair[pc]]];      ENDCASE => RETURN[FALSE, ];    END;  AppendRegister: PUBLIC PROCEDURE [s: LONG STRING, reg: IOP.Register] =    BEGIN    String.AppendString[s,      SELECT reg FROM	b => "B"L,	c => "C"L,	d => "D"L,	e => "E"L,	h => "H"L,	l => "L"L,	m => "M"L,	a => "A"L,	pcH => "PCH"L,	pcL => "PCL"L,	spH => "SPH"L,	spL => "SPL"L,	flags => "Flags"L,	rim => "RIM"L,	ENDCASE => ERROR];    END;      AppendRegPair: PUBLIC PROCEDURE [s: LONG STRING, reg: IOP.RegPair] =    BEGIN    String.AppendString[s,      SELECT reg FROM	bc => "BC"L,	de => "DE"L,	hl => "HL"L,	sp => "SP"L,	psw => "PSW"L,	pc => "PC"L,	ENDCASE => ERROR];    END;  END.    