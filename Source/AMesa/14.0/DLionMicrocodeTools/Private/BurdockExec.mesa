-- Copyright (C) 1983  by Xerox Corporation. All rights reserved. -- BurdockExec.mesa, HGM, 23-Oct-83 18:15:04DIRECTORY  Exec USING [AddCommand, CheckForAbort, ExecProc, FreeTokenString, GetToken, OutputProc],  Put USING [CR, Line],  Runtime USING [GetBcdTime],  String USING [AppendLongDecimal, AppendString],  Time USING [Append, Unpack],  CommandFile USING [CommandsFromFile, Error];BurdockExec: MONITOR  IMPORTS    Exec, Put, Runtime, String, Time,    CommandFile =  BEGIN    Burdock: Exec.ExecProc =    BEGIN ENABLE CommandFile.Error =>      BEGIN      temp: STRING = [100];      String.AppendString[temp, "Error in command file at position "L];      String.AppendLongDecimal[temp, position];      String.AppendString[temp, ": "L];      String.AppendString[temp, reason];      Exec.OutputProc[h][temp];      outcome ¬ error;      CONTINUE;      END;    Abort: PROCEDURE RETURNS [BOOLEAN] = BEGIN RETURN[Exec.CheckForAbort[h]]; END;    token, switches: LONG STRING;    DO      [token, switches] ¬ Exec.GetToken[h];      switches ¬ Exec.FreeTokenString[switches];      IF token = NIL THEN EXIT;      CommandFile.CommandsFromFile[Exec.OutputProc[h], h, Abort, token !        UNWIND => token ¬ Exec.FreeTokenString[token]];      token ¬ Exec.FreeTokenString[token];      ENDLOOP;    END;  Initialize: PROCEDURE =    BEGIN    herald: STRING = [100];    String.AppendString[herald, "Welcome to Burdock of "L];    Time.Append[herald, Time.Unpack[Runtime.GetBcdTime[]]];    Put.CR[NIL];    Put.Line[NIL, herald];    Exec.AddCommand["Burdock"L, Burdock];    END;    Initialize[];  END.