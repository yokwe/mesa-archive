-- Copyright (C) 1982, 1983, 1984  by Xerox Corporation. All rights reserved. -- File: TmFile.mesa -- Last edit: DEG      26-Sep-84 20:44:12-- Last edit: JAC    27-Jan-84 16:32:27-- Last edit: ETN   16-Jul-82 11:12:51DIRECTORY  Exec USING [Outcome],  MFile USING [Handle],  MSegment USING [Handle],  Stream USING [Handle];TmFile: DEFINITIONS =  BEGIN  -- Constants  fileNameMaxlenght: CARDINAL = 32;  maxNumFiles: CARDINAL = 32;    -- Variables  aFlagSet: BOOLEAN;  currentFile: LONG STRING;  defsFilesCnt: CARDINAL [0..maxNumFiles);  defsFileNames: ARRAY [0..maxNumFiles) OF LONG STRING;  ebStream: Stream.Handle;  erStream: Stream.Handle;  fbFileSize: LONG CARDINAL;  fbInStream: Stream.Handle;  fbOutStream: Stream.Handle;  fbSeg: MSegment.Handle;    fImc: CARDINAL [0..maxNumFiles);  ftStream: Stream.Handle;  importsOnly: PACKED ARRAY [0..maxNumFiles) OF BOOLEAN;  mlStream: Stream.Handle;  outFile: LONG STRING;  passTwoOnly: PACKED ARRAY [0..maxNumFiles) OF BOOLEAN;  PassFileHandle: MFile.Handle;  siPrologLength: CARDINAL;  siStream: Stream.Handle;  sourceFilesCnt: CARDINAL [0..maxNumFiles);  sourceFileNames: ARRAY [0..maxNumFiles) OF LONG STRING;  StmtFileHandle: MFile.Handle;  stStream: Stream.Handle;  -- Procedures  CloseStream: PROCEDURE [sh: Stream.Handle] RETURNS [nilSh: Stream.Handle ¬ NIL];  CreateLogFile: PROCEDURE;  DeleteSegment: PROCEDURE[sh: MSegment.Handle] RETURNS [nilsh: MSegment.Handle ¬ NIL];  DeleteSIs: PROCEDURE;  Finish: PROCEDURE [outcome: Exec.Outcome];  InitBackupFile: PROCEDURE;  LogErrAndSrcLines: PROCEDURE [str: LONG STRING];  LogErrArgAndSrcLines: PROCEDURE [str1, str2: LONG STRING];  LogErrAndSrcLinesBadChar: PROCEDURE [char: CHARACTER];  LogErrLine: PROCEDURE [str: LONG STRING];  LogErrLine2: PROCEDURE [str1, str2: LONG STRING];  LogErrText: PROCEDURE [str: LONG STRING];  LogErrText2: PROCEDURE [str1, str2: LONG STRING];  LogLine: PROCEDURE [str: LONG STRING];  LogText: PROCEDURE [str: LONG STRING];  LogText2: PROCEDURE [str1, str2: LONG STRING];  OpenFbOut: PROCEDURE;  OpenFbSort: PROCEDURE RETURNS [p: LONG POINTER];  OpenFt: PROCEDURE;  OpenNextDf: PROCEDURE RETURNS [thru: BOOLEAN ¬ FALSE];  OpenNextEb: PROCEDURE RETURNS [thru: BOOLEAN ¬ FALSE];  OpenNextFb: PROCEDURE RETURNS [thru: BOOLEAN ¬ FALSE];  OpenNextMc: PROCEDURE RETURNS [thru: BOOLEAN ¬ FALSE];  OpenNextMl: PROCEDURE RETURNS [thru: BOOLEAN ¬ FALSE];  OpenNextSi: PROCEDURE RETURNS [thru: BOOLEAN ¬ FALSE];  OpenStFile: PROCEDURE;  PutHex: PROCEDURE [sh: Stream.Handle, c: CARDINAL];  ReplaceExt: PROCEDURE [name, ext: LONG STRING] RETURNS [LONG STRING];  END...    -- Log  -- 16-Jul-82 11:12:45 - ETN        - TrinityMass Version 1  --  1-Nov-82 13:54:36 - ETN        - Change OpenFbSort for fb Trunc fix  --  3-Aug-83 14:53:15 - JAC        - Add file handles for file to back up pass and stmt segments  -- 12-Aug-83 10:29:49 - JAC        - Eliminate an unused version count  -- 17-Aug-83 12:52:44 - JAC        - Add parameter to Finish and add segment handle for fb sort  -- 27-Jan-84 16:37:02 - JAC        - Add proc to delete .si's  -- Time: 26-Sep-84 20:44:08	By: DEG     	Action: Added copyright notice and rebuild for 11.1 release.