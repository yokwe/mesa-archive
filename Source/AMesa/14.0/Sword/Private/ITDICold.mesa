-- Copyright (C) 1985  by Xerox Corporation. All rights reserved. -- DICold.mesaDIRECTORYComData,IO, IQ, IR, IT,Symbols,Tree;ITDICold: PROGRAM   IMPORTS ComData, IQ, IR  EXPORTS IR = {Relation: PUBLIC PROC[h: IT.Handle, lhs, rhs: IT.Foo, relation: Tree.NodeName] = {  resultIsTrue: BOOLEAN;    pointerToLhsValue: LONG POINTER ¬ lhs.addr.base;  pointerToRhsValue: LONG POINTER ¬ rhs.addr.base;    lhsSize: CARDINAL ¬ lhs.words + (IF lhs.bits = 0 THEN 0 ELSE 1);  rhsSize: CARDINAL ¬ rhs.words + (IF rhs.bits = 0 THEN 0 ELSE 1);  IF lhsSize # rhsSize THEN ERROR;    IF pointerToLhsValue = NIL OR pointerToRhsValue = NIL THEN ERROR;    resultIsTrue ¬ SELECT relation FROM	relE => EqualP[pointerToLhsValue, pointerToRhsValue, lhsSize],	relN => ~EqualP[pointerToLhsValue, pointerToRhsValue, lhsSize],	relL => LessP[h, pointerToLhsValue, pointerToRhsValue, lhsSize],	relLE => LessP[h, pointerToLhsValue, pointerToRhsValue, lhsSize] OR	  EqualP[pointerToLhsValue, pointerToRhsValue, lhsSize],	relG => ~LessP[h, pointerToLhsValue, pointerToRhsValue, lhsSize] AND	  ~EqualP[pointerToLhsValue, pointerToRhsValue, lhsSize],	relGE => ~LessP[h, pointerToLhsValue, pointerToRhsValue, lhsSize]	ENDCASE => ERROR;	  lhs.addr.base­ ¬ resultIsTrue;   lhs.constant ¬ TRUE;  lhs.hti ¬ Symbols.HTNull;  lhs.there ¬ FALSE;  lhs.tsei ¬ ComData.typeBOOL;  lhs.words ¬ 1;  lhs.bits ¬ 0;  IR.Push[h, lhs];  };EqualP: PROC[lhs, rhs: LONG POINTER, size: CARDINAL]   RETURNS[BOOLEAN] = {  FOR i: CARDINAL IN [0..size) DO    IF (LOOPHOLE[lhs + i, LONG POINTER TO UNSPECIFIED])­ #     (LOOPHOLE[rhs + i, LONG POINTER TO UNSPECIFIED])­ THEN RETURN[FALSE];  ENDLOOP;  RETURN[TRUE];  }; -- end EqualPLessP: PROC[h: IT.Handle, lhs, rhs: LONG POINTER, size: CARDINAL]   RETURNS[BOOLEAN] = {  SELECT TRUE FROM  size = 1 => RETURN[(lhs)­ < (rhs)­];  size = 2 => RETURN[    LOOPHOLE[lhs, LONG POINTER TO LONG UNSPECIFIED]­ <     LOOPHOLE[rhs, LONG POINTER TO LONG UNSPECIFIED]­]  ENDCASE => IQ.BPAbortWithWrittenError[h, invalidRelation];  RETURN[FALSE];  }; -- end LessP}..