-- Copyright (C) 1981, 1982, 1983, 1984  by Xerox Corporation. All rights reserved. -- MFTPUtilities.mesa; -- edited by BXM  , 21-Jan-81 11:14:29 -- edited by RXJ     , November 3, 1980  10:51 AM -- edited by LXR    ,  17-Feb-82 15:37:43-- edited by RXR   , 22-Oct-81 10:32:46-- edited by RSF      , 18-Aug-83 17:57:53-- edited by MEW   , 31-Aug-84 15:20:31  DIRECTORY  Date USING [StringToPacked, Unintelligible],  Format USING [StringProc],  MFTPDefs USING [Handle, PackedTime],  Time USING [Append, Unpack];MFTPUtilities: PROGRAM IMPORTS Date, Time EXPORTS MFTPDefs =  BEGIN  PackedTime: TYPE = MFTPDefs.PackedTime;  Handle: TYPE = MFTPDefs.Handle;  WriteTime: PUBLIC PROCEDURE [h: Handle, t: PackedTime, brackets: BOOLEAN ¬ FALSE] =    BEGIN    s: STRING ¬ [24];    Time.Append[s, Time.Unpack[LOOPHOLE[t]], TRUE];    IF brackets THEN h.write["["];    h.write[s];    IF brackets THEN h.write["]"L];    RETURN    END;  ParseTime: PUBLIC PROCEDURE [s: LONG STRING] RETURNS [BOOLEAN, PackedTime] =    BEGIN    -- parse day-mo-yr hr:min:sec    dt: PackedTime;    [dt: dt] ¬ Date.StringToPacked[s ! Date.Unintelligible => GOTO notfound];    RETURN[TRUE, dt]    EXITS notfound => RETURN[FALSE, 0]    END;  IsSwitch: PUBLIC PROCEDURE [c: CHARACTER, switches: LONG STRING] RETURNS [BOOLEAN] =    -- c is always lower case by convention    -- switches are always lower case (see ReadCmdString)    BEGIN    i: CARDINAL;    IF switches = NIL THEN RETURN[FALSE];    FOR i IN [0..switches.length) DO      IF c = switches[i] THEN RETURN[TRUE]; ENDLOOP;    RETURN[FALSE]    END;  END...