-- File: ListerDefs.mesa - last edit:-- JBD                  3-Mar-87 16:39:48-- RXR                 28-Sep-82  9:26:26-- BTL                 20-Nov-81  9:36:20-- LXR                 21-Aug-81 13:28:38-- BXM                  6-Jan-81 16:44:13-- Copyright (C) 1981, 1982, 1987 by Xerox Corporation. All rights reserved. DIRECTORY  BcdDefs USING [MTIndex, VersionStamp],  BcdOps USING [BcdBase],  CommandUtil USING [PairList],  Environment USING [PageCount, PageNumber],  Exec USING [Outcome],  Format USING [DateFormat, NumberFormat, StringProc],  MStream USING [Handle],  String USING [SubString],  Symbols USING [HTIndex, ISEIndex],  SymbolTable USING [Handle];ListerDefs: DEFINITIONS =  BEGIN  <<  All clients of ListerDefs must be registered and called via AddCommand.  Clients own no CommandUtil objects and should not free them.  Clients may call the load routines to access object file data.  Object files are released automatically when the client returns.  However, clients which read multiple symbol files should use ReleaseSymbols.  Likewise, clients which read multiple bcd files should use ReleaseBcd.  Only one output file and input file list can be open at a time.  Clients need not the output file or input file list.  >>  -- Lister commands    ListerProc: TYPE = PROC [      argList, resultList: CommandUtil.PairList, switches: LONG STRING]    RETURNS[outcome: Exec.Outcome ¬ normal];  HelpProc: TYPE = PROC [writeProc: Format.StringProc, verbose: BOOLEAN ¬ FALSE]     RETURNS[outcome: Exec.Outcome ¬ normal];    AddCommand: PROC [name: LONG STRING, proc: ListerProc, help: HelpProc ¬ NIL];  RemoveCommand: PROC [name: LONG STRING];  LookupCommand: PROC [command: LONG STRING]    RETURNS [      name: LONG STRING ¬ NIL, proc: ListerProc ¬ NIL, help: HelpProc ¬ NIL,      didExpand: BOOLEAN ¬ FALSE];    EnumerateCommands: PROC [    userProc: PROC [name: LONG STRING, proc: ListerProc, hProc: HelpProc]       RETURNS [stop: BOOLEAN]];  -- Locking    LockLister: PROC RETURNS [locked: BOOLEAN];  ReleaseLister: PROC;   -- Bcd, code and symbols file input  IncorrectVersion: SIGNAL[name: LONG STRING,    expected, found: BcdDefs.VersionStamp];  NotABcd, NoCode, NoSymbols, NoFGT, MultipleModules, FileUnavailable,    FileNotFound: SIGNAL[name: LONG STRING];    LoadFlags: TYPE = RECORD[getBcd, getSyms, getCode: BOOLEAN];  bcdOnly: LoadFlags = [TRUE, FALSE, FALSE];  symbolsOnly: LoadFlags = [FALSE, TRUE, FALSE];  noCode: LoadFlags = [TRUE, TRUE, FALSE];  all: LoadFlags = [TRUE, TRUE, TRUE];  Load: PROC [root: LONG STRING, flags: LoadFlags ¬ bcdOnly]    RETURNS [bcd: BcdOps.BcdBase, sH: SymbolTable.Handle, code: LONG POINTER];      LoadFromConfig: PROC [root, module: LONG STRING, flags: LoadFlags ¬ bcdOnly]    RETURNS [bcd: BcdOps.BcdBase, sH: SymbolTable.Handle, code: LONG POINTER,      mti: BcdDefs.MTIndex];      LoadBcdSegment: PROC [root: LONG STRING, base: Environment.PageNumber,    pages: Environment.PageCount]    RETURNS [bcd: BcdOps.BcdBase];      LoadSymSegment: PROC [root: LONG STRING, base: Environment.PageNumber,    pages: Environment.PageCount]    RETURNS [sH: SymbolTable.Handle];      ReleaseSymbols: PROC [sH: SymbolTable.Handle];  ReleaseBcd: PROC [bcd: BcdOps.BcdBase];  -- File list management  OpenFileList: PROC [fileName: LONG STRING];   -- OpenFileList can raise FileUnavailable, FileNotFound  NextNameInList: PROC RETURNS [LONG STRING];  -- Client does not own the string  -- NextNameInList raises BadFileList upon a parsing error  BadFileList: SIGNAL [position: LONG CARDINAL];  -- Output to Exec window    write: Format.StringProc;     -- Output to files    -- Use out to usurp OpenOutput, CloseOutput  out: MStream.Handle;    OpenOutput: PROC [name, ext: LONG STRING];  CloseOutput: PROC;  -- Use SetPutProc, ResetPutProc to temporarily change file output routines  SetPutProc: PROC[new: Format.StringProc];  ResetPutProc: PROC;    Put: Format.StringProc;  PutLine: PROC [s: LONG STRING];  PutSubString: PROC [ss: String.SubString];  PutCR: PROC;  PutChar: PROC [c: CHARACTER];  PutVersionTime: PROC [date: BcdDefs.VersionStamp, format: Format.DateFormat];  PutDecimal: PROC [n: INTEGER];  PutNumber: PROC [n: UNSPECIFIED, format: Format.NumberFormat];  PutLongNumber: PROC [n: LONG UNSPECIFIED, format: Format.NumberFormat];  PutOctal: PROC [o: UNSPECIFIED];  PutBlanks: PROC [n: CARDINAL];  PutIndent: PROC [n: CARDINAL];    PutHti: PROC [sH: SymbolTable.Handle, hti: Symbols.HTIndex];  PutSei: PROC [sH: SymbolTable.Handle, sei: Symbols.ISEIndex];  PutMachine: PROC [stamp: BcdDefs.VersionStamp];  PutBcdID: PROC[bcd: BcdOps.BcdBase];  PutSelf: PROC[bcd: BcdOps.BcdBase]; -- puts name of files opened via ListerDefs  PutVersions: PROC [    version, creator, source: LONG POINTER TO BcdDefs.VersionStamp ¬ NIL];   END...