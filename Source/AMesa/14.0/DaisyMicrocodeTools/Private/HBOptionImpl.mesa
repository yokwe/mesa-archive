-- Copyright (C) 1984, 1985 by Xerox Corporation. All rights reserved. -- HBOptionImpl.mesa-- Create by FormSWLayoutTool on 16-Nov-84 11:10-- Last edited by -- RDH      	15-Jan-85 16:37:21 Run FixArrows.DIRECTORY  FormSW,  Heap,  HBIO,  Put,  Tool,  ToolWindow,  Window;HBOptionImpl: PROGRAM  IMPORTS    FormSW, Heap, HBIO, Put, Tool, ToolWindow  EXPORTS    HBIO = {  DataHandle: TYPE = LONG POINTER TO Data;  Data: TYPE = MACHINE DEPENDENT RECORD [    msgSW(0): Window.Handle ¬ NIL,    formSW(2): Window.Handle ¬ NIL];  FormItems: TYPE = {apply, abort, load, save, fileName, parameterOptions,    iopAddrParam, iStParam, arbParam, iOPDataParam, nWaitParam, iOPWCParam,    cSNIAParam, bSParam, cSWCParam, displayOptions, iOPAddrDisp, iOPStDisp,    arbDisp, iOPDataDisp, nWaitDisp, iOPWCDisp, cSNIADisp, bSDisp, cSWCDisp};  data: DataHandle ¬ NIL;  opwh: PUBLIC Window.Handle ¬ NIL;  locSW: HBIO.SwitchHandle ¬ NIL;  zone: UNCOUNTED ZONE ¬ Heap.systemZone;  Abort:  FormSW.ProcType = {    [] ¬ ToolWindow.Deactivate[opwh]};  Load:  FormSW.ProcType = {    Put.Line[data.msgSW, "Load called"L];    };  Save:  FormSW.ProcType = {    Put.Line[data.msgSW, "Save called"L]};  OpenOpWindow: PUBLIC PROCEDURE = {    ToolWindow.Activate[opwh];    locSW.iopAddrParam ¬ HBIO.globSW.iopAddrParam;    locSW.iStParam ¬ HBIO.globSW.iStParam;    locSW.arbParam ¬ HBIO.globSW.arbParam;    locSW.iOPDataParam ¬ HBIO.globSW.iOPDataParam;    locSW.nWaitParam ¬ HBIO.globSW.nWaitParam;    locSW.iOPWCParam ¬ HBIO.globSW.iOPWCParam;    locSW.cSNIAParam ¬ HBIO.globSW.cSNIAParam;    locSW.bSParam ¬ HBIO.globSW.bSParam;    locSW.cSWCParam ¬ HBIO.globSW.cSWCParam;    locSW.iOPAddrDisp ¬ HBIO.globSW.iOPAddrDisp;    locSW.iOPStDisp ¬ HBIO.globSW.iOPStDisp;    locSW.arbDisp ¬ HBIO.globSW.arbDisp;    locSW.iOPDataDisp ¬ HBIO.globSW.iOPDataDisp;    locSW.nWaitDisp ¬ HBIO.globSW.nWaitDisp;    locSW.iOPWCDisp ¬ HBIO.globSW.iOPWCDisp;    locSW.cSNIADisp ¬ HBIO.globSW.cSNIADisp;    locSW.bSDisp ¬ HBIO.globSW.bSDisp;    locSW.cSWCDisp ¬ HBIO.globSW.cSWCDisp;    FormSW.DisplayItem[data.formSW, ORD[FormItems.fileName]];    FormSW.DisplayItem[data.formSW, ORD[FormItems.iopAddrParam]];    FormSW.DisplayItem[data.formSW, ORD[FormItems.iStParam]];    FormSW.DisplayItem[data.formSW, ORD[FormItems.arbParam]];    FormSW.DisplayItem[data.formSW, ORD[FormItems.iOPDataParam]];    FormSW.DisplayItem[data.formSW, ORD[FormItems.nWaitParam]];    FormSW.DisplayItem[data.formSW, ORD[FormItems.iOPWCParam]];    FormSW.DisplayItem[data.formSW, ORD[FormItems.cSNIAParam]];    FormSW.DisplayItem[data.formSW, ORD[FormItems.bSParam]];    FormSW.DisplayItem[data.formSW, ORD[FormItems.cSWCParam]];    FormSW.DisplayItem[data.formSW, ORD[FormItems.iOPAddrDisp]];    FormSW.DisplayItem[data.formSW, ORD[FormItems.iOPStDisp]];    FormSW.DisplayItem[data.formSW, ORD[FormItems.arbDisp]];    FormSW.DisplayItem[data.formSW, ORD[FormItems.iOPDataDisp]];    FormSW.DisplayItem[data.formSW, ORD[FormItems.nWaitDisp]];    FormSW.DisplayItem[data.formSW, ORD[FormItems.iOPWCDisp]];    FormSW.DisplayItem[data.formSW, ORD[FormItems.cSNIADisp]];    FormSW.DisplayItem[data.formSW, ORD[FormItems.bSDisp]];    FormSW.DisplayItem[data.formSW, ORD[FormItems.cSWCDisp]]};     Apply:  FormSW.ProcType = {    HBIO.globSW.iopAddrParam ¬ locSW.iopAddrParam;    HBIO.globSW.iStParam ¬ locSW.iStParam;    HBIO.globSW.arbParam ¬ locSW.arbParam;    HBIO.globSW.iOPDataParam ¬ locSW.iOPDataParam;    HBIO.globSW.nWaitParam ¬ locSW.nWaitParam;    HBIO.globSW.iOPWCParam ¬ locSW.iOPWCParam;    HBIO.globSW.cSNIAParam ¬ locSW.cSNIAParam;    HBIO.globSW.bSParam ¬ locSW.bSParam;    HBIO.globSW.cSWCParam ¬ locSW.cSWCParam;    HBIO.globSW.iOPAddrDisp ¬ locSW.iOPAddrDisp;    HBIO.globSW.iOPStDisp ¬ locSW.iOPStDisp;    HBIO.globSW.arbDisp ¬ locSW.arbDisp;    HBIO.globSW.iOPDataDisp ¬ locSW.iOPDataDisp;    HBIO.globSW.nWaitDisp ¬ locSW.nWaitDisp;    HBIO.globSW.iOPWCDisp ¬ locSW.iOPWCDisp;    HBIO.globSW.cSNIADisp ¬ locSW.cSNIADisp;    HBIO.globSW.bSDisp ¬ locSW.bSDisp;    HBIO.globSW.cSWCDisp ¬ locSW.cSWCDisp;    [] ¬ ToolWindow.Deactivate[opwh]};  OptionNew: PUBLIC PROCEDURE = {    IF locSW = NIL THEN locSW ¬ zone.NEW[HBIO.Switches ¬ []]};  OptionFree: PUBLIC PROCEDURE = {    zone.FREE[@locSW.fileName];    IF locSW # NIL THEN zone.FREE[@locSW]};      ClientTransition: ToolWindow.TransitionProcType = {    SELECT TRUE FROM      old = inactive => {        IF data = NIL THEN data ¬ zone.NEW[Data ¬ []]};      new = inactive => {        IF data # NIL THEN zone.FREE[@data]};      ENDCASE;    };  OptionInit: PUBLIC PROCEDURE = {    Box: ToolWindow.Box ¬ [[512,30],[512,240]];    OptionNew[];    opwh ¬ Tool.Create[      makeSWsProc: MakeSWs, initialState: inactive, initialBox: Box,      clientTransition: ClientTransition, name: "HBOption"L,      cmSection: "HBOption"L];    };    MakeSWs: Tool.MakeSWsProc = {    data.msgSW ¬ Tool.MakeMsgSW[window: window];    data.formSW ¬ Tool.MakeFormSW[      window: window, formProc: MakeForm];    };  MakeForm: FormSW.ClientItemsProcType = {    OPEN FormSW;    nItems: CARDINAL = FormItems.LAST.ORD + 1;    iopAddrParam: ARRAY[0..2) OF Enumerated ¬ [      ["Binary"L, 0], ["Hex"L, 1]];    iStParam: ARRAY[0..2) OF Enumerated ¬ [      ["Binary"L, 0], ["Hex"L, 1]];    arbParam: ARRAY[0..2) OF Enumerated ¬ [      ["Binary"L, 0], ["Hex"L, 1]];    iOPDataParam: ARRAY[0..2) OF Enumerated ¬ [      ["Binary"L, 0], ["Hex"L, 1]];    nWaitParam: ARRAY[0..2) OF Enumerated ¬ [      ["Binary"L, 0], ["Hex"L, 1]];    iOPWCParam: ARRAY[0..2) OF Enumerated ¬ [      ["Binary"L, 0], ["Hex"L, 1]];    cSNIAParam: ARRAY[0..2) OF Enumerated ¬ [      ["Binary"L, 0], ["Hex"L, 1]];    bSParam: ARRAY[0..2) OF Enumerated ¬ [      ["Binary"L, 0], ["Hex"L, 1]];    cSWCParam: ARRAY[0..2) OF Enumerated ¬ [      ["Binary"L, 0], ["Hex"L, 1]];    iOPAddrDisp: ARRAY[0..2) OF Enumerated ¬ [      ["Binary"L, 0], ["Hex"L, 1]];    iOPStDisp: ARRAY[0..2) OF Enumerated ¬ [      ["Binary"L, 0], ["Hex"L, 1]];    arbDisp: ARRAY[0..2) OF Enumerated ¬ [      ["Binary"L, 0], ["Hex"L, 1]];    iOPDataDisp: ARRAY[0..2) OF Enumerated ¬ [      ["Binary"L, 0], ["Hex"L, 1]];    nWaitDisp: ARRAY[0..2) OF Enumerated ¬ [      ["Binary"L, 0], ["Hex"L, 1]];    iOPWCDisp: ARRAY[0..2) OF Enumerated ¬ [      ["Binary"L, 0], ["Hex"L, 1]];    cSNIADisp: ARRAY[0..2) OF Enumerated ¬ [      ["Binary"L, 0], ["Hex"L, 1]];    bSDisp: ARRAY[0..2) OF Enumerated ¬ [      ["Binary"L, 0], ["Hex"L, 1]];    cSWCDisp: ARRAY[0..2) OF Enumerated ¬ [      ["Binary"L, 0], ["Hex"L, 1]];    items ¬ AllocateItemDescriptor[nItems];    items[FormItems.apply.ORD] ¬ CommandItem[      tag: "Apply"L, place: [6, line0], proc: Apply];    items[FormItems.abort.ORD] ¬ CommandItem[      tag: "Abort"L, place: [90, line0], proc: Abort];    items[FormItems.load.ORD] ¬ CommandItem[      tag: "Load"L, place: [162, line0], proc: Load];    items[FormItems.save.ORD] ¬ CommandItem[      tag: "Save"L, place: [240, line0], proc: Save];    items[FormItems.fileName.ORD] ¬ StringItem[      tag: "FileName"L, place: [324, line0], inHeap: TRUE, string: @HBIO.globSW.fileName];    items[FormItems.parameterOptions.ORD] ¬ TagOnlyItem[      tag: "---------- Parameter Options ----------"L, place: [78, line1]];    items[FormItems.iopAddrParam.ORD] ¬ EnumeratedItem[      tag: "IOP => Address"L, place: [6, line2], choices: DESCRIPTOR[iopAddrParam], value: @locSW.iopAddrParam];    items[FormItems.iStParam.ORD] ¬ EnumeratedItem[      tag: "i186Status"L, place: [162, line2], choices: DESCRIPTOR[iStParam], value: @locSW.iStParam];    items[FormItems.arbParam.ORD] ¬ EnumeratedItem[      tag: "Arbitor"L, place: [294, line2], choices: DESCRIPTOR[arbParam], value: @locSW.arbParam];    items[FormItems.iOPDataParam.ORD] ¬ EnumeratedItem[      tag: "Data"L, place: [48, line3], choices: DESCRIPTOR[iOPDataParam], value: @locSW.iOPDataParam];    items[FormItems.nWaitParam.ORD] ¬ EnumeratedItem[      tag: "NWait"L, place: [162, line3], choices: DESCRIPTOR[nWaitParam], value: @locSW.nWaitParam];    items[FormItems.iOPWCParam.ORD] ¬ EnumeratedItem[      tag: "WildCard"L, place: [294, line3], choices: DESCRIPTOR[iOPWCParam], value: @locSW.iOPWCParam];    items[FormItems.cSNIAParam.ORD] ¬ EnumeratedItem[      tag: "CS  => NIA"L, place: [6, line4], choices: DESCRIPTOR[cSNIAParam], value: @locSW.cSNIAParam];    items[FormItems.bSParam.ORD] ¬ EnumeratedItem[      tag: "BankSel"L, place: [162, line4], choices: DESCRIPTOR[bSParam], value: @locSW.bSParam];    items[FormItems.cSWCParam.ORD] ¬ EnumeratedItem[      tag: "WildCard"L, place: [294, line4], choices: DESCRIPTOR[cSWCParam], value: @locSW.cSWCParam];    items[FormItems.displayOptions.ORD] ¬ TagOnlyItem[      tag: "----------- Display Options -----------"L, place: [84, line6]];    items[FormItems.iOPAddrDisp.ORD] ¬ EnumeratedItem[      tag: "IOP => Address"L, place: [6, line7], choices: DESCRIPTOR[iOPAddrDisp], value: @locSW.iOPAddrDisp];    items[FormItems.iOPStDisp.ORD] ¬ EnumeratedItem[      tag: "i186Status"L, place: [162, line7], choices: DESCRIPTOR[iOPStDisp], value: @locSW.iOPStDisp];    items[FormItems.arbDisp.ORD] ¬ EnumeratedItem[      tag: "Arbitor"L, place: [294, line7], choices: DESCRIPTOR[arbDisp], value: @locSW.arbDisp];    items[FormItems.iOPDataDisp.ORD] ¬ EnumeratedItem[      tag: "Data"L, place: [48, line8], choices: DESCRIPTOR[iOPDataDisp], value: @locSW.iOPDataDisp];    items[FormItems.nWaitDisp.ORD] ¬ EnumeratedItem[      tag: "NWait"L, place: [162, line8], choices: DESCRIPTOR[nWaitDisp], value: @locSW.nWaitDisp];    items[FormItems.iOPWCDisp.ORD] ¬ EnumeratedItem[      tag: "WildCard"L, place: [294, line8], choices: DESCRIPTOR[iOPWCDisp], value: @locSW.iOPWCDisp];    items[FormItems.cSNIADisp.ORD] ¬ EnumeratedItem[      tag: "CS  => NIA"L, place: [6, line9], choices: DESCRIPTOR[cSNIADisp], value: @locSW.cSNIADisp];    items[FormItems.bSDisp.ORD] ¬ EnumeratedItem[      tag: "BankSel"L, place: [162, line9], choices: DESCRIPTOR[bSDisp], value: @locSW.bSDisp];    items[FormItems.cSWCDisp.ORD] ¬ EnumeratedItem[      tag: "WildCard"L, place: [294, line9], choices: DESCRIPTOR[cSWCDisp], value: @locSW.cSWCDisp];    RETURN[items: items, freeDesc: TRUE];    };  }...    