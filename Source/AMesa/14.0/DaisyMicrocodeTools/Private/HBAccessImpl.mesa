-- Copyright (C) 1985  by Xerox Corporation. All rights reserved. -- HBAccessImpl.mesa, RdH       , 21-Feb-85 15:51:43-- Last edited by --  Rick RDH      	21-Feb-85 15:51:49 Create.DIRECTORY  HBAccess;-- Control access to the history buffer.  Procedures for getting permission to access the history buffer.  There are 3 categories of access.  One can happen any time and is used for reading the status of the history buffer.  One can happen when sampling is taking place.  This is used to manually halt or to manually trigger the history buffer.  The last is used for everything else and can only happen when nothing else is going on except for reading status.HBAccessImpl: MONITOR EXPORTS HBAccess = BEGIN  busy: BOOLEAN ¬ FALSE;  -- Signifies that something is using the history buffer in a way that precludes any other use except reading status.    sampling: BOOLEAN ¬ FALSE;  -- Signifies that something is using the history buffer in a way that precludes any other use except reading status, doing a manual trigger, or doing a manual stop.    free: CONDITION;  --For clients to wait on when busy is true.  No one should wait for sampling to end since that may take a long long long time.  --$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$--  AskForSampleAccess: PUBLIC ENTRY PROC RETURNS [accessGranted: BOOLEAN ¬ TRUE]     = BEGIN    IF sampling THEN RETURN[FALSE];    WHILE busy DO WAIT free; ENDLOOP;    busy ¬ sampling ¬ TRUE;    END;--AskForSampleAccess--      --$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$--  AskForGeneralAccess: PUBLIC ENTRY PROC RETURNS [accessGranted: BOOLEAN ¬ TRUE]    = BEGIN    IF sampling THEN RETURN[FALSE];    WHILE busy DO WAIT free; ENDLOOP;    busy ¬ TRUE;    END;--AskForGeneralAccess--      --$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$--  GetLimitedAccess: PUBLIC ENTRY PROC = BEGIN    WHILE busy DO WAIT free; ENDLOOP;    busy ¬ TRUE;    END;--GetLimitedAccess--      --$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$--  TriggerDetected: PUBLIC ENTRY PROC = BEGIN    WHILE busy DO WAIT free; ENDLOOP;    busy ¬ TRUE;    sampling ¬ FALSE;    END;--TriggerDetected--      --$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$--  ReleaseHB: PUBLIC ENTRY PROC = BEGIN    busy ¬ FALSE;    BROADCAST free;    END;--ReleaseHB--      END.                           