-- Copyright (C) 1980, 1981, 1982, 1983  by Xerox Corporation. All rights reserved. -- ExecInternal.mesa;-- RXJ     	14-Dec-80 19:37:17-- BXM  	17-Jun-81 17:33:51  -- LXR    	 5-Nov-82 14:08:52 -- RES  	 3-Apr-81  8:42:31-- SXS   	 1-Mar-82 16:58:29-- RXR   	 10-Feb-83 14:00:17DIRECTORY  Exec USING [    CheckAbortProc, GetCharProc, Handle, Outcome],  Format USING [StringProc],  Queue USING [ShortQ, Q],  System USING [Switches],  TTY USING [Handle, nullHandle],  Volume USING [ID, nullID],  Window USING [Handle];ExecInternal: DEFINITIONS  IMPORTS Exec =  BEGIN  -- Types  ExecType: TYPE = {commandCentral, simple};  Object: TYPE = RECORD [    comQ, remQ, scratchQ: Queue.ShortQ ¬ NIL,    output: Format.StringProc ¬ NIL,    userFeedback: Format.StringProc ¬ NIL,    getchar:  Exec.GetCharProc ¬ NIL,    checkForAbort: Exec.CheckAbortProc ¬ NIL,    endOfCommandLine: PROCEDURE [Exec.Handle] RETURNS [BOOLEAN] ¬ NIL,    clientData: LONG POINTER TO UNSPECIFIED ¬ NIL,    temporaryTTY: BOOLEAN ¬ FALSE,    w: TTY.Handle ¬ TTY.nullHandle,    window, msgSW, formSW, logSW, optionSW: Window.Handle ¬ NIL];  clientVolume: Volume.ID;  runSwitches, volumeLabel: LONG STRING;  bootSwitches: System.Switches;  codeLinks, useBackground: BOOLEAN;  -- procedures  AddExtension: PROCEDURE [name, ext: LONG STRING];    CanLookup: PROCEDURE [name: LONG STRING] RETURNS [BOOLEAN];  CheckIfDeactivated: PROCEDURE [h: Exec.Handle] RETURNS [deactivated: BOOLEAN];  CreateExec: PROCEDURE [    tty: TTY.Handle, CheckIfDeactivated: Exec.CheckAbortProc ¬ NIL,     NoteNewLine: PROCEDURE ¬ NIL];  ExecuteFromHandle: PROCEDURE [    h: Exec.Handle, CheckIfDeactivated: PROCEDURE[h: Exec.Handle]       RETURNS [abort: BOOLEAN],    GetCommand: PROCEDURE [h: Exec.Handle] RETURNS [gotCommand: BOOLEAN]]    RETURNS [outcome: Exec.Outcome ¬ normal];  ExpandESC: PROCEDURE [toQ, remQ: Queue.ShortQ] RETURNS [nMatches: CARDINAL ¬ 0];  ForceExtension: PROCEDURE [name, ext: LONG STRING];  IsAlphaNumeric, IsntAlphaNumeric, IsCommandChar, IsFileChar: PROCEDURE [    CHARACTER] RETURNS [BOOLEAN];  LookUpUniqueFile: PROCEDURE [name, ext: LONG STRING ¬ NIL]     RETURNS [found: BOOLEAN];  RunClientPrograms: PROCEDURE [cmdLine: LONG STRING, write: Format.StringProc];  StringOverFlow: PROCEDURE [exec: Exec.Handle, s: LONG STRING]    RETURNS [dontExpand: BOOLEAN ¬ FALSE];  Twiddles: PROCEDURE [w: Exec.Handle];  Write: PROCEDURE [TTY.Handle, UNSPECIFIED];  WriteF: PROCEDURE [w: TTY.Handle, s: STRING, p1, p2, p3, p4: UNSPECIFIED ¬ 0];  WriteLine: PROCEDURE [TTY.Handle, STRING];  XferQWhile: PROCEDURE [    sourceGet: PROCEDURE [Queue.Q] RETURNS [CHARACTER],    sourcePutBack: PROCEDURE [Queue.Q, UNSPECIFIED], sourceQ: Queue.ShortQ,    destPut: PROCEDURE [Queue.Q, UNSPECIFIED], destQ: Queue.ShortQ,    test: PROCEDURE [CHARACTER] RETURNS [BOOLEAN]];  ExecsB, ExecsC, ExecsD, ExecsE, ExecsF, SimpleExec, CommandCentral: PROGRAM;  StringBoundsFault: ERROR [s: LONG STRING];  -- from XDefaults  Do: PROCEDURE [proc: PROCEDURE];  MapClientVolumeNameToID: PROCEDURE [name: LONG STRING]    RETURNS [volumeID: Volume.ID];  Log: TYPE = {none, compiler, binder};  LegalClientVolume: PROCEDURE RETURNS [BOOLEAN] = INLINE {    RETURN[clientVolume ~= Volume.nullID]};  SetDefaults: PROCEDURE;  ProcessBootSwitchList: PROCEDURE [switches: LONG STRING]    RETURNS [System.Switches];  ProcessUserCm: PROCEDURE;  BadBootSwitch: ERROR [i: CARDINAL];  StringToSearchPath: PROCEDURE [cmdLine: LONG STRING, Write: Format.StringProc] RETURNS [Exec.Outcome];    SetBuiltInCommands: PROCEDURE;  END...  