-- Copyright (C) 1983  by Xerox Corporation. All rights reserved. -- EtherBooter.mesa, RXJ     , 11-Jul-83 16:35:04DIRECTORY  Boot USING [EthernetBootFileNumber, EthernetRequest],  Heap USING [systemZone],  HostNumbers USING [HostNumber],  NSConstants USING [bootServerSocket],  OthelloDefs USING [    AbortingCommand, CommandProcessor, Confirm, GetName,    IndexTooLarge, MyNameIs, RegisterCommandProc],  SpecialBooting USING [BootFromEthernet],  String USING [CopyToNewString],  System USING [    broadcastHostNumber, defaultSwitches,    NetworkAddress, nullNetworkNumber, Switches],  Unformat USING [Error, HostNumber];EtherBooter: PROGRAM  IMPORTS Heap, OthelloDefs, SpecialBooting, String, Unformat  EXPORTS System =  BEGIN    HostNumber: PUBLIC TYPE = HostNumbers.HostNumber; -- to System    bootFileNumber: LONG STRING;  EtherBoot: PROCEDURE =    BEGIN    request: Boot.EthernetRequest;    switches: System.Switches ¬ System.defaultSwitches;    OthelloDefs.GetName["Ether Boot from boot file number: "L, @bootFileNumber];    GetAddress[@request.bfn, bootFileNumber !      Unformat.Error => OthelloDefs.AbortingCommand["Can't parse that one (No CH)"L]];    OthelloDefs.Confirm[];    request.address ¬ [      net: System.nullNetworkNumber,      host: System.broadcastHostNumber,      socket: NSConstants.bootServerSocket];    SpecialBooting.BootFromEthernet[      ethernetRequest: request, deviceOrdinal: 0, switches: switches];    END;  GetAddress: PROCEDURE [host: POINTER TO Boot.EthernetBootFileNumber, s: LONG STRING] =    BEGIN    host­ ¬ [Unformat.HostNumber[s, octal]];    END;  Commands: PROCEDURE [index: CARDINAL] =    BEGIN    SELECT index FROM      0 =>        BEGIN        OthelloDefs.MyNameIs[	  myNameIs: "Ether Boot"L,	  myHelpIs: "Load another program over the Ethernet"L];	EtherBoot[];	END;      ENDCASE => OthelloDefs.IndexTooLarge;    END;     commandProcessor: OthelloDefs.CommandProcessor ¬ [Commands];  bootFileNumber ¬ String.CopyToNewString["25200001000", Heap.systemZone];  -- Setup Default  OthelloDefs.RegisterCommandProc[@commandProcessor];  END.....