-- Copyright (C) 1982, 1983  by Xerox Corporation. All rights reserved. -- GPM.Mesa, edited by:-- Paxton	15-Jan-82 13:41:44-- SXS   	16-Sep-82 10:12:26-- AXD    	23-Feb-83 17:19:42-- originating from Strachey's General Purpose Macrogenerator-- as described in Computer Journal, Oct. 1965. pp. 225-241-- written in Mesa by Bill Paxton, November 1981DIRECTORY  MStream USING [Handle];GPM: DEFINITIONS = BEGIN  Handle: TYPE = LONG POINTER TO Object ¬ NIL;  Object: TYPE;    Stack: TYPE = RECORD [entries: SEQUENCE length:NAT OF Entry];    Index: TYPE = [0..maxIndex] ¬ 0;  maxIndex: NAT = 7777B;  -- 12 bits    Entry: TYPE = RECORD [ data: INTEGER ];--    data: SELECT kind:* FROM--      index => [ index: Index ],--      length => [ length: Index ],--      char => [ char: CHARACTER ],--      builtin => [ name: BuiltIn ],--      ENDCASE];      BuiltIn: TYPE = MACHINE DEPENDENT {def(1), val(2), update(3)};    Open: PROC [stream: MStream.Handle] RETURNS [Handle];    Close: PROC [self: Handle];    GetChar: PROC [self: Handle] RETURNS [char: CHARACTER];    GetIndex: PROC [self: Handle] RETURNS [i: LONG INTEGER];    Error: ERROR [ec: ErrorCode, errorMsg: LONG STRING ¬ NIL];    ErrorCode: TYPE = { MacroError, EndOfStream };    DumpToStream: PROC [output: MStream.Handle, input: Handle];  END.