-- Copyright (C) 1983, 1986, 1987  by Xerox Corporation. All rights reserved. -- SpaceTomP.mesa    (last edited by TXT      26-Jun-89 21:09:56)DIRECTORY  SpacePerf,  SpacePerfExtras,  TomP;  SpaceTomP:   PROGRAM  IMPORTS SpacePerf, SpacePerfExtras, TomP =  BEGIN    nDataSpaces, nCreatedDataFiles, percentageUtilization: LONG CARDINAL ¬ 0;  searchesPerDelete, searchesPerGetLockhandle, searchesPerIsLocked: LONG CARDINAL   ¬ 0;    UpdateVariables: TomP.UpdateVariablesProcType =    BEGIN    nDataSpaces ¬ SpacePerf.nDataSpaces;    nCreatedDataFiles ¬ SpacePerf.nCreatedDataFiles;    percentageUtilization ¬ (100 * SpacePerf.currentUtilization)      / SpacePerf.countDataPool;    searchesPerDelete ¬ IF SpacePerfExtras.numberOfDeletes = 0 THEN 0 ELSE      ((100 * SpacePerfExtras.numberOfDeleteSearches) / SpacePerfExtras.numberOfDeletes);    searchesPerGetLockhandle ¬ IF SpacePerfExtras.numberOfGetLockHandleFromFileID = 0      THEN 0      ELSE ((100 * SpacePerfExtras.numberOfGetLockHandleFromFileIDSearches) /        SpacePerfExtras.numberOfGetLockHandleFromFileID);    searchesPerIsLocked ¬ IF SpacePerfExtras.numberOfIsLocked = 0 THEN 0 ELSE      ((100 * SpacePerfExtras.numberOfIsLockedSearches) / SpacePerfExtras.numberOfIsLocked);    END;      GetSpaceVariable: TomP.GetVariableProcType =    BEGIN    SELECT index    FROM      0 => RETURN [["dataSpaces", @nDataSpaces]];      1 => RETURN [["createdDataFiles", @nCreatedDataFiles]];      2 => RETURN [["percentageUtilization", @percentageUtilization, FALSE]];      ENDCASE => RETURN [["invalid index", NIL]];    END;      GetFileLockVariable: TomP.GetVariableProcType =    BEGIN    SELECT index    FROM      0 => RETURN [["searchesPerDelete", @searchesPerDelete, FALSE]];      1 => RETURN [["searchesPerGetLockhandle", @searchesPerGetLockhandle,             FALSE]];      2 => RETURN [["searchesPerIsLocked", @searchesPerIsLocked, FALSE]];      ENDCASE => RETURN [["invalid index", NIL]];    END;      [] ¬ TomP.Register[name:"Space", nVariables:3,  	getVariableProc:GetSpaceVariable, updateVariablesProc:UpdateVariables];	  [] ¬ TomP.Register[name:"FileLock", nVariables:3,  	getVariableProc:GetFileLockVariable, updateVariablesProc:UpdateVariables];		      END.  -- LOG-- 21-Apr-86 13:30:28  RSV  made percentageUtilization a number between 0 and 100, not 0 and 1 (AR 9364).--  8-Feb-87 16:25:05  RSV  Convert to labellessness.-- 26-Jun-89 21:06:01  TXT  Add SpacePerfExtras, since SpacePerf goes back to be one in Pilot 14.0    